import{a as A,u as E,r as s,b as N,p as I,bV as j,bW as g,j as r,C as M,d as W,bX as R,g as F,bY as O}from"./index-25a41ef1.js";import{P as T,A as L}from"./PageHeader-b76b68bd.js";import{p as B}from"./PermissionService-9ad252b6.js";import{e as b}from"./ExportService-4b3a6c99.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const X=()=>{const y=A(),u=E(),[e,x]=s.useState(),[i,m]=s.useState([]),c=s.useRef(null),{loading:S,RouteList:v,Route:H}=N(t=>t.route);s.useEffect(()=>{p()},[]),s.useEffect(()=>{I()}),s.useEffect(()=>{x(B({screenId:16}))},[]);const p=()=>u(j({RouteId:0,Taskname:"SearchInitialize"}));s.useEffect(()=>{e!=null&&e._View&&i.filter(t=>t.name=="view").length==0&&m([...i,{title:"View",name:"view",disabled:!1}]),e!=null&&e._Update&&i.filter(t=>t.name=="edit").length==0&&m([...i,{title:"Edit",name:"edit",disabled:!1}]),e!=null&&e._Delete&&i.filter(t=>t.name=="delete").length==0&&m([...i,{title:"Delete",name:"delete",disabled:!1}]),e!=null&&e._View&&(e!=null&&e._Update)&&(e!=null&&e._Delete)&&h({...n,tableAction:!0})},[e,i]),s.useEffect(()=>{e!=null&&e._Add&&!n.pageHeader.pageActions[0].create&&h(t=>{const l={...t.pageHeader,pageActions:t.pageHeader.pageActions.map(d=>({...d,create:!!(e!=null&&e._Add)}))};return{...t,pageHeader:l}})},[e]),s.useEffect(()=>{h({...n,tableActions:i})},[i]);const[n,h]=s.useState({pageTitle:"Route",pageHeader:{pageActions:[{create:!1,clear:!1,save:!1,createQuery:"/home/cRoute",createDispatch:()=>u(g({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{width:"10em",textAlign:"center"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:i,tableColumns:[{title:"Route Code",name:"RouteCode",sort:!0,avatar:!1,badge:!1,Style:{minWidth:"15em",maxWidth:"15em",width:"15em",textAlign:"left",justifyContent:"left",gap:"10px"}},{title:"Route Name",name:"RouteName",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"From Location ",name:"FromLocation",sort:!0,avatar:!1,badge:!1,colStyle:{maxWidth:"20em",overflowWrap:"break-word"}},{title:"To Location ",name:"ToLocation",sort:!0,avatar:!1,badge:!1,colStyle:{maxWidth:"20em",overflowWrap:"break-word"}},{title:"Created By",name:"CreatedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created On",name:"CreatedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified By",name:"ModifiedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified On",name:"ModifiedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Status",name:"StatusName",sort:!0,avatar:!1,badge:!0,colStyle:{minWidth:"2rem",textAlign:"center"}}],tableExport:t=>{p().then(d=>{C(d.payload.RouteList).then(a=>{t==="pdf"?b.Export("Route",a,"pdf"):t==="excel"&&b.Export("Route",a,"excel")}).catch(a=>{console.error(a.message)})})}}),C=t=>new Promise((l,d)=>{let a=[];t.length>0?(t.forEach(o=>{let f={"Route Code":o.RouteCode,"Route Name":o.RouteName,"From Location":o.FromLocation,"To Location ":o.ToLocation,"Created By":o.CreatedByName,"Created On":o.CreatedOn,"Modified By":o.ModifiedByName,"Modified On":o.ModifiedOn,Status:o.StatusName};a.push(f)}),l(a)):d(new Error("No data available for export."))}),w={view:t=>{const l={RouteId:t.data.RouteId,Taskname:"CreateInitialize"};u(R(l)).then(a=>{a.payload.transtatus.result==!0&&y.push("/home/cRoute")}).catch(a=>{}),u(g(t))},edit:t=>{const l={RouteId:t.data.RouteId,Taskname:"CreateInitialize"};u(R(l)).then(a=>{a.payload.transtatus.result==!0&&y.push("/home/cRoute")}).catch(a=>{}),u(g(t))},delete:t=>{F(`Are you sure you want to inactive this ${t.data.RouteName}?`,"Confirmation",()=>{let l={RouteId:t.data.RouteId};u(O(l)).then(a=>{var o,f;a.payload.transtatus.result==!0?((o=c.current)==null||o.show({severity:"success",summary:"Success Message",detail:a.payload.transtatus.lstErrorItem[0].Message}),p()):a.payload.transtatus.result==!1&&((f=c.current)==null||f.show({severity:"error",summary:"Error Message",detail:a.payload.transtatus.lstErrorItem[0].Message}))}).catch(a=>{var o;(o=c.current)==null||o.show({severity:"error",summary:"Error Message",detail:JSON.stringify(a)})})},()=>{})}};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"page-container",children:r.jsxs("div",{className:"inner-page-container",children:[r.jsx(T,{pageTitle:n.pageTitle,pageConfig:n}),r.jsx("div",{className:"form-container scroll-y",children:r.jsx("div",{className:"white",children:r.jsx("div",{className:"widget-body",children:r.jsx("div",{className:"card",children:r.jsx(L,{handleActions:w,data:v,loading:S,pageConfig:n,screenPermissions:e})})})})})]})}),r.jsx(M,{}),r.jsx(W,{toast:c})]})};export{X as default};
