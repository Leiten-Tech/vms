import{r,a as J,p as Q,a9 as X,b as Z,u as ee,df as te,c as ae,t as O,dg as E,j as e,F as se,n as v,B as C,A as le,d as oe,d9 as re,I as ie}from"./index-25a41ef1.js";import{p as ne}from"./Master-b11b8a2f.js";import{D as ce,C as n}from"./column.esm-11a46c7b.js";import{e as L}from"./ExportService-4b3a6c99.js";import"./index.esm-21a4a4d3.js";import"./index.esm-9a713e1a.js";import"./jspdf.es.min-40ee8370.js";const de=(x,f,p)=>e.jsx(e.Fragment,{children:e.jsx("a",{style:{color:"blue"},onClick:()=>{p(x),f(!0)},children:x.VisitorName})}),ue=x=>{const{visible:f,setVisible:p,detailData:a}=x;return e.jsx(re,{header:"Details",visible:f,style:{width:"30vw",height:"80vh"},onHide:()=>p(!1),children:e.jsx("div",{className:"form-container scroll-y",children:e.jsx("div",{className:"white",children:e.jsx("div",{className:"widget-body",children:e.jsx("div",{className:"normal-table",children:e.jsxs("div",{className:"card",children:[e.jsx("img",{src:`Visitor Image: ${a==null?void 0:a.VisitorImageUrl}`,alt:`${a==null?void 0:a.VisitorName}`,style:{maxWidth:"100%",height:"auto"}}),e.jsx("p",{style:{fontWeight:"bold"},children:`Visitor Name: ${a==null?void 0:a.VisitorName}`}),e.jsx("p",{style:{fontWeight:"bold"},children:`Mobile No: ${a==null?void 0:a.MobileNo}`}),e.jsx("p",{style:{fontWeight:"bold"},children:`Purpose Of Visit: ${a==null?void 0:a.PurposeOfVisitName}`}),e.jsx("p",{style:{fontWeight:"bold"},children:`Whom To Visit: ${a==null?void 0:a.VisitorEmpName}`}),e.jsx("p",{style:{fontWeight:"bold"},children:`Area To Visit: ${a==null?void 0:a.AreatoVisitName}`}),e.jsx("p",{style:{fontWeight:"bold"},children:`Visitor Entry Code: ${a==null?void 0:a.VisitorEntryCode}`}),e.jsx("p",{style:{fontWeight:"bold"},children:`Checked In: ${a==null?void 0:a.CheckedIn}`}),e.jsx("p",{style:{fontWeight:"bold"},children:`Checked Out: ${a==null?void 0:a.CheckedOut}`}),e.jsx("div",{className:"text-center",children:e.jsx(C,{label:"OK",severity:"success",title:"success",icon:"pi pi-check",className:"mr-2 p-1",onClick:()=>p(!1)})})]})})})})})})},De=()=>{const[x,f]=r.useState([]);r.useState([]);const[p,a]=r.useState(!1);J();const[M,k]=r.useState([]),[R,he]=r.useState();r.useState([]);const[W,B]=r.useState();r.useEffect(()=>{Q()});const[T,A]=r.useState({global:{value:null,matchMode:X.CONTAINS}}),[$,U]=r.useState(""),q=()=>{const o=l=>{const i=l.target.value;let u={...T};u.global.value=i,A(u),U(i)},c=l=>{const i=t.values.PlantName.join(","),u=t.values.VisitorTypeId?t.values.VisitorTypeId.join(","):null,b=t.values.PurposeOfVisit?t.values.PurposeOfVisit.join(","):null,s={Taskname:"SearchInitialize",FromDate:new Date(t.values.FromDate),ToDate:new Date(t.values.ToDate),PlantId:i||null,VisitorTypeId:u||null,PurposeOfVisit:b||null};j(E(s)).then(S=>{d(S.payload.CheckinCheckoutList).then(g=>{l==="pdf"?L.Export("CheckInCheckOut",g,"pdf"):l==="excel"&&L.Export("CheckInCheckOut",g,"excel")}).catch(g=>{console.error(g.message)})})},d=l=>new Promise((i,u)=>{let b=[];l&&l.length>0?(l.forEach(s=>{let m={"Plant Name":s.PlantName,"Visitor Entry Code":s.VisitorEntryCode,"Visitor Type":s.VisitorTypeName,"Visitor Name":s.VisitorName,Date:s.VisitorEntryDate,"Checked In":s.CheckedIn,"Checked Out":s.CheckedOut,"Stay Time":s.StayTime,"Checked In By":s.CheckedInBy,"Checked Out By":s.CheckedOutBy};b.push(m)}),i(b)):u(new Error("No data available for export."))});return e.jsxs("div",{className:"flex justify-content-between",children:[e.jsxs("span",{className:"p-input-icon-left",children:[e.jsx("i",{className:"pi pi-search"}),e.jsx(ie,{value:$,onChange:o,placeholder:"Search"})]}),e.jsx("div",{className:"flex align-items-center justify-content-end gap-2",children:e.jsxs("div",{className:"action-btn",children:[e.jsx(C,{type:"button",title:"Export Excel",icon:"pi pi-file-excel",severity:"success",onClick:()=>c("excel"),"data-pr-tooltip":"XLS"}),e.jsx(C,{type:"button",title:"Export PDF",icon:"pi pi-file-pdf",severity:"warning",onClick:()=>c("pdf"),"data-pr-tooltip":"PDF"})]})})]})},{VisitorList:me,isCreate:H,CheckinCheckoutList:N,createEditData:pe,isView:ye,VisitorTypeList:z,PovList:G,PlantList:_,HdrTable:h,loading:I}=Z(o=>o.rptcheckincheckout),y=r.useRef(null),j=ee();r.useEffect(()=>{j(te({VisitorTypeId:0,Taskname:"CREATEINITIALIZE"}))},[]);const K=()=>{t.resetForm(),k([])},D=(o,c,d)=>{var l;if(t.setFieldValue(o,d),t.values.FromDate>t.values.ToDate){(l=y.current)==null||l.show({severity:"warn",summary:"Warning Message",detail:"To Date should not be Before the From Date"});return}},t=ae({initialValues:{FromDate:h&&h.FromDate||new Date,ToDate:h&&h.ToDate||new Date,PlantName:h&&h.PlantName||[+localStorage.PlantId],VisitorTypeId:h!=null?h.VisitorTypeId:null},validationSchema:ne,onSubmit:(o,{resetForm:c})=>{Y()}}),Y=()=>{const o=t.values.PlantName?t.values.PlantName.join(","):null,c=t.values.VisitorTypeId?t.values.VisitorTypeId.join(","):null,d=t.values.PurposeOfVisit?t.values.PurposeOfVisit.join(","):null;console.log(t.values.FromDate);let l=new Date(t.values.FromDate);console.log(l);let i=new Date(t.values.ToDate);l.getUTCFullYear(),String(l.getUTCMonth()).padStart(2,"0"),String(l.getUTCDate()).padStart(2,"0"),i.getUTCFullYear(),String(i.getUTCMonth()).padStart(2,"0"),String(i.getUTCDate()).padStart(2,"0"),console.log(new Date(t.values.FromDate),t.values.FromDate),console.log(new Date(t.values.ToDate),t.values.ToDate);const u={Taskname:"SearchInitialize",FromDate:O(t.values.FromDate),ToDate:O(t.values.ToDate),PlantId:o||null,VisitorTypeId:c||null,PurposeOfVisit:d||null};j(E(u)).then(s=>{var m,S,g;if(s.payload.transtatus.result==!0){k(s.payload.CheckinCheckoutList);const w=t.values.FromDate,F=t.values.ToDate;if(w&&F&&new Date(w)>new Date(F))(m=y.current)==null||m.show({severity:"warn",summary:"Warning Message",detail:"To Date should not be Before the From Date"});else if(s.payload.CheckinCheckoutList.length===0){(S=y.current)==null||S.show({severity:"warn",summary:"Warning Message",detail:" No Data Available"});return}}else(g=y.current)==null||g.show({severity:"error",summary:"Error Message",detail:s.payload.transtatus.lstErrorItem[0].Message})}).catch(s=>{var m;(m=y.current)==null||m.show({severity:"warn",summary:"Error Message",detail:JSON.stringify(s.payload)})})};r.useEffect(()=>{f(N)},[N]);const P=o=>{var d;console.log(o),t.handleChange(o),console.log(t);const c=t.errors;(c.FromDate||c.ToDate)&&((d=y.current)==null||d.show({severity:"warn",summary:"Warning Message",detail:"To Date should not be Before the From Date"}))};r.useEffect(()=>{console.log(t),console.log(new Date(t.values.FromDate)),console.log(new Date(t.values.ToDate))});const[V,ge]=r.useState({pageTitle:"Check In Check Out Report",pageHeader:{pageActions:[{create:!1,clear:!0,save:!0,createQuery:" "}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{maxWidth:"4.5rem",textAlign:"center",justifySelf:"center"},tableRows:10,tableRowsOptions:[10,50,100,500,1e3],tablePagination:!0,tableColumns:[{title:"Plant Name",name:"PlantName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"16rem"}},{title:"Visitor Entry Code",name:"VisitorEntryCode",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Visitor Type",name:"VisitorType",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Visitor Name",name:"VisitorTypeName",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Date",name:"VisitorEntryDate",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Checked In",name:"CheckedIn",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Checked Out",name:"CheckedOut",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Stay Time",name:"StayTime",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Checked In By",name:"CheckedInBy",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Checked Out By",name:"CheckedOutBy",sort:!0,avatar:!1,badge:!1,colStyle:{}}]});return e.jsxs(e.Fragment,{children:[e.jsx(se,{initialValues:t.initialValues,validationSchema:t.validationSchema,onSubmit:t.handleSubmit,children:e.jsx("div",{className:"page-container",children:e.jsxs("div",{className:"inner-page-container",children:[e.jsx("div",{className:"page-title",children:e.jsx("div",{className:"grid grid-nogutter",children:e.jsx("div",{className:"md:col-6",children:e.jsx("h1",{children:"Check In Check Out Report"})})})}),e.jsx("div",{className:"form-container scroll-y",children:e.jsx("div",{className:"white",children:e.jsxs("div",{className:"widget-body",children:[e.jsx("form",{children:e.jsx("div",{className:"normal-table",children:e.jsxs("div",{className:"grid",children:[e.jsx(v,{type:"Calendar",name:"FromDate",label:"From Date",options:"",show:!0,required:!0,optionLabel:"FromDate",optionValue:"FromDate",handleChange:P,formik:t,fldStyle:"col-12 md:col-3",maxDate:t.values.ToDate}),e.jsx(v,{type:"Calendar",name:"ToDate",label:"To Date",options:"",show:!0,required:!0,optionLabel:"ToDate",optionValue:"ToDate",handleChange:P,formik:t,fldStyle:"col-12 md:col-3",minDate:t.values.FromDate}),e.jsx(v,{type:"multi_select",name:"PlantName",label:"Plant Name",options:_,show:!0,required:!0,optionLabel:"PlantName",optionValue:"PlantId",handleSelect:D,fldStyle:"col-12 md:col-3",formik:t,maxSelectedLabels:3}),e.jsx(v,{type:"multi_select",name:"VisitorTypeId",label:"Visitor Type",options:z,show:!0,required:!1,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:D,fldStyle:"col-12 md:col-3",formik:t,maxSelectedLabels:3}),e.jsx(v,{type:"multi_select",name:"PurposeOfVisit",label:"Purpose Of Visit ",options:G,show:!0,required:!1,disable:!H,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:D,formik:t,fldStyle:"col-12 md:col-3",filter:!0})]})})}),e.jsxs("div",{className:"text-center mb-3",children:[e.jsx(C,{type:"button",label:"Search",severity:"success",icon:"pi pi-search",title:"Add",className:"text-center",onClick:()=>{t.handleSubmit()}}),e.jsx(C,{type:"button",label:"Clear",severity:"danger",icon:"las la-trash",title:"Clear",className:"text-center",onClick:()=>K()})]}),e.jsx("div",{className:"card",children:I?e.jsx(le,{}):e.jsxs(e.Fragment,{children:[e.jsxs(ce,{value:M,showGridlines:!0,filters:T,loading:I,selection:f,emptyMessage:"No Data Found",style:{minWidth:"50rem",textAlign:"center"},dataKey:"ScreenName",paginator:V.tablePagination,rows:V.tableRows,rowsPerPageOptions:V.tableRowsOptions,currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Entries",paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",globalFilter:R,header:q,children:[e.jsx(n,{field:"VisitorEntryDate",header:"Date",sortable:!0}),e.jsx(n,{field:"PlantName",header:"Plant Name",sortable:!0}),e.jsx(n,{field:"VisitorEntryCode",header:"Visitor Entry Code",sortable:!0}),e.jsx(n,{field:"VisitorTypeName",header:"Visitor Type",sortable:!0}),e.jsx(n,{field:"VisitorName",header:"Visitor Name",sortable:!0,body:o=>de(o,a,B)}),e.jsx(n,{field:"PurposeOfVisitName",header:"Purpose Of Visit",sortable:!0}),e.jsx(n,{field:"CheckedIn",header:"Checked In",sortable:!0}),e.jsx(n,{field:"CheckedOut",header:"Checked Out",sortable:!0}),e.jsx(n,{field:"StayTime",header:"Stay Time",sortable:!0}),e.jsx(n,{field:"CheckedInBy",header:"Checked In By",sortable:!0}),e.jsx(n,{field:"CheckedOutBy",header:"Checked Out By",sortable:!0})]}),p?e.jsx(ue,{visible:p,setVisible:a,detailData:W}):null]})})]})})})]})})}),e.jsx(oe,{toast:y})]})};export{De as default};
