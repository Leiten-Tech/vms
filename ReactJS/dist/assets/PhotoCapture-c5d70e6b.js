import{r as y,bi as P,bg as R,j as p,bM as I,B as F}from"./index-25a41ef1.js";var O={exports:{}};(function(w,C){(function(S,m){w.exports=m(y)})(P,function(j){return function(S){var m={};function u(n){if(m[n])return m[n].exports;var a=m[n]={i:n,l:!1,exports:{}};return S[n].call(a.exports,a,a.exports,u),a.l=!0,a.exports}return u.m=S,u.c=m,u.d=function(n,a,h){u.o(n,a)||Object.defineProperty(n,a,{enumerable:!0,get:h})},u.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},u.t=function(n,a){if(a&1&&(n=u(n)),a&8||a&4&&typeof n=="object"&&n&&n.__esModule)return n;var h=Object.create(null);if(u.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:n}),a&2&&typeof n!="string")for(var M in n)u.d(h,M,(function(U){return n[U]}).bind(null,M));return h},u.n=function(n){var a=n&&n.__esModule?function(){return n.default}:function(){return n};return u.d(a,"a",a),a},u.o=function(n,a){return Object.prototype.hasOwnProperty.call(n,a)},u.p="",u(u.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(S,m,u){u.r(m);var n=u("react"),a=function(){var s=function(o,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])},s(o,e)};return function(o,e){s(o,e);function t(){this.constructor=o}o.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),h=function(){return h=Object.assign||function(s){for(var o,e=1,t=arguments.length;e<t;e++){o=arguments[e];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(s[i]=o[i])}return s},h.apply(this,arguments)},M=function(s,o){var e={};for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&o.indexOf(t)<0&&(e[t]=s[t]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(s);i<t.length;i++)o.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(s,t[i])&&(e[t[i]]=s[t[i]]);return e};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(o){var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return e?new Promise(function(t,i){e.call(navigator,o,t,i)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function U(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var x=function(s){a(o,s);function o(e){var t=s.call(this,e)||this;return t.canvas=null,t.ctx=null,t.requestUserMediaId=0,t.unmounted=!1,t.state={hasUserMedia:!1},t}return o.prototype.componentDidMount=function(){var e=this,t=e.state,i=e.props;if(this.unmounted=!1,!U()){i.onUserMediaError("getUserMedia not supported");return}t.hasUserMedia||this.requestUserMedia(),i.children&&typeof i.children!="function"&&console.warn("children must be a function")},o.prototype.componentDidUpdate=function(e){var t=this.props;if(!U()){t.onUserMediaError("getUserMedia not supported");return}var i=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),r=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),l=e.minScreenshotWidth!==t.minScreenshotWidth,c=e.minScreenshotHeight!==t.minScreenshotHeight;(r||l||c)&&(this.canvas=null,this.ctx=null),(i||r)&&(this.stopAndCleanup(),this.requestUserMedia())},o.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},o.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map(function(t){e.removeTrack(t),t.stop()}),e.getAudioTracks().map(function(t){e.removeTrack(t),t.stop()})):e.stop())},o.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(o.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},o.prototype.getScreenshot=function(e){var t=this,i=t.state,r=t.props;if(!i.hasUserMedia)return null;var l=this.getCanvas(e);return l&&l.toDataURL(r.screenshotFormat,r.screenshotQuality)},o.prototype.getCanvas=function(e){var t=this,i=t.state,r=t.props;if(!this.video||!i.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var l=this.video.videoWidth,c=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var d=l/c;l=r.minScreenshotWidth||this.video.clientWidth,c=l/d,r.minScreenshotHeight&&c<r.minScreenshotHeight&&(c=r.minScreenshotHeight,l=c*d)}this.canvas=document.createElement("canvas"),this.canvas.width=(e==null?void 0:e.width)||l,this.canvas.height=(e==null?void 0:e.height)||c,this.ctx=this.canvas.getContext("2d")}var g=this,v=g.ctx,f=g.canvas;return v&&f&&(f.width=(e==null?void 0:e.width)||f.width,f.height=(e==null?void 0:e.height)||f.height,r.mirrored&&(v.translate(f.width,0),v.scale(-1,1)),v.imageSmoothingEnabled=r.imageSmoothing,v.drawImage(this.video,0,0,(e==null?void 0:e.width)||f.width,(e==null?void 0:e.height)||f.height),r.mirrored&&(v.scale(-1,1),v.translate(-f.width,0))),f},o.prototype.requestUserMedia=function(){var e=this,t=this.props,i=function(c,d){var g={video:typeof d<"u"?d:!0};t.audio&&(g.audio=typeof c<"u"?c:!0),e.requestUserMediaId++;var v=e.requestUserMediaId;navigator.mediaDevices.getUserMedia(g).then(function(f){e.unmounted||v!==e.requestUserMediaId?o.stopMediaStream(f):e.handleUserMedia(null,f)}).catch(function(f){e.handleUserMedia(f)})};if("mediaDevices"in navigator)i(t.audioConstraints,t.videoConstraints);else{var r=function(c){return{optional:[{sourceId:c}]}},l=function(c){var d=c.deviceId;return typeof d=="string"?d:Array.isArray(d)&&d.length>0?d[0]:typeof d=="object"&&d.ideal?d.ideal:null};MediaStreamTrack.getSources(function(c){var d=null,g=null;c.forEach(function(b){b.kind==="audio"?d=b.id:b.kind==="video"&&(g=b.id)});var v=l(t.audioConstraints);v&&(d=v);var f=l(t.videoConstraints);f&&(g=f),i(r(d),r(g))})}},o.prototype.handleUserMedia=function(e,t){var i=this.props;if(e||!t){this.setState({hasUserMedia:!1}),i.onUserMediaError(e);return}this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}i.onUserMedia(t)},o.prototype.render=function(){var e=this,t=this,i=t.state,r=t.props,l=r.audio;r.forceScreenshotSourceSize,r.onUserMedia,r.onUserMediaError,r.screenshotFormat,r.screenshotQuality,r.minScreenshotWidth,r.minScreenshotHeight,r.audioConstraints,r.videoConstraints,r.imageSmoothing;var c=r.mirrored,d=r.style,g=d===void 0?{}:d,v=r.children,f=M(r,["audio","forceScreenshotSourceSize","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),b=c?h(h({},g),{transform:(g.transform||"")+" scaleX(-1)"}):g,_={getScreenshot:this.getScreenshot.bind(this)};return n.createElement(n.Fragment,null,n.createElement("video",h({autoPlay:!0,src:i.src,muted:!l,playsInline:!0,ref:function(E){e.video=E},style:b},f)),v&&v(_))},o.defaultProps={audio:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},o}(n.Component);m.default=x},react:function(S,m){S.exports=j}}).default})})(O);var N=O.exports;const W=R(N),T=w=>{const{onUpload:C,ImageUrl:j,isView:S,fldStyle:m,innerConStyle:u,innerCamStyle:n,isExternal:a}=w;y.useState(!1);const h=y.useRef(null),M=y.useRef(null),U=y.useRef(null),x=y.useRef(null),s=y.useRef(null),[o,e]=y.useState(null);y.useCallback(()=>{const r=s.current.getScreenshot();e(r)},[s]),y.useEffect(()=>{i()},[]);const t=()=>{try{const r=h.current.getScreenshot();fetch(r).then(l=>l.blob()).then(l=>{if(l){const c=new File([l],Math.random().toString(36).substring(2,15)+Math.random().toString(23).substring(2,5)+".jpeg",{type:"image/jpeg"});C(c)}})}catch(r){console.error("Error",r)}},i=async()=>{try{const r=await navigator.mediaDevices.getUserMedia({video:!0});h.current&&(h.current.srcObject=r,x.current=r)}catch(r){console.error("Error accessing the camera:",r)}};return p.jsx(p.Fragment,{children:p.jsx("div",{className:m,children:p.jsxs("div",{className:"grid",children:[p.jsx("div",{className:"col-6",children:S?null:p.jsxs(p.Fragment,{children:[p.jsx(W,{mirrored:!0,width:"100%",ref:h,screenshotQuality:1,screenshotFormat:"image/jpeg"}),p.jsx("canvas",{ref:M,className:"w-full",style:{display:"none"}}),p.jsxs(p.Fragment,{children:[p.jsx(I,{target:"Button"}),p.jsx(F,{className:"camera_action",onClick:()=>t(),"aria-label":"Capture Image",severity:"success",icon:"pi pi-stop-circle","data-pr-tooltip":"Capture Image","data-pr-position":"top"})]})]})}),p.jsx("div",{className:"col-6",children:p.jsx("div",{className:"img-preview-container",children:p.jsx("img",{className:"w-full",ref:U,src:j,alt:"Captured"})})})]})})})};export{T as P};
