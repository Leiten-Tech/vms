import{a as oa,j as t,A as ra,F as na,n as f,B as te,I as ws,r as s,u as da,p as di,L as Lt,b as sa,c as ri,dh as ni,az as Ts,a9 as vs,di as Fs,dj as js,dk as Ps,d as ks,cV as Os,t as Ct,dl as la,dm as Us,dn as Bs,dp as As,dq as Rs,dr as qs,ds as Ws,dt as Hs,du as Gs}from"./index-25a41ef1.js";import{V as Js,q as _s,g as Ks}from"./Master-b11b8a2f.js";import{D as ca,C as Ke}from"./column.esm-11a46c7b.js";import{P as zs}from"./PhotoCapture-c5d70e6b.js";import{F as $s}from"./fileupload.esm-b904f07b.js";import{V as Qs}from"./VisitorManagement-638cb0f9.js";import{I as Ys}from"./inputswitch.esm-a89edc74.js";import{A as Zs}from"./vms-banner-01b81de4.js";import"./index.esm-21a4a4d3.js";import"./index.esm-9a713e1a.js";const Xs=(N,x,w,u)=>{const B=()=>{w([]),w(x.filter(M=>M!=N))},_=()=>{w(x.filter(M=>M!=N)),u.setFieldValue("FirstName",N.FirstName),u.setFieldValue("MailId",N.MailId),u.setFieldValue("MobileNo",N.MobileNo),u.setFieldValue("TagNo",N.TagNo),u.setFieldValue("VisitorCompany",N.VisitorCompany),u.setFieldValue("TitleId",N.TitleId)};return t.jsxs(t.Fragment,{children:[t.jsx(te,{label:"",severity:"danger",title:"Delete",icon:"las la-trash",className:"mr-2 p-1",onClick:()=>B()}),t.jsx(te,{label:"",severity:"success",title:"Edit",icon:"las la-pen",className:"mr-2 p-1",onClick:()=>_()})]})},el=N=>{const{visitorEntryBelongingDetailForm:x,formik:w,VisitorEntryBelongingDetailList:u,TableHeader:B,filters:_,isView:M,setVisitorEntryBelongingDetailList:I,toast:ie,isCreate:K}=N,k=(y,T,H)=>{const j=[...u];j[H.rowIndex][H.field]=y.target.value,I(j)},z=(y,T)=>t.jsx(ws,{className:"w-full",value:y[T.field],onChange:H=>{k(H,y,T)},maxLength:50,disabled:M||!K});return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"sub-title",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"col-12",children:t.jsx("h2",{children:"Belonging Details"})})})}),t.jsx("div",{className:"normal-table",children:t.jsxs(ca,{value:u,showGridlines:!0,filterDisplay:"menu",globalFilterFields:["VisitorName","DepartMentName","Dob","MobileNo","MailId","IdCardTypeName","IdCardNo","StatusName"],emptyMessage:"No Data found.",children:[t.jsx(Ke,{field:"DeviceName",header:"Property Name",style:{width:"40%"},body:(y,T)=>z(y,T)}),t.jsx(Ke,{field:"DeviceNo",header:"Serial No",style:{width:"25%"},body:(y,T)=>z(y,T)})]})})]})},tl=N=>{const{isView:x,isCreate:w,VisitorTypeList:u,handleSelect:B,handleOnChange:_,TitleList:M,formik:I,onUpload:ie,imageUrl:K,visitorForm:k,visitorRef:z,onSubmit:y,handleChange:T,cameraOff:H,setCameraOff:j,phonenumber:ce,workerList:O,setWorkerList:$,addVisitorDetail:G,visitorDetailList:J,setVisitorDetailList:Te,OnClear:F}=N;return console.log(J),t.jsx(na,{initialValues:k,validationSchema:Js,onSubmit:y,ref:z,children:t.jsx("div",{className:"grid",children:t.jsxs("div",{className:"col-12",children:[t.jsxs("div",{className:"grid",children:[t.jsx("div",{className:"col-12 md:col-8",children:t.jsxs("div",{className:"grid",children:[t.jsx(f,{type:"text",name:"VisitorCode",label:"Visitor Code ",options:"",show:!1,required:!0,disable:!!(x||w==!1),optionLabel:"",optionValue:"",handleSelect:"",onKeyPress:()=>{},fldStyle:"col-12 md:col-4",formik:I}),t.jsx(f,{type:"text_title",name:"TitleId",label:"Name ",options:M,show:!0,required:!0,disable:!!x,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:B,handleOnChange:_,titleInputName:"FirstName",fldStyle:"col-12 md:col-6",formik:I,maxlength:50}),t.jsx(f,{type:"Calendar",name:"Dob",label:"Date of Birth",options:"",show:!1,required:!0,disable:!!x,optionLabel:"",optionValue:"",handleChange:T,fldStyle:"col-12 md:col-6",formik:I,maxDate:new Date}),t.jsx(f,{type:"text",name:"MailId",label:"Mail ID ",options:"",show:!0,required:!0,disable:!!x,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-6",formik:I}),t.jsx(f,{type:"text_title",name:"CountryCode",label:"Mobile No",options:ce,show:!0,required:!0,disable:!!x,optionLabel:"CountryCode",optionValue:"CountryCode",handleSelect:B,optionDisable:!0,fldStyle:"col-12 md:col-6",formik:I,keyfilter:"int",maxlength:10,minLength:10,titleInputName:"MobileNo"}),t.jsx(f,{type:"text",name:"VisitorCompany",label:"Visitor Company ",options:"",show:!0,required:!1,disable:!!x,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-6",formik:I,maxlength:100}),t.jsx(f,{type:"text",name:"TagNo",label:"Tag No ",options:"",show:!0,required:!1,disable:!!x,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-6",formik:I}),t.jsx(f,{type:"textarea",name:"Address",label:"Address",options:"",show:!1,required:!1,disable:!!x,optionLabel:"",optionValue:"",handleSelect:"",formik:I,fldStyle:"col-12 md:col-12",maxlength:"500",style:{maxHeight:"100px",overflowY:"auto"}})]})}),t.jsx("div",{className:"col-12 md:col-4",children:t.jsx(zs,{onUpload:ie,ImageUrl:K,isView:x||!w,cameraOff:H,setCameraOff:j,fldStyle:"col-12 text-center"})})]}),t.jsxs("div",{className:"text-center mb-3",children:[t.jsx(te,{label:"Add",severity:"success",icon:"las la-plus",title:"Add",className:"text-center",onClick:G,type:"submit"}),t.jsx(te,{label:"Clear",severity:"danger",icon:"las la-trash",title:"Clear",className:"text-center",onClick:()=>F()})]}),t.jsx("div",{className:"card",children:t.jsxs(ca,{value:J,showGridlines:!0,paginator:!0,filterDisplay:"menu",globalFilterFields:["VisitorName","MailId","MobileNo","VisitorCompany","TagNo"],emptyMessage:"No Data Found.",rows:5,children:[t.jsx(Ke,{header:"Action",style:{textAlign:"center",overflowWrap:"break-word",width:"5%"},body:ve=>Xs(ve,J,Te,I),headerClassName:"text-center"}),t.jsx(Ke,{field:"VisitorName",style:{width:"5%",overflowWrap:"break-word"},header:"Name",headerClassName:"text-center"}),t.jsx(Ke,{field:"MailId",style:{width:"5%",overflowWrap:"break-word"},header:"Mail Id",headerClassName:"text-center"}),t.jsx(Ke,{field:"MobileNo",header:"Mobile No",style:{width:"5%",overflowWrap:"break-word"},headerClassName:"text-center"})]})})]})})})},il=N=>{const{setIsVisMaster:x,isVisMaster:w,visitorEntryFormik:u,VisitorNameList:B,handleVisitorSelected:_,isViewVM:M,isCreateVM:I,VisitorTypeListVM:ie,handleSelectVM:K,TitleListVM:k,CountryListVM:z,OnchangecountryVM:y,StateListVM:T,OnchangestateVM:H,CityListVM:j,IdCardListVM:ce,StatusListVM:O,onUploadVM:$,itemTemplateVM:G,imageUrlVM:J,handleOnChangeVM:Te,visitorFormVM:F,visitorRefVM:ve,formikVM:Q,onChangeVisitorTypeVM:st,tempStateListVM:me,tempCityListVM:lt,handleCloseImageVM:ae,handleChangeVM:ze,profUploadRef:se,VisitorhandleHyperlinkVM:$e,onUploadDocumentVisitorVM:ue,deleteDocumentsVisitorVM:pe,documentUrlVisitorVM:ge,documentVisitorUploadRefVM:be,loadingVM:E,toast:le,VisitorEntryBelongingDetailList:Qe,setVisitorEntryBelongingDetailList:Se,IsBelongingDetailsShow:Ne,pageType:Fe,cameraOff:p,setCameraOff:je,phonenumber:ye,addVisitorDetail:Pe,visitorDetailList:oe,setVisitorDetailList:xe,OnClear:Le}=N;return oa(),t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"widget-hdr",children:t.jsx("div",{className:"sub-title",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"col-12",children:t.jsx("h2",{children:`${Fe?"Contractor":"Visitor"} Information`})})})})}),t.jsx("div",{className:"widget-body",children:t.jsx("div",{className:"normal-table",children:E?t.jsx(ra,{}):t.jsxs(t.Fragment,{children:[t.jsx(tl,{isView:M,isCreate:I,VisitorTypeList:ie,handleSelect:K,TitleList:k,CountryList:z,Onchangecountry:y,StateList:T,Onchangestate:H,CityList:j,IdCardList:ce,StatusList:O,onUpload:$,itemTemplate:G,imageUrl:J,handleOnChange:Te,visitorForm:F,visitorRef:ve,formik:Q,onChangeVisitorType:st,tempStateList:me,tempCityList:lt,handleCloseImage:ae,handleChange:ze,profUploadRef:se,VisitorhandleHyperlink:$e,onUploadDocumentVisitor:ue,deleteDocumentsVisitor:pe,documentUrlVisitor:ge,documentVisitorUploadRef:be,toast:le,phonenumber:ye,addVisitorDetail:Pe,visitorDetailList:oe,setVisitorDetailList:xe,OnClear:Le}),t.jsx("div",{className:M?"p-disabled":"",children:t.jsx(el,{VisitorEntryBelongingDetailList:Qe,setVisitorEntryBelongingDetailList:Se,isView:M,isCreate:I,toast:le,IsBelongingDetailsShow:Ne})})]})})})]})},al=N=>{const{visitorEntryForm:x,VisitorEntryValidationSchema:w,formik:u,pageType:B,onUpload:_,itemTemplate:M,isView:I,imageUrl:ie,IsPreBookingList:K,VisitorTypeList:k,onChangeVisitorType:z,isCreate:y,handleSelect:T,autoCompleteRef:H,OnSelectVisitorCode:j,onChangeMatType:ce,filteritemType:O,VisitorNameList:$,onChangeVisitor:G,handleIsPreBook:J,VECodeDisable:Te,EmployeeList:F,OnchangePlantList:ve,ProofList:Q,onClickIsAppointmentBooking:st,ValidFromDisable:me,ValidToDisable:lt,onChageFromDate:ae,onChageToDate:ze,TominDate:se,CheckboxDisable:$e,onClickIsExistingVehicle:ue,HideVehicleDD:pe,HideDriverDD:ge,onUploadDocument:be,documentUrl:E,onClickIsExistingDriver:le,OnChangePartyTypes:Qe,PartyTypeList:Se,PartyNameList:Ne,AreaList:Fe,RouteList:p,DriverList:je,VehicleList:ye,IsDeliveryChallan:Pe,IsInvoiceBased:oe,IsVehicleTripBased:xe,IsPartyDisable:Le,IsVehicleDetailsDisable:Y,ShowVisitorContranctor:A,IsMaterialDetailsShow:Mt,InvoiceNumberDisable:Ce,DcNumberDisable:ke,PoNumberDisable:Me,ContainerNumberDisable:Oe,StatusList:Ue,OnChangeVehicle:Ye,deleteDocuments:Be,handleHyperlink:Ae,cameraOff:Ve,setCameraOff:ot,handleChange:he,handleRouteSelect:Re,initFldDisable:Z,PurposeList:fe,handlePoVSelect:De,selectedPlant:rt,PlantList:Ze,handlePlantSelect:nt,handleDepartmentSelect:Xe,PlantWiseDepartmentList:qe,plantDisable:et}=N,We={icon:"las la-upload",iconOnly:!0};return t.jsx(na,{initialValues:x,validationSchema:w,onSubmit:u.handleSubmit,children:t.jsxs(t.Fragment,{children:[t.jsx(t.Fragment,{children:t.jsx("div",{className:"normal-table",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"col-12",children:t.jsxs("div",{className:"grid",children:[t.jsx(f,{type:"radiobox",name:"IsPreBooking",label:"Is Pre Booking ?",options:K,show:!1,required:!1,disable:I||!y,optionLabel:"",optionValue:"",handleSelect:"",handleChange:J,formik:u,fldStyle:"col-12 md:col-4"}),t.jsx(f,{type:"text",name:"VisitorEntryCode",label:"Visitor Entry Code ",options:"",show:!1,required:!1,disable:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:u}),t.jsx(f,{type:"select",name:"PlantId",label:"Plant Name",options:Ze,show:!0,required:!0,disable:!!(I||et),optionLabel:"PlantName",optionValue:"PlantId",handleSelect:nt,formik:u,fldStyle:"col-12 md:col-4"}),t.jsx(f,{type:"select",name:"DeptId",label:"Department Name",options:qe,show:!0,required:!0,disable:!!I,optionLabel:"DepartmentName",optionValue:"DepartmentId",handleSelect:Xe,formik:u,fldStyle:"col-12 md:col-4"}),t.jsx(f,{type:"select",name:"VisitorTypeId",label:"Visitor Type ",options:k,show:!1,required:!1,disable:I||!y||Z,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:z,fldStyle:"col-12 md:col-4",formik:u}),t.jsx(f,{type:"text",name:"PersonName",label:"Visitor Name ",options:"",show:!A,required:!1,disable:I||!y,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:u,maxlength:100}),t.jsx(f,{type:"Calendar",name:"VisitorEntryDate",label:"Visitor Entry Date",options:"",show:!1,required:!1,disable:!0,optionLabel:"",optionValue:"",handleChange:he,fldStyle:"col-12 md:col-4",formik:u,maxDate:new Date}),t.jsx(f,{type:"select",name:"VisitedEmployeeId",label:"Person to Visit",options:F,show:!0,required:!0,optionLabel:"UserName",optionValue:"UserId",handleSelect:T,fldStyle:"col-12 md:col-4",formik:u}),t.jsx(f,{type:"text",name:"MobileNo",label:"Mobile No ",options:"",show:!A,required:!1,disable:y?A:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:u,keyfilter:"int",maxlength:15,minLength:9}),t.jsx(f,{type:"select",name:"IdProofType",label:"ID Proof Type ",options:Q,show:!A,required:!1,disable:y?A:!0,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:T,fldStyle:"col-12 md:col-4",formik:u}),t.jsx(f,{type:"text",name:"IdProofNo",label:"ID Proof No ",options:"",show:!A,required:!1,disable:y?A:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:u,maxlength:"20"}),t.jsx(f,{type:"multi_select",name:"AreaToVisit",label:"Area To Visit ",options:Fe,show:!0,required:!1,disable:I||!y,optionLabel:"AreaName",optionValue:"AreaId",handleSelect:De,fldStyle:"col-12 md:col-4",formik:u}),t.jsx(f,{type:"Calendar",name:"ValidFrom",label:B?"Valid From":"Appointment Date",options:"",show:!0,required:!0,disable:!1,optionLabel:"",optionValue:"",handleChange:ae,fldStyle:"col-12 md:col-4",formik:u,minDate:new Date,showTime:!0}),t.jsx(f,{type:"Calendar",name:"ValidTo",label:"Valid To",options:"",show:B,required:!1,disable:!1,optionLabel:"",optionValue:"",handleChange:ze,fldStyle:"col-12 md:col-4",formik:u,minDate:se??new Date,showTime:!0}),t.jsx(f,{type:"text",name:"DcNumber",label:"Dc Number ",options:"",show:!ke,required:!1,disable:y?ke:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:u,maxlength:"20"}),t.jsx(f,{type:"text",name:"InvoiceNumber",label:"Invoice Number ",options:"",show:!Ce,required:!1,disable:y?Ce:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:u,maxlength:"20"}),t.jsx(f,{type:"text",name:"PoNumber",label:"Po Number ",options:"",show:!Me,required:!1,disable:y?Me:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:u,maxlength:"20"}),t.jsx(f,{type:"text",name:"ContainerNumber",label:"Container Number ",options:"",show:!Oe,required:!1,disable:y?Oe:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:u,maxlength:"20"}),t.jsx(f,{type:"select",name:"Status",label:"Status ",options:Ue,show:!1,required:!1,disable:!0,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:T,fldStyle:"col-12 md:col-4",formik:u}),t.jsx(f,{type:"",name:"",label:"",options:"",show:u.values.VisitorTypeId==66,required:!1,disable:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:u}),t.jsx(f,{type:"select",name:"PurposeOfVisit",label:"Purpose Of Visit ",options:fe,show:!0,required:!0,disable:!y,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:T,formik:u,fldStyle:"col-12 md:col-4",filter:!0}),t.jsx(f,{type:"textarea",name:"VisitorRemarks",label:"Visitor Remarks ",options:"",show:!1,required:!1,disable:I||!y,optionLabel:"",optionValue:"",handleSelect:"",formik:u,fldStyle:"col-12 md:col-4",maxlength:"500",style:{maxHeight:"100px",overflowY:"auto"}})]})})})})}),t.jsx("div",{className:"white",hidden:Y,children:t.jsx("div",{className:I?"p-disabled":"",children:t.jsx("div",{className:"widget-body",children:t.jsxs("div",{className:"normal-table",children:[t.jsx("div",{className:"page-title",children:t.jsx("div",{className:"grid grid-nogutter",children:t.jsx("div",{className:"md:col-6",children:t.jsx("h1",{children:"Vehicle & Driver Details"})})})}),t.jsxs("div",{className:"grid",children:[Z?t.jsx(f,{type:"",fldStyle:"col-12 md:col-3",show:!0}):t.jsx(f,{type:"checkbox",name:"IsExistingVehicle",label:"Is Existing Vehicle ",options:"",show:!0,required:!1,disable:I||!y,optionLabel:"",optionValue:"",handleChange:ue,fldStyle:"col-12 md:col-3",formik:u}),t.jsx(f,{type:"select",name:"VehicleName",label:"Vehicle Name ",options:ye,show:pe,required:!1,disable:I||!y,optionLabel:"VehicleNameAndNo",optionValue:"VehicleName",handleSelect:Ye,fldStyle:"col-12 md:col-3",formik:u}),t.jsx(f,{type:"text",name:"VehicleName",label:"Vehicle Name ",options:"",show:!pe,required:!1,disable:I||!y,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:u,maxlength:"50"}),t.jsx(f,{type:"text",name:"VehicleNo",label:"Vehicle No ",options:"",show:!0,required:!1,disable:y?pe:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:u,maxlength:"50"}),t.jsxs("div",{className:"col-12 md:col-3",children:[t.jsx("label",{className:"form-label",children:"Document Upload"}),t.jsxs("div",{className:"p-inputgroup",children:[t.jsx("div",{className:"browse-links",children:t.jsx(te,{label:u.values.VehicleDocumentName,link:!0,onClick:Ae})}),t.jsx($s,{mode:"basic",chooseOptions:We,url:"/api/upload",maxFileSize:1e6,onSelect:be,chooseLabel:E,auto:!0,disabled:I||!y}),t.jsx(te,{icon:"las la-times",disabled:I||!y,onClick:Be})]})]}),t.jsx(f,{type:"checkbox",name:"IsExistingDriver",label:"Is Existing Driver ",options:"",show:!0,required:!1,disable:I||!y,optionLabel:"",optionValue:"",handleChange:le,fldStyle:"col-12 md:col-3",formik:u}),t.jsx(f,{type:"select",name:"DriverId",label:"Driver Name ",options:F.filter(He=>He.DesignationId==5),show:ge,required:!1,disable:I||!y,optionLabel:"EmployeeName",optionValue:"EmployeeName",handleSelect:T,fldStyle:"col-12 md:col-3",formik:u}),t.jsx(f,{type:"text",name:"DriverId",label:"Driver Name ",options:"",show:!ge,required:!1,disable:I||!y,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:u,maxlength:"50"}),t.jsx(f,{type:"select",name:"RouteId",label:"Route ",options:p,show:!0,required:!1,disable:I||!y,optionLabel:"RouteName",optionValue:"RouteId",handleSelect:Re,fldStyle:"col-12 md:col-3",formik:u}),t.jsx(f,{type:"text",name:"NumberOfPassengers",label:"No.Of Passengers ",options:"",show:!0,required:!1,disable:y?Y:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:u,keyfilter:"int",maxlength:"10"}),t.jsx(f,{type:"",name:"",label:"",options:"",show:!0,required:!1,disable:I||!y,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:u}),t.jsx(f,{type:"number",name:"PlannedTravellingKm",label:"Planned Travelling Km ",options:"",show:!0,required:!1,disable:y?Y:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:u,maxFractionDigits:2,minFractionDigits:2,mode:"decimal",max:999999999}),t.jsx(f,{type:"number",name:"ActualTravellingKm",label:"Actual Travelling Km ",options:"",show:!0,required:!1,disable:y?Y:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:u,maxFractionDigits:2,minFractionDigits:2,mode:"decimal",max:999999999})]})]})})})})]})})},sl=N=>{const x=s.useRef(null),{toast:w,tabConfig:u,visitorEntryFormik:B,pageType:_,isCreate:M,isView:I,loading:ie,selectedData:K,setShowEntryDetail:k,setVisible:z,VisitorNameList:y,visitorEntryDetailList:T,setvisitorEntryDetailList:H,setVisitorTypeList:j,setIsPreBookingList:ce,setProofList:O,setStatusList:$,setTitleList:G,setEmployeeList:J,setDepartmentList:Te,setTempVisitorNameList:F,setVisitorNameList:ve,setPartyTypeList:Q,setAreaList:st,setRouteList:me,setDriverList:lt,setVehicleList:ae,setMaterialList:ze,setVisitorEntryBelongingDetailList:se,setList:$e,visitorEntryForm:ue,VisitorEntryValidationSchema:pe,onUpload:ge,itemTemplate:be,imageUrl:E,IsPreBookingList:le,VisitorTypeList:Qe,onChangeVisitorType:Se,handleSelect:Ne,autoCompleteRef:Fe,OnSelectVisitorCode:p,onChangeMatType:je,filteritemType:ye,handleIsPreBook:Pe,VECodeDisable:oe,EmployeeList:xe,onChangeVisitor:Le,ProofList:Y,onClickIsAppointmentBooking:A,ValidFromDisable:Mt,ValidToDisable:Ce,onChageFromDate:ke,TominDate:Me,CheckboxDisable:Oe,onClickIsExistingVehicle:Ue,HideVehicleDD:Ye,HideDriverDD:Be,onUploadDocument:Ae,documentUrl:Ve,onClickIsExistingDriver:ot,OnChangePartyTypes:he,PartyTypeList:Re,PartyNameList:Z,AreaList:fe,RouteList:De,DriverList:rt,VehicleList:Ze,IsDeliveryChallan:nt,IsInvoiceBased:Xe,IsVehicleTripBased:qe,IsPartyDisable:et,IsVehicleDetailsDisable:We,ShowVisitorContranctor:He,IsMaterialDetailsShow:dt,InvoiceNumberDisable:Et,DcNumberDisable:tt,PoNumberDisable:wt,ContainerNumberDisable:ct,StatusList:mt,OnChangeVehicle:Ee,onChageToDate:ut,deleteDocuments:pt,handleHyperlink:Tt,cameraOff:ci,setCameraOff:vt,handleChange:re,handleRouteSelect:Ft,initFldDisable:ne,CreatePageOnLoadCVisitorEntry:jt,resetAllForm:mi,IsWorkerDetailsShow:ui,IsBelongingDetailsShow:Pt,VisitorEntryBelongingDetailList:pi,VisitorEntryMaterialDetailList:yi,setVisitorEntryMaterialDetailList:Vi,MaterialList:hi,PurposeList:kt,IsdisableSave:yt,handlePoVSelect:Ot,selectedPlant:Vt,PlantList:Ut,handleVisitorSelected:Bt,handlePlantSelect:At,handleDepartmentSelect:it,PlantWiseDepartmentList:Rt,setPlantWiseDepartmentList:at,plantDisable:qt}=N;return da(),s.useEffect(()=>{di()}),s.useEffect(()=>{M==!1?$e():jt(0)},[]),t.jsx(t.Fragment,{children:t.jsxs("div",{className:"white",ref:x,children:[t.jsx("div",{className:"widget-hdr",children:t.jsx("div",{className:"sub-title",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"col-12",children:t.jsx("h2",{children:"Host Information"})})})})}),t.jsx("div",{className:"widget-body",children:ie?t.jsx(ra,{}):t.jsx(t.Fragment,{children:t.jsx(al,{visitorEntryForm:ue,VisitorEntryValidationSchema:pe,formik:B,onUpload:ge,itemTemplate:be,isView:I,imageUrl:E,IsPreBookingList:le,VisitorTypeList:Qe,onChangeVisitorType:Se,isCreate:M,handleSelect:Ne,autoCompleteRef:Fe,OnSelectVisitorCode:p,onChangeMatType:je,filteritemType:ye,VisitorNameList:y,handleIsPreBook:Pe,VECodeDisable:oe,EmployeeList:xe,onChangeVisitor:Le,ProofList:Y,onClickIsAppointmentBooking:A,ValidFromDisable:Mt,ValidToDisable:Ce,onChageFromDate:ke,TominDate:Me,CheckboxDisable:Oe,onClickIsExistingVehicle:Ue,HideVehicleDD:Ye,HideDriverDD:Be,onUploadDocument:Ae,documentUrl:Ve,onClickIsExistingDriver:ot,OnChangePartyTypes:he,PartyTypeList:Re,PartyNameList:Z,AreaList:fe,RouteList:De,DriverList:rt,VehicleList:Ze,PurposeList:kt,IsDeliveryChallan:nt,IsInvoiceBased:Xe,IsVehicleTripBased:qe,IsPartyDisable:et,IsVehicleDetailsDisable:We,ShowVisitorContranctor:He,IsMaterialDetailsShow:dt,InvoiceNumberDisable:Et,DcNumberDisable:tt,PoNumberDisable:wt,ContainerNumberDisable:ct,StatusList:mt,OnChangeVehicle:Ee,onChageToDate:ut,deleteDocuments:pt,handleHyperlink:Tt,cameraOff:ci,setCameraOff:vt,handleChange:re,handleRouteSelect:Ft,initFldDisable:ne,IsdisableSave:yt,handlePoVSelect:Ot,PlantList:Ut,selectedPlant:Vt,pageType:_,handlePlantSelect:At,handleDepartmentSelect:it,PlantWiseDepartmentList:Rt,plantDisable:qt})})})]})})};function ll(){const{search:N}=Os();return s.useMemo(()=>new URLSearchParams(N),[N])}const ol=N=>{const{successData:x}=N;return t.jsx("div",{className:"flex flex-row justify-content-center align-items-center h-full",children:t.jsx("div",{className:"align-items-center flex flex-row justify-content-center m-auto w-9 white p-5 border-round-3xl",children:t.jsx("div",{className:"col-12",children:t.jsxs("div",{className:"card mb-0 text-center",children:[t.jsx("div",{className:"flex justify-content-between mb-3",children:t.jsx("div",{className:"m-auto align-items-center bg-green-100 border-round-lg flex justify-content-center p-3",children:t.jsx("i",{className:"pi pi-check text-green-500 text-xl"})})}),t.jsx("h1",{className:"text-green-500 text-3xl",children:"Appointment Sent for Approval, will notify you the Status shortly on Mail/ WhatsApp."}),t.jsxs("span",{className:"text-green-500 text-2xl font-large",children:["Your Reference No: ",t.jsx("b",{children:x.VisitorEntryCode})]})]})})})})},Al=N=>{const x=oa(),[w,u]=s.useState(!1),[B,_]=s.useState([]),[M,I]=s.useState(!1),[ie,K]=s.useState({}),[k,z]=s.useState(!0),[y,T]=s.useState(!1),[H,j]=s.useState(!1);s.useState(!1);const[ce,O]=s.useState([]),[$,G]=s.useState([]);s.useState({});const[J,Te]=s.useState([]),[F,ve]=s.useState(""),[Q,st]=s.useState("");s.useState(!1);const[me,lt]=s.useState(),[ae,ze]=s.useState(),[se,$e]=s.useState(),[ue,pe]=s.useState(!1),[ge,be]=s.useState(!1),[E,le]=s.useState({});s.useState(!1);const[Qe,Se]=s.useState([]),[Ne,Fe]=s.useState([]),p=s.useRef(),[je,ye]=s.useState(!1),[Pe,oe]=s.useState([]),[xe,Le]=s.useState([]),[Y,A]=s.useState([]),[Mt,Ce]=s.useState([]),[ke,Me]=s.useState([]),[Oe,Ue]=s.useState([]),[Ye,Be]=s.useState([]),[Ae,Ve]=s.useState([]),[ot,he]=s.useState(Lt.NO_IMG),[Re,Z]=s.useState(null),[fe,De]=s.useState(null),rt=s.useRef(null),[Ze,nt]=s.useState([]),[Xe,qe]=s.useState([]),[et,We]=s.useState([]),[He,dt]=s.useState([]),[Et,tt]=s.useState([]),[wt,ct]=s.useState([]),[mt,Ee]=s.useState([]),[ut,pt]=s.useState(),[Tt,ci]=s.useState(!0),[vt,re]=s.useState(!0),[Ft,ne]=s.useState(!0),[jt,mi]=s.useState(null),[ui,Pt]=s.useState(!1),[pi,yi]=s.useState(!1),[Vi,hi]=s.useState(!1),[kt,yt]=s.useState(!1),[Ot,Vt]=s.useState(!1),[Ut,Bt]=s.useState(!1),[At,it]=s.useState(!1),[Rt,at]=s.useState(!0),[qt,ht]=s.useState(!1),[ma,Wt]=s.useState(!1),[ua,fi]=s.useState(!1),[pa,Di]=s.useState(!0),[Ii,U]=s.useState(!1),[Ht,Ge]=s.useState([]),[gi,we]=s.useState([]),[ya,bi]=s.useState([]),[Gt,ft]=s.useState(""),[Va,Jt]=s.useState(!0),[ha,Si]=s.useState(!0),[fa,Ni]=s.useState(!0),[Da,_t]=s.useState(!0),[Ia,rl]=s.useState(!0);s.useState(!0),s.useState({});const[ga,xi]=s.useState([]),[ba,Dt]=s.useState([]);s.useState();const[Li,Ci]=s.useState(!1),[Sa,Kt]=s.useState(!1),[Na,xa]=s.useState(),P=da(),La=[{Id:1,CountryCode:"+91",CountryName:"India"}],{isCreate:R,isView:Mi,SearchData:nl,loading:Ca,error:dl,tranStatus:cl,DtoEmployeeList:ml,DtoDepartmentList:Ei,DtoStatusList:wi,DtoTitleList:Ti,DtoIsPreBookingList:Ma,DtoVisitorTypeList:Ea,DtoProofList:vi,DtoVisitorEntryTypeList:ul,DtoVisitorEntryHeader:l,DtoVisitorEntryDetail:Fi,DtoVisitorEntryBelongingDetail:wa,DtoVisitorEntryMaterialDetail:Ta,DtoVisitorEntryList:pl,DtoVisitorEntryCodeList:yl,DtoVisitorEmployeeList:Vl,DtoVisitorNameList:va,DtoVisitorWorkerList:hl,DtoPreBookingList:fl,DtoPartyTypeList:Fa,DtoAreaList:Dl,DtoRouteList:ja,DtoPartyNameList:Il,DtoDriverList:Pa,DtoVehicleList:ka,DtoMaterialList:Oa,DtoPurposeList:Ua,DtoVisitorEntryPovDetail:ji,DtoPlantList:Ba}=sa(e=>e.externalBookEntry),Aa={VisitorEntryId:l?l.VisitorEntryId:0,VisitorEntryCode:l?l.VisitorEntryCode:"",VisitorEntryDate:l?new Date(l.VisitorEntryDate):new Date,CompanyId:l?l.CompanyId:localStorage.CompanyId,PlantId:l?l.PlantId:null,GateId:l?l.GateId:localStorage.GateId,VisitorTypeId:l?l.VisitorTypeId:35,VisitorId:l?l.VisitorId:null,PersonName:l?l.PersonName:"",MobileNo:l?l.MobileNo:"",TagNo:l?l.TagNo:"",IdProofType:l?l.IdProofType:null,IdProofNo:l?l.IdProofNo:"",VisitedEmployeeId:l?l.VisitedEmployeeId:null,ValidFrom:l?new Date(l.ValidFrom):new Date,ValidTo:l?new Date(l.ValidTo):new Date,AccessType:l?l.AccessType:null,IsExtended:l?l.IsExtended:!1,IsAppointmentBooking:l?l.IsAppointmentBooking:!1,IsPreBooking:l?l.IsPreBooking:16,VisitorRemarks:l?l.VisitorRemarks:"",PurposeOfVisit:l?l.PurposeOfVisit:"",AreaToVisit:l?l.AreaToVisit:null,VisitorImageName:l?l.VisitorImageName:"",VisitorImageUrl:l?l.VisitorImageUrl:"",PartyType:l?l.PartyType:null,PartyName:l?l.PartyName:null,InvoiceNumber:l?l.InvoiceNumber:"",DcNumber:l?l.DcNumber:"",PoNumber:l?l.PoNumber:"",ContainerNumber:l?l.ContainerNumber:"",IsExistingVehicle:l?l.IsExistingVehicle:null,VehicleName:l?l.VehicleName:"",VehicleNo:l?l.VehicleNo:"",IsExistingDriver:l?l.IsExistingDriver:null,DriverId:l?l.DriverId:"",VehicleDocumentName:l?l.VehicleDocumentName:"",VehicleDocumentUrl:l?l.VehicleDocumentUrl:"",RouteId:l?l.RouteId:null,NumberOfPassengers:l?l.NumberOfPassengers:"",PlannedTravellingKm:l?l.PlannedTravellingKm:"",ActualTravellingKm:l?l.ActualTravellingKm:"",Status:l?l.Status:74,CreatedBy:0,CreatedOn:l?new Date(l.CreatedOn):new Date,ModifiedBy:0,ModifiedOn:l?new Date:null,IsExternal:0,IsInternalAppointment:1};function Ra(e){e.matches?Ci(!0):Ci(!1)}s.useEffect(()=>{var e=window.matchMedia("(max-width: 767px)");e.addEventListener("change",function(){Ra(e)})});const d=ri({initialValues:Aa,validationSchema:Qs,onSubmit:(e,{resetForm:n})=>{U(!0);const i=new FormData;let a=$,o=Ht,r=gi;e.VisitorTypeId==35&&(r=[]),e.VisitorTypeId==36&&(r=[]),e.VisitorTypeId==64&&(a=[],o=[]),e.VisitorTypeId==65&&(a=[],o=[]),e.VisitorTypeId==66&&(r=[],a=[]);let c=[],V=[],g=[],q=new Date(e.ValidFrom.getFullYear(),e.ValidFrom.getMonth(),e.ValidFrom.getDate());if(q.setHours(23,59,59,999),a.length>0)for(let S=0;S<a.length;S++){const D=a[S];let h={};h.VisitorEntryDetailId=D.VisitorEntryDetailId??0,h.VisitorEntryDetailCode=D.visitordetailCode,h.VisitorEntryId=D.VisitorEntryId??0,h.TitleId=D.TitleId,h.FirstName=D.FirstName,h.LastName=D.LastName,h.DepartmentId=D.DepartmentId,h.Dob=D.Dob,h.MailId=D.MailId,h.MobileNo=D.MobileNo,h.IdCardType=D.IdCardType,h.IdCardNo=D.IdCardNo,h.DocumentName=D.DocumentName,h.DocumentUrl=D.DocumentName,h.Status=D.Status,h.ValidFrom=Ct(e.ValidFrom),h.ValidTo=e.VisitorTypeId==35?ee(q):Ct(e.ValidTo),c.push(h)}if(o.length>0)for(let S=0;S<o.length;S++){const D=o[S];let h={};h.VisitorEntryBelongingDetailId=D.VisitorEntryBelongingDetailId??0,h.VisitorEntryId=D.VisitorEntryId??0,h.DeviceNo=D.DeviceNo,h.DeviceName=D.DeviceName,V.push(h)}if(r.length>0)for(let S=0;S<r.length;S++){const D=r[S];let h={};h.VisitorEntryMaterialDetailId=D.VisitorEntryMaterialDetailId??0,h.VisitorEntryId=D.VisitorEntryId??0,h.MaterialId=D.MaterialId,h.Uom=D.Uom,h.Qty=D.Qty,g.push(h)}var W=new Date(e.ValidFrom.getFullYear(),e.ValidFrom.getMonth(),e.ValidFrom.getDate());W.setHours(23,59,59,999),e.ValidFrom=ee(new Date(e.ValidFrom)),e.ValidTo=e.VisitorTypeId==35?ee(W):ee(new Date(e.ValidTo)),e.VisitorEntryDate=ee(new Date(e.VisitorEntryDate)),e.CreatedOn=ee(new Date(e.CreatedOn)),e.TagNo=b.values.TagNo,e.CompanyId=+localStorage.CompanyId,e.IsInternalAppointment=!0,e.IsExternal=!1,R||(e.ModifiedOn=ee(new Date(e.ModifiedOn)));let C=JSON.stringify({VisitorEntry:e,VisitorEntryDetail:c??[],VisitorEntryBelongingDetail:V??[],VisitorEntryMaterialDetail:g??[],VisitorEntryAtvDetail:ba??[]});if(i.append("input",C),i.append("webfile",Re),i.append("webfile1",fe),i.append("webfiles",[]),R==!1){var v=P(la(i));v.then(S=>{var D,h;S.payload.tranStatus.result==!0?((D=p.current)==null||D.show({severity:"success",summary:"Success Message",detail:S.payload.tranStatus.lstErrorItem[0].Message}),setTimeout(()=>{x.push("/home/vVisitorEntry")},800),j(!1)):((h=p.current)==null||h.show({severity:"error",summary:"Error Message",detail:S.payload.tranStatus.lstErrorItem[0].Message}),U(!1))}).catch(S=>{var D;U(!1),(D=p.current)==null||D.show({severity:"error",summary:"Error",detail:JSON.stringify(S)})})}else{var v=P(Us(i));v.then(D=>{var h;D.payload.tranStatus.result==!0?(U(!1),I(!0),K(D.payload.VisitorEntryHeader),j(!1),$t()):(U(!1),(h=p.current)==null||h.show({severity:"error",summary:"Error",detail:D.payload.tranStatus.lstErrorItem[0].Message}))}).catch(D=>{var h;U(!1),(h=p.current)==null||h.show({severity:"error",summary:"Error",detail:JSON.stringify(D)})})}}}),zt=(e,n)=>{O(n);let i=n.filter(a=>a.VisitorId===e);_(i),Oi("VisitorId",{},i[0].VisitorId,n)};s.useEffect(()=>{});const qa=()=>{Ue(Ea),Me(Ma),Be(vi),A(wi),Ce(Ti),Le(Ei),Ve(va),qe(Fa),dt(ja),ct(Pa),Ee(ka),bi(Oa),xi(Ua);let e=[];for(let i=0;i<Fi.length;i++){const a=Fi[i];let o={};o.VisitorEntryDetailId=a.VisitorEntryDetailId,o.VisitorEntryDetailCode=a.visitordetailCode??0,o.VisitorEntryId=a.VisitorEntryId,o.VisitorId=a.VisitorId,o.TitleId=a.TitleId,o.FirstName=a.FirstName,o.LastName=a.LastName,o.DepartmentId=a.DepartmentId,o.Dob=new Date(a.Dob),o.MailId=a.MailId,o.MobileNo=a.MobileNo,o.IdCardType=a.IdCardType,o.IdCardNo=a.IdCardNo,o.DocumentName=a.DocumentName,o.DocumentUrl=a.DocumentUrl,o.Status=a.Status,o.VisitorName=Ti.find(c=>c.MetaSubId==a.TitleId).MetaSubDescription+"."+o.FirstName+" "+o.LastName,o.StatusName=wi.find(c=>c.MetaSubId==a.Status).MetaSubDescription,o.IdCardTypeName=vi.find(c=>c.MetaSubId==a.IdCardType).MetaSubDescription,a.DepartmentId?o.DepartMentName=Ei.find(c=>c.DepartmentId==a.DepartmentId).DepartmentName:o.DepartMentName="";const r=new Date(a.Dob).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});o.ShowDate=r,e.push(o)}G(e),Ge(wa),we(Ta),Dt(ji),gt("VisitorTypeId",{},l.VisitorTypeId),l.PartyType&&Ui("PartyType",{},l.PartyType);let n=ji.map(i=>i.AreaToVisit);ki("AreaToVisit",{},n,1),It(l.VisitorImageUrl).then(i=>{const a=new File([i],l.VisitorImageName,{type:"image/*",lastModified:1695716506050});Z(a),he(l.VisitorImageUrl)}).catch(i=>{var a;(a=p.current)==null||a.show({severity:"error",detail:"Error",summary:JSON.stringify(i)})}),(l.VisitorTypeId==64||l.VisitorTypeId==65||l.VisitorTypeId==66)&&It(l.VehicleDocumentUrl).then(i=>{const a=new File([i],l.VehicleDocumentName,{type:"image/*",lastModified:1695716506050});De(a),ft(l.VehicleDocumentUrl)}).catch(i=>{var a;(a=p.current)==null||a.show({severity:"error",detail:"Error",summary:JSON.stringify(i)})})},Wa=e=>{var i=P(ni({VisitorEntryId:e,CompanyId:1,RoleId:1}));i.then(a=>{var o;if(a.payload.tranStatus.result==!0){if(console.log(Ie.size,Ie.get("PlantId")),Ie&&Ie.size>=0&&Ie.get("PlantId")!=""&&Ie.get("PlantId")!=null&&d.values.PlantId==null){let r=a.payload.PlantList.filter(c=>c.PlantId==+Ie.get("PlantId"));r&&r.length>0?(qi("PlantId",{},+Ie.get("PlantId")),Kt(!0)):Kt(!1)}else Kt(!1);if(Ue(a.payload.VisitorTypeList),Me(a.payload.IsPreBookingList),Be(a.payload.ProofList),A(a.payload.StatusList),Ce(a.payload.TitleList),Le(a.payload.DepartmentList),Ve(a.payload.VisitorNameList),O(a.payload.VisitorNameList),qe(a.payload.PartyTypeList),dt(a.payload.RouteList),ct(a.payload.DriverList),Ee(a.payload.VehicleList),pt(a.payload.VehicleList),bi(a.payload.MaterialList),xi(a.payload.PurposeList),R==!0){+(E==null?void 0:E.selectedType)!=66&&+(E==null?void 0:E.selectedType);let r={};r.VisitorEntryMaterialDetailId=0,r.VisitorEntryId=0,r.MaterialId=null,r.Uom=null,r.Qty="",we([r])}}else(o=p.current)==null||o.show({severity:"error",detail:"Error",summary:a.payload.tranStatus.lstErrorItem[0].Message})}).catch(a=>{var o;(o=p.current)==null||o.show({severity:"error",detail:"Error",summary:JSON.stringify(a)})})};s.useEffect(()=>{});const Pi=(e,n,i)=>{d.setFieldValue(e,i),e=="PlantId"&&(xa(i),d.setFieldValue("AreaToVisit",null))},ki=(e,n,i,a=0)=>{if(d.setFieldValue(e,i),a==0){Dt([]);let o=[];for(let r=0;r<i.length;r++){const c=i[r];let V={};V.VisitorEntryAtvDetailId=0,V.VisitorEntryId=0,V.AreaToVisit=c,o.push(V)}Dt(o)}},Ha=(e,n,i)=>{d.setFieldValue(e,i);let a=He.find(o=>o.RouteId==i).RouteDistanceInKm;d.setFieldValue("PlannedTravellingKm",a)},Ga=e=>{d.setFieldValue(e.target.name,e.value)},Ja=(e,n,i)=>{d.setFieldValue(e,i)},X=e=>{var n;U(!1),(n=p.current)==null||n.show({severity:"warn",summary:"Warning Message",detail:e})},ee=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});async function It(e){const n=await Bs(e);if(!n.ok)throw new Error(`Failed to fetch image: ${n.statusText}`);return await n.blob()}const $t=()=>{d.resetForm();let e={},n={};e.VisitorEntryBelongingDetailId=0,e.VisitorEntryId=0,e.DeviceNo="",e.DeviceName="Mobile",n.VisitorEntryBelongingDetailId=0,n.VisitorEntryId=0,n.DeviceNo="",n.DeviceName="Laptop",Ge([e,n]);let i={};i.VisitorEntryMaterialDetailId=0,i.VisitorEntryId=0,i.MaterialId=null,i.Uom=null,i.Qty="",we([i]),we([]),Dt([]),Z(null),he(Lt.NO_IMG),De(null),ft(""),tt([]),Wi(0)},Oi=(e,n,i,a)=>{if(d.setFieldValue(e,i),a.length>0){let r=a.find(c=>c.VisitorId==i);if(r&&(d.setFieldValue("PersonName",r.FirstName),d.setFieldValue("MobileNo",r.MobileNo),d.setFieldValue("IdProofType",r.IdCardType),d.setFieldValue("IdProofNo",r.IdCardNo),d.setFieldValue("TagNo",r.TagNo),ht(!1),G([]),d.values.VisitorTypeId==36||d.values.VisitorTypeId==35)){let c={VisitorTypeId:d.values.VisitorTypeId,VisitorId:i,Detail:1};var o=P(As(c));o.then(V=>{var g;if(V.payload.tranStatus.result==!0){let q=V.payload.VisitorWorkerList;for(let W=0;W<q.length;W++){const de=q[W];de.Dob=new Date(de.Dob);const C=de.Dob.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});de.ShowDate=C}G(q)}else(g=p.current)==null||g.show({severity:"error",detail:"Error",summary:V.payload.tranStatus.lstErrorItem[0].Message})}).catch(V=>{var g;(g=p.current)==null||g.show({severity:"error",detail:"Error",summary:JSON.stringify(V)})})}}};s.useEffect(()=>{var e;$&&$.length>0&&(d.handleSubmit(),U(!1),(e=p.current)==null||e.show({severity:"success",summary:"Success Message",detail:"Appoinment Booked Succeessfully"}))},[$]);const Ui=(e,n,i)=>{d.setFieldValue(e,i);var o=P(Rs({PartyType:i}));o.then(r=>{var c;r.payload.tranStatus.result==!0?tt(r.payload.PartyNameList):(c=p.current)==null||c.show({severity:"error",detail:"Error",summary:r.payload.tranStatus.lstErrorItem[0].Message})}).catch(r=>{var c;(c=p.current)==null||c.show({severity:"error",detail:"Error",summary:JSON.stringify(r)})})},Bi=e=>{d.setFieldValue(e.target.name,e.checked);let n=e.value?e.value:d.values.VisitorTypeId,i={target:{name:"ValidFrom"},value:l?new Date(l.ValidFrom):new Date,VisitorTypeId:n},a={target:{name:"IsExistingVehicle"},checked:l?l.IsExistingVehicle:!0};Ai(a);let o={target:{name:"IsExistingDriver"},checked:l?l.IsExistingDriver:!0};if(Ri(o),it(!0),yt(!1),Vt(!1),Bt(!1),at(!0),Di(!0),ht(!1),R){d.setFieldValue("PartyType",null),d.setFieldValue("PartyName",null),d.setFieldValue("RouteId",null),d.setFieldValue("NumberOfPassengers",""),d.setFieldValue("PlannedTravellingKm",""),d.setFieldValue("ActualTravellingKm",""),d.setFieldValue("ValidFrom",new Date),d.setFieldValue("ValidTo",new Date),tt([]),we([]),Ge([]);let r={},c={};r.VisitorEntryBelongingDetailId=0,r.VisitorEntryId=0,r.DeviceNo="",r.DeviceName="Mobile",c.VisitorEntryBelongingDetailId=0,c.VisitorEntryId=0,c.DeviceNo="",c.DeviceName="Laptop",Ge([r,c]);let V={};V.VisitorEntryMaterialDetailId=0,V.VisitorEntryId=0,V.MaterialId=null,V.Uom=null,V.Qty="",we([V])}Wt(!1),fi(!1),Jt(!0),Si(!0),Ni(!0),_t(!0),Pt(!0),n==35?(Wt(!0),Pt(!1),e.checked?(re(!1),ne(!0)):(re(!0),ne(!0)),Qt(i)):n==36?(Wt(!0),fi(!0),e.checked?(re(!1),ne(!1),Qt(i)):(re(!0),ne(!0))):(Di(!1),n==64?(it(!1),yt(!0),at(!1),ht(!0),re(!0),ne(!0),Jt(!1),Si(!1),_t(!1)):n==65?(it(!1),Vt(!0),at(!1),ht(!0),re(!0),ne(!0),Jt(!1),Ni(!1),_t(!1)):n==66&&(Bt(!0),at(!1),re(!0),ne(!0)))},_a=e=>{d.setFieldValue(e.target.name,e.value),e.value==15?x.push("/home/vVisitorEntry"):(d.setFieldValue("VisitorEntryCode",""),d.setFieldValue("VisitorEntryDate",new Date),gt("VisitorTypeId",{},35),li("VisitorTypeId",{},35))},Qt=e=>{d.setFieldValue(e.target.name,e.value);let n=e.VisitorTypeId?e.VisitorTypeId:d.values.VisitorTypeId;n==35?d.setFieldValue("ValidTo",e.value):n==36&&(d.setFieldValue("ValidTo",null),mi(e.value))},Ka=e=>{d.setFieldValue(e.target.name,e.value)},Ai=e=>{d.setFieldValue(e.target.name,e.checked),R&&(d.setFieldValue("VehicleName",""),d.setFieldValue("VehicleNo","")),yi(e.checked)},za=(e,n,i)=>{d.setFieldValue(e,i),d.setFieldValue("VehicleNo",mt.find(a=>a.VehicleName==i).VehicleNo)},Ri=e=>{d.setFieldValue(e.target.name,e.checked),R&&d.setFieldValue("DriverId",""),hi(e.checked)},$a=(e,n,i)=>{d.setFieldValue(e,i)},Qa=e=>{Z(e),d.setFieldValue("VisitorImageName",e.name),d.setFieldValue("VisitorImageUrl",e.name);const n=URL.createObjectURL(e);he(n)},Ya=e=>{De(e.files[0]),d.setFieldValue("VehicleDocumentName",e.files[0].name),d.setFieldValue("VehicleDocumentUrl",e.files[0].name);const n=URL.createObjectURL(e.files[0]);ft(n)},Za=()=>{ft(""),De(null),d.setFieldValue("VehicleDocumentName",""),d.setFieldValue("VehicleDocumentUrl","")},Xa=()=>{Gt!=""&&window.open(Gt,"_blank")},es=()=>t.jsxs("div",{className:"flex align-items-center flex-column",children:[t.jsx("i",{className:"pi pi-image mt-3 p-5",style:{fontSize:"5em",borderRadius:"50%",backgroundColor:"var(--surface-b)",color:"var(--surface-d)"}}),t.jsx("span",{style:{fontSize:"1.2em",color:"var(--text-color-secondary)"},className:"my-5",children:"Drag and Drop Image Here"})]}),gt=(e,n,i)=>{console.log(e,n,i),O([]),R&&G([]),d.setFieldValue(e,i);let a={VisitorTypeId:i,CompanyId:+localStorage.CompanyId,RoleId:1};var o=P(qs(a));o.then(r=>{var c;r.payload.tranStatus.result==!0?(O(r.payload.VisitorNameList),Ve(r.payload.VisitorNameList),Ee(r.payload.VehicleList),pt(r.payload.VehicleList),R&&(d.setFieldValue("VisitorId",null),d.setFieldValue("PersonName",""),d.setFieldValue("MobileNo",""),d.setFieldValue("IdProofType",null),d.setFieldValue("IdProofNo",""),d.setFieldValue("InvoiceNumber",""),d.setFieldValue("DcNumber",""),d.setFieldValue("PoNumber",""),d.setFieldValue("ContainerNumber","")),Bi({target:{name:"IsAppointmentBooking"},checked:!0,value:i})):(c=p.current)==null||c.show({severity:"error",detail:"Error",summary:r.payload.tranStatus.lstErrorItem[0].Message})}).catch(r=>{var c;(c=p.current)==null||c.show({severity:"error",detail:"Error",summary:JSON.stringify(r)})})},qi=(e,n,i)=>{d.setFieldValue("DeptId",null),d.setFieldValue("VisitedEmployeeId",null),d.setFieldValue("AreaToVisit",null),oe([]),Ji([]),We([]),d.setFieldValue(e,i);var o=P(Ws({PlantId:i}));o.then(r=>{var c;r.payload.tranStatus.result==!0?(Ji(r.payload.OnchangePlantList),We(r.payload.AreaList)):(c=p.current)==null||c.show({severity:"error",detail:"Error",summary:r.payload.tranStatus.lstErrorItem[0].Message})}).catch(r=>{var c;(c=p.current)==null||c.show({severity:"error",detail:"Error",summary:JSON.stringify(r)})})},ts=(e,n,i)=>{d.setFieldValue(e,i);var o=P(Hs({DeptId:i}));o.then(r=>{var c;r.payload.tranStatus.result==!0?oe(r.payload.EmployeeList):(c=p.current)==null||c.show({severity:"error",detail:"Error",summary:r.payload.tranStatus.lstErrorItem[0].Message})}).catch(r=>{var c;(c=p.current)==null||c.show({severity:"error",detail:"Error",summary:JSON.stringify(r)})})};s.useEffect(()=>{localStorage.setItem("CompanyId","1"),di(),le({...E,selectedType:35}),(k||!k)&&(Wi(0),ia({value:!1}))},[k]),s.useEffect(()=>{k||(((E==null?void 0:E.selectedType)!=66||(E==null?void 0:E.selectedType)!=65)&&me&&ae&&Object.keys(me).length>0&&Object.keys(ae).length>0&&me&&ae&&j(!0),se&&Object.keys(se).length>0&&j(!0),ue&&j(!0))},[me,ae,se,ue]);const Wi=e=>{if(k){const i={VisitorEntryId:e,CompanyId:+localStorage.CompanyId||"1",RoleId:1};var n=P(ni(i));n.then(a=>{a.payload.tranStatus.result==!0&&(O(a.payload.VisitorNameList),Ve(a.payload.VisitorNameList))}).catch(a=>{})}else{const i={VisitorEntryId:e,CompanyId:+localStorage.CompanyId,RoleId:1};var n=P(ni(i));n.then(o=>{o.payload.tranStatus.result==!0&&(O(o.payload.VisitorNameList),Ve(o.payload.VisitorNameList))}).catch(o=>{})}};Ts.Fragment,s.useEffect(()=>{const e=setTimeout(()=>{if(Q=="visit_search"){const n=Ae.filter(i=>i.FirstName.toLowerCase().includes(F.toLowerCase()));O(n),F==""&&O(Ae)}if(Q=="host_search"){const n=J.filter(i=>i.EmployeeName.toLowerCase().includes(F.toLowerCase()));oe(n),F==""&&oe(J)}if(Q=="vehicle_search"){const n=ut.filter(i=>i.VehicleNo.includes(F));Ee(n),F==""&&Ee(ut)}if(Q=="appointment_search"){const n=Ne.filter(i=>i.VisitorEntryCode.includes(F));Se(n),F==""&&Se(Ne)}},10);return()=>clearTimeout(e)},[F,Q]);const Hi=()=>{w?(localStorage.setItem("visMaster",JSON.stringify(d.values)),u(!1)):as(d.values)==!0&&u(!0)},is=e=>{const n=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/;return e.TitleId==""||e.TitleId==null?X("Please Select Title."):e.FirstName==""||e.FirstName==null?X(`Please Enter ${y?"Worker":"Visitor"} Name.`):e.MailId==""||e.MailId==null?X("Please enter Mail ID."):n.test(e.MailId)?e.MobileNo==""||e.MobileNo==null?X("Please Enter Mobile No."):e.MobileNo.length!=10?X("Please Enter Valid Mobile No."):!0:X("Please Enter Valid Mail ID.")},as=e=>e.PlantId==""||e.PlantId==null?X("Please Select Plant"):e.VisitedEmployeeId?!e.ValidFrom&&e.VisitorTypeId!=36?X("Please Select Appointment Date"):e.PurposeOfVisit==null||e.PurposeOfVisit==""?X("Please Select Purpose Of Visit"):!0:X("Please Select Person To Visit"),ss=()=>{b.handleSubmit()},ls=s.useRef();s.useRef();const[os,Gi]=s.useState(Lt.NO_IMG);s.useState("");const[Yt,Zt]=s.useState(""),[L,Je]=s.useState([]),[rs,Ji]=s.useState([]),[gl,ns]=s.useState(null);s.useState(null);const[ds,_i]=s.useState(null),[_e,Xt]=s.useState([]),[ei,bl]=s.useState([]),[Sl,Ki]=s.useState(!0),[cs,ti]=s.useState([]),[ms,bt]=s.useState([]);s.useState(!1),s.useRef();const St=s.useRef(),zi=s.useRef(),[Nt,$i]=s.useState(-1);s.useState({global:{value:null,matchMode:vs.CONTAINS}}),s.useState("");const Ie=ll();s.useEffect(()=>{di(),localStorage.setItem("CompanyId","1")});const{isCreateVM:us,isViewVM:ps,createEditData:Nl,loadingVM:xl,errorVM:Ll,tranStatusVM:Cl,VisitorHeaderVM:m,VisitorTypeListVM:ys,TitleListVM:xt,IdCardListVM:ii,StatusListVM:Vs,CountryListVM:hs,StateListVM:ai,CityListVM:si,DepartmentListVM:Ml,VisitorDetailVM:Qi,VisitorSearchList:El,WorkSeverityListVM:Yi}=sa(e=>e.externalBookVisitor);s.useEffect(()=>{if(R==!1||Mi==!0){R||(m.VisitorTypeId==35?Ki(!0):Ki(!1));let n=[];for(let i=0;i<Qi.length;i++){const a=Qi[i];let o={};o.VisitorDetailId=a.VisitorDetailId,o.VisitorId=a.VisitorId,o.TitleId=a.TitleId,o.FirstName=a.FirstName,o.LastName=a.LastName,o.DepartmentId=a.DepartmentId,o.Dob=new Date(a.Dob),o.MailId=a.MailId,o.MobileNo=a.MobileNo,o.IdCardType=a.IdCardType,o.IdCardNo=a.IdCardNo,o.DocumentName=a.DocumentName,o.DocumentUrl=a.DocumentUrl,o.Status=a.Status,o.ExpirryDate=a.ExpirryDate,o.WorkSeverity=a.WorkSeverity,o.VisitorName=xt.find(V=>V.MetaSubId==o.TitleId).MetaSubDescription+". "+a.FirstName+" "+a.LastName,o.DepartMentName=a.DepartmentId?xe.find(V=>V.DepartmentId==a.DepartmentId).DepartmentName:null,o.IdCardTypeName=ii.find(V=>V.MetaSubId==a.IdCardType).MetaSubDescription,o.StatusName=Y.find(V=>V.MetaSubId==a.Status).MetaSubDescription,o.WorkSeverityName=Yi.find(V=>V.MetaSubId==a.WorkSeverity).MetaSubDescription;const r=new Date(a.Dob).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});o.ShowDate=r;const c=new Date(a.ExpirryDate).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});o.ShowExpirryDate=c,n.push(o),It(o.DocumentUrl).then(V=>{const g=new File([V],o.DocumentName,{type:"image/*",lastModified:1695716506050});Xt([..._e,g])}).catch(V=>{console.error("Error fetching image:",V)})}Je(n),Zt(m.VisitorDocumentUrl),It(m.DocumentUrl).then(i=>{const a=new File([i],m.DocumentName,{type:"image/*",lastModified:1695716506050});Z(a),he(m.DocumentUrl)}).catch(i=>{console.error("Error fetching image:",i)})}else{const n={VisitorId:0,CompanyId:+localStorage.CompanyId};var e=P(Fs(n));e.then(i=>{var a;i.payload.tranStatus.result?i.payload.CountryList&&i.payload.CountryList.length&&i.payload.CountryList.length>0&&Xi("CountryId",{},i.payload.CountryList[0].CountryId):(a=p.current)==null||a.show({severity:"error",summary:"Error",detail:i.payload.tranStatus.lstErrorItem.message})}).catch(i=>{var a;(a=p.current)==null||a.show({severity:"error",summary:"Error",detail:JSON.stringify(i)})})}},[]),s.useEffect(()=>{bt(si),ti(ai)},[si,ai]);const Zi={VisitorId:m!=null?m.VisitorId:0,VisitorCode:m!=null?m.VisitorCode:"",VisitorTypeId:m!=null?m.VisitorTypeId:35,CompanyId:m!=null?m.CompanyId:+localStorage.CompanyId,PlantId:m!=null?m.PlantId:+localStorage.PlantId,CountryId:m!=null?m.CountryId:null,StateId:m!=null?m.StateId:null,CityId:m!=null?m.CityId:null,TitleId:m!=null?m.TitleId:37,FirstName:m!=null?m.FirstName:"",LastName:m!=null?m.LastName:"",Dob:m!=null?new Date(m.Dob):new Date,VisitorCompany:m!=null?m.VisitorCompany:"",Address:m!=null?m.Address:"",MailId:m!=null?m.MailId:"",MobileNo:m!=null?m.MobileNo:"",CountryCode:m!=null?m.CountryCode:"+91",TagNo:m!=null?m.TagNo:"",IdCardType:m!=null?m.IdCardType:17,IdCardNo:m!=null?m.IdCardNo:"",DocumentName:m!=null?m.DocumentName:"",DocumentUrl:m!=null?m.DocumentUrl:"",VisitorDocumentName:m!=null?m.VisitorDocumentName:"",VisitorDocumentUrl:m!=null?m.VisitorDocumentUrl:"",Status:m!=null?m.Status:1,CreatedBy:0,CreatedOn:m!=null?new Date(m.CreatedOn):new Date,ModifiedBy:0,ModifiedOn:m!=null?new Date:null},fs={VisitorDetailId:0,VisitorId:0,TitleId:37,FirstName:"",LastName:"",DepartmentId:null,Dob:new Date,MailId:"",MobileNo:"",IdCardType:17,IdCardNo:"",DocumentName:"",DocumentUrl:"",Status:1,ExpirryDate:new Date,WorkSeverity:96},b=ri({initialValues:Zi,validationSchema:_s,onSubmit:(e,{resetForm:n})=>{var c,V;if(console.log(L[0]),w){U(!0);const g=new FormData;let q=[];if(e.CreatedOn=ee(new Date(e.CreatedOn)),q=L,L.forEach(C=>{delete C.VisitorName,delete C.DepartMentName,delete C.IdCardTypeName,delete C.StatusName,delete C.ShowExpirryDate,delete C.WorkSeverityName,C.Dob=ee(new Date(C.Dob)),C.ExpirryDate=ee(new Date(C.ExpirryDate))}),q=L,L.length==0){U(!1),(c=p.current)==null||c.show({severity:"warn",summary:"Warning Message",detail:`${y?"Please Add Atleast One Worker Detail":"Please Add Atleast One Visitor Detail"}`});return}g.append("webfile",Re),g.append("webfile1",ds);for(var i in _e){var a=q.findIndex(C=>C.DocumentName==_e[i].name);a!=-1&&g.append("webfiles",_e[i])}for(var o in ei){var a=q.findIndex(v=>v.DocumentName==ei[i].name);a!=-1&&g.append("webfile1",ei[i])}e.MobileNo=L[0].MobileNo,e.FirstName=L[0].FirstName,e.MailId=L[0].MailId,e.VisitorCompany=L[0].VisitorCompany,e.TagNo=L[0].TagNo,e.CompanyId=+localStorage.CompanyId,e.PlantId=d.values.PlantId;let de=JSON.stringify({Visitor:e,VisitorDetail:L});if(g.append("input",de),R==!1){if(!m.VisitorDocumentUrl){(V=p.current)==null||V.show({severity:"warn",summary:"Warning Message",detail:"Please Add Document."});return}var r=P(la(g));r.then(C=>{var v,S;C.payload.tranStatus.result==!0?(v=p.current)==null||v.show({severity:"success",summary:"Success Message",detail:C.payload.tranStatus.lstErrorItem[0].Message}):(U(!1),(S=p.current)==null||S.show({severity:"error",summary:"Error Message",detail:C.payload.tranStatus.lstErrorItem[0].Message}))}).catch(C=>{var v;U(!1),(v=p.current)==null||v.show({severity:"error",summary:"Error",detail:JSON.stringify(C)})})}else{var r=P(Gs(g));r.then(v=>{var S,D,h,aa;v.payload.tranStatus.result==!0?(u(!1),zt((D=(S=v.payload)==null?void 0:S.VisitorHeader)==null?void 0:D.VisitorId,(h=v.payload)==null?void 0:h.VisitorList)):(U(!1),(aa=p.current)==null||aa.show({severity:"error",summary:"Error",detail:v.payload.tranStatus.lstErrorItem[0].Message}))}).catch(v=>{var S;U(!1),(S=p.current)==null||S.show({severity:"error",summary:"Error",detail:v})})}}}}),Ds=ri({initialValues:fs,validationSchema:Ks,onSubmit:(e,{resetForm:n})=>{var r,c,V;let i={};i.VisitorDetailId=e.VisitorDetailId,i.VisitorId=e.VisitorId,i.TitleId=e.TitleId,i.FirstName=e.FirstName.trim(),i.LastName=e.LastName.trim(),i.DepartmentId=e.DepartmentId,i.Dob=e.Dob,i.MailId=e.MailId,i.MobileNo=e.MobileNo,i.IdCardType=e.IdCardType,i.IdCardNo=e.IdCardNo,i.DocumentName=e.DocumentName||"",i.DocumentUrl=e.DocumentUrl||"",i.Status=e.Status,i.ExpirryDate=e.ExpirryDate,i.WorkSeverity=e.WorkSeverity,i.VisitorName=xt.find(g=>g.MetaSubId==e.TitleId).MetaSubDescription+". "+i.FirstName+" "+i.LastName,i.DepartMentName=xe.find(g=>g.DepartmentId==e.DepartmentId).DepartmentName,i.IdCardTypeName=ii.find(g=>g.MetaSubId==e.IdCardType).MetaSubDescription,i.StatusName=Y.find(g=>g.MetaSubId==e.Status).MetaSubDescription,i.WorkSeverityName=Yi.find(g=>g.MetaSubId==e.WorkSeverity).MetaSubDescription;const a=e.Dob.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});i.ShowDate=a;const o=e.ExpirryDate.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});if(i.ShowExpirryDate=o,Nt==-1){if((L.filter(W=>W.VisitorName==i.VisitorName)||[]).length>0&&i.VisitorDetailId==0){(r=p.current)==null||r.show({severity:"warn",summary:"Warning Message",detail:"Worker Already Exists"});return}if((L.filter(W=>W.MobileNo==i.MobileNo)||[]).length>0&&i.VisitorDetailId==0){(c=p.current)==null||c.show({severity:"warn",summary:"Warning Message",detail:"Mobile No Already Exists"});return}if(i.MailId!=""&&(L.filter(de=>de.MailId==i.MailId)||[]).length>0&&i.VisitorDetailId==0){(V=p.current)==null||V.show({severity:"warn",summary:"Warning Message",detail:"Mail ID Already Exists"});return}Je([...L,i])}else{let g=L;g[Nt]=i,Je(g),$i(-1)}fe&&(_e.length>0?Xt([..._e,fe]):Xt([fe])),oi()}}),Is=(e,n,i)=>{b.setFieldValue(e,i)},gs=e=>{b.setFieldValue(e.target.name,e.value)},bs=(e,n,i)=>{b.setFieldValue(e??b[n][e],b,i)},li=(e,n,i)=>{b.setFieldValue(e,i)},Ss=()=>{var e;Gi(Lt.NO_IMG),ns(null),b.setFieldValue("DocumentName",""),b.setFieldValue("DocumentUrl",""),d.setFieldValue("VisitorImageName",""),d.setFieldValue("VisitorImageUrl",""),(e=zi.current)==null||e.clear()},Xi=(e,n,i)=>{ti([]),bt([]),b.setFieldValue(e,i),b.setFieldValue("StateId",null);var o=P(js({CountryId:i}));o.then(r=>{var c;r.payload.tranStatus.result?(ti(r.payload.StateList),r.payload.StateList&&r.payload.StateList.length&&r.payload.StateList.length>0&&ea("StateId",{},r.payload.StateList[0].StateId)):(c=p.current)==null||c.show({severity:"error",summary:"Error",detail:r.payload.tranStatus.lstErrorItem.message})}).catch(r=>{var c;(c=p.current)==null||c.show({severity:"error",summary:"Error",detail:JSON.stringify(r)})})},ea=(e,n,i)=>{bt([]),b.setFieldValue(e,i),b.setFieldValue("CityId",null);var o=P(Ps({StateId:i}));o.then(r=>{var c;r.payload.tranStatus.result?(bt(r.payload.CityList),r.payload.CityList&&r.payload.CityList.length&&r.payload.CityList.length>0&&Pi("CityId",{},r.payload.CityList[0].CityId)):(c=p.current)==null||c.show({severity:"error",summary:"Error",detail:r.payload.tranStatus.lstErrorItem.message})}).catch(r=>{var c;(c=p.current)==null||c.show({severity:"error",summary:"Error",detail:JSON.stringify(r)})})},Ns=e=>{var i;if(e.type!="image/jpeg"&&e.type!="image/png"&&e.type!="image/jpg"){(i=p.current)==null||i.show({severity:"warn",summary:"Error Message",detail:"Please Upload only Files with Format (Image/ JPEG, JPG, PNG)"});return}Z(e),b.setFieldValue("DocumentName",e.name),b.setFieldValue("DocumentUrl",e.name),d.setFieldValue("VisitorImageName",e.name),d.setFieldValue("VisitorImageUrl",e.name);const n=URL.createObjectURL(e);Gi(n)},xs=(e,n)=>{const i=e.name.slice((e.name.lastIndexOf(".")-1>>>0)+2).toLowerCase(),a=e.type.toLowerCase();return n.includes(i)||n.includes(a)},Ls=e=>{var i,a,o;St.current&&ta();const n=["jpeg","jpg","png","pdf","doc","docx","xls","xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"];if(e.files&&!xs(e.files[0],n)){(i=p.current)==null||i.show({severity:"warn",summary:"Error Message",detail:"Please Upload only Files with Format (Image/ JPEG, JPG, PNG & DOC/ WORD, EXCEL, PDF)"}),(a=St.current)==null||a.clear();return}if(e.files.length>0){_i(e.files[0]),b.setFieldValue("VisitorDocumentName",e.files[0].name);const r=URL.createObjectURL(e.files[0]);b.setFieldValue("VisitorDocumentUrl",e.files[0].name),Zt(r)}else{(o=p.current)==null||o.show({severity:"warn",summary:"Error Message",detail:"Please Upload only Files with Format (Image/ JPEG, JPG, PNG & DOC/ WORD, EXCEL, PDF)"});return}},ta=()=>{var e;(e=St.current)==null||e.clear(),Zt(""),_i(null),b.setFieldValue("VisitorDocumentName",""),b.setFieldValue("VisitorDocumentUrl","")},Cs=()=>{Yt!=""&&window.open(Yt,"_blank")},Ms=()=>t.jsxs("div",{className:"flex align-items-center flex-column",children:[t.jsx("i",{className:"pi pi-image mt-3 p-5",style:{fontSize:"5em",borderRadius:"50%",backgroundColor:"var(--surface-b)",color:"var(--surface-d)"}}),t.jsx("span",{style:{fontSize:"1.2em",color:"var(--text-color-secondary)"},className:"my-5",children:"Drag and Drop Image Here"})]}),ia=e=>{console.log(e),le({...E,selectedType:e.value?36:35}),gt("VisitorTypeId",{},e.value?36:35),li("VisitorTypeId",{},e.value?36:35),T(e.value)},Es=()=>{var i,a,o;let e={};if(console.log(b.values.TagNo),is(b.values)==!0){if(e.VisitorDetailId=b.values.VisitorDetailId,e.VisitorId=b.values.VisitorId,e.TitleId=b.values.TitleId,e.FirstName=b.values.FirstName,e.MailId=b.values.MailId,e.MobileNo=b.values.MobileNo,e.TagNo=b.values.TagNo,e.VisitorCompany=b.values.VisitorCompany,e.DocumentName="",e.DocumentUrl="",e.IdCardNo="",e.LastName="",e.Dob=Ct(new Date),e.ExpirryDate=Ct(new Date),e.Status=1,e.VisitorName=xt.find(r=>r.MetaSubId==b.values.TitleId).MetaSubDescription+". "+e.FirstName+" ",Nt==-1){if((L.filter(V=>V.FirstName==e.FirstName)||[]).length>0||e.VisitorDetailId==0){(i=p.current)==null||i.show({severity:"warn",summary:"Warning Message",detail:"Worker Already Exists"});return}if((L.filter(V=>V.MobileNo==e.MobileNo)||[]).length>0||e.VisitorDetailId==0){(a=p.current)==null||a.show({severity:"warn",summary:"Warning Message",detail:"Mobile No Already Exists"});return}if(e.MailId!=""&&((L.filter(g=>g.MailId==e.MailId)||[]).length>0||e.VisitorDetailId==0)){(o=p.current)==null||o.show({severity:"warn",summary:"Warning Message",detail:"Mail ID Already Exists"});return}Je([...L,e])}else{let r=L;r[Nt]=e,Je(r),$i(-1)}oi()}},oi=()=>{Ds.resetForm(),b.resetForm()};return t.jsxs("div",{style:{overflow:"auto",height:"100vh"},children:[t.jsx("div",{className:"appointment-page",style:{backgroundImage:"url("+Zs+")"},children:t.jsxs("div",{className:"center-container",children:[M?null:t.jsx("div",{className:"white mb20 appointment-hdr",children:t.jsx("div",{className:"widget-body",children:t.jsx("div",{className:"flex gap-3 justify-content-center",children:t.jsxs("div",{className:"flex align-items-center",children:[t.jsx("h2",{className:"ml-2 mr-2",children:"Visitor"}),t.jsx(Ys,{checked:y,onChange:e=>ia(e)}),t.jsx("h2",{className:"ml-2",children:"Contractor"})]})})})}),t.jsx("div",{className:`${Li?"white":""} appointment-container scroll-y`,children:t.jsxs("div",{className:`${Li?"h-full":"white"}`,children:[M?null:t.jsx("div",{className:"progress-bar",children:t.jsxs("ul",{children:[t.jsx("li",{className:"host-info completed",children:"Host Information"}),t.jsx("li",{className:`visitor-info ${w?"completed":""}`,children:`${y?"Contractor":"Visitor"} Information`})]})}),M?t.jsx(ol,{successData:ie}):w?t.jsx(il,{isVisMaster:w,setIsVisMaster:u,visitorEntryFormik:d,VisitorNameList:ce,handleVisitorSelected:zt,isViewVM:ps,isCreateVM:us,VisitorTypeListVM:ys,handleSelectVM:Is,TitleListVM:xt,CountryListVM:hs,OnchangecountryVM:Xi,StateListVM:ai,OnchangestateVM:ea,CityListVM:si,IdCardListVM:ii,StatusListVM:Vs,onUploadVM:Ns,itemTemplateVM:Ms,imageUrlVM:os,handleOnChangeVM:bs,visitorFormVM:Zi,visitorRefVM:ls,formikVM:b,onChangeVisitorTypeVM:li,tempStateListVM:cs,tempCityListVM:ms,handleCloseImageVM:Ss,handleChangeVM:gs,profUploadRef:zi,VisitorhandleHyperlinkVM:Cs,onUploadDocumentVisitorVM:Ls,deleteDocumentsVisitorVM:ta,documentUrlVisitorVM:Yt,documentVisitorUploadRefVM:St,toast:p,setVisitorEntryBelongingDetailList:Ge,VisitorEntryBelongingDetailList:Ht,pageType:y,cameraOff:je,setCameraOff:ye,phonenumber:La,addVisitorDetail:Es,visitorDetailList:L,setVisitorDetailList:Je,OnClear:oi}):t.jsx(sl,{isCreate:R,PlantList:Ba,isView:Mi,loading:Ca,visitorEntryFormik:d,selectedData:E,setShowEntryDetail:be,setVisible:j,setVisitorNameList:O,VisitorNameList:ce,visitorEntryDetailList:$,setvisitorEntryDetailList:G,setVisitorEntryBelongingDetailList:Ge,setList:qa,visitorEntryForm:!0,VisitorEntryValidationSchema:!0,onUpload:Qa,itemTemplate:es,imageUrl:ot,IsPreBookingList:ke,VisitorTypeList:Oe,onChangeVisitorType:gt,handleSelect:Pi,autoCompleteRef:rt,OnSelectVisitorCode:Ja,onChangeMatType:$a,filteritemType:Ze,handleIsPreBook:_a,VECodeDisable:Tt,EmployeeList:Pe,onChangeVisitor:Oi,ProofList:Ye,ValidFromDisable:vt,ValidToDisable:Ft,onChageFromDate:Qt,TominDate:jt,CheckboxDisable:ui,onClickIsExistingVehicle:Ai,HideVehicleDD:pi,HideDriverDD:Vi,onUploadDocument:Ya,documentUrl:Gt,onClickIsExistingDriver:Ri,OnChangePartyTypes:Ui,PartyTypeList:Xe,PartyNameList:Et,AreaList:et,RouteList:He,onClickIsAppointmentBooking:Bi,DriverList:wt,VehicleList:mt,IsDeliveryChallan:kt,IsInvoiceBased:Ot,IsVehicleTripBased:Ut,IsPartyDisable:At,IsVehicleDetailsDisable:Rt,ShowVisitorContranctor:pa,IsMaterialDetailsShow:qt,InvoiceNumberDisable:Va,DcNumberDisable:ha,PoNumberDisable:fa,ContainerNumberDisable:Da,StatusList:Y,OnChangeVehicle:za,onChageToDate:Ka,deleteDocuments:Za,handleHyperlink:Xa,cameraOff:je,setCameraOff:ye,handleChange:Ga,handleRouteSelect:Ha,initFldDisable:Ia,CreatePageOnLoadCVisitorEntry:Wa,resetAllForm:$t,IsWorkerDetailsShow:ua,IsBelongingDetailsShow:ma,VisitorEntryBelongingDetailList:Ht,VisitorEntryMaterialDetailList:gi,setVisitorEntryMaterialDetailList:we,MaterialList:ya,PurposeList:ga,IsdisableSave:Ii,toast:p,handlePoVSelect:ki,selectedPlant:Na,handleVisitorSelected:zt,pageType:y,handlePlantSelect:qi,handleDepartmentSelect:ts,PlantWiseDepartmentList:rs,plantDisable:Sa}),M?null:t.jsx("div",{className:"widget-ftr text-center",children:t.jsx("div",{className:"text-center",children:t.jsxs("div",{className:"action-btn",children:[t.jsx(te,{label:"",title:"Prev",icon:"las la-arrow-left",className:"text-center",onClick:Hi,disabled:!w}),t.jsx(te,{label:"",title:"Next",icon:"las la-arrow-right",className:"text-center",onClick:Hi,disabled:w})]})})}),w&&!M?t.jsx("div",{className:"widget-ftr text-center",children:t.jsx("div",{className:"flex flex-row justify-content-center widget-ftr text-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(te,{label:"Save",title:"Save",icon:"pi pi-save",type:"submit",disabled:Ii,onClick:ss}),t.jsx(te,{label:"Cancel",severity:"danger",className:"preview-close",title:"Cancel",icon:"pi pi-times-circle",onClick:()=>$t()})]})})}):null]})})]})}),t.jsx(ks,{toast:p})]})};export{ol as MessageAlert,Al as default};
