import{a as q,u as D,r as S,p as R,aC as G,b as H,c as B,t as I,aD as P,aF as z,j as t,F as J,B as g,n as d,A as Q,d as Y,aG as $,aH as K,aI as W}from"./index-25a41ef1.js";import{P as X}from"./Master-b11b8a2f.js";import"./index.esm-21a4a4d3.js";const se=()=>{const j=q(),m=D(),i=S.useRef(null);S.useState([]);const[w,b]=S.useState([]),[N,C]=S.useState([]);S.useEffect(()=>{R()}),S.useEffect(()=>{c==!0&&m(G({Type:"CreateInitialize",PlantId:0})),b(E),C(v)},[]);const L=l=>{m($(l.PlantId)).then(r=>{if(console.log(r),r.payload.hasOwnProperty("tranStatus")&&r.payload.tranStatus.result){let n=`?PlantId=${l.PlantId}`;s.setFieldValue("CheckToken",r.payload.VisitorEntryHeader),s.setFieldValue("UrlToken",n),l.CheckToken=r.payload.VisitorEntryHeader,l.UrlToken=n,m(P({Plant:l})).then(a=>{(a.payload!=null||!a.payload)&&(a.payload.transtatus.result==!0||a.payload.transtatus.result==!1&&console.log(a.payload.transtatus.lstErrorItem[0].Message))})}}).catch(r=>{console.log(r)})},{isCreate:c,isView:o,createOrEdit:Z,CompanyList:V,PlantList:_,PlantTypeList:k,loading:F,CountryList:T,CityList:v,StateList:E,error:ee,StatusList:M,HdrTable:e}=H(l=>l.plant),s=B({initialValues:{CompanyId:e!=null?e.CompanyId:"",PlantCode:e!=null?e.PlantCode:"",PlantType:e!=null?e.PlantType:"",PlantName:e!=null?e.PlantName:"",CountryId:e!=null?e.CountryId:"",StateId:e!=null?e.StateId:"",CityId:e!=null?e.CityId:"",Address:e!=null?e.Address:"",Geolocation:e!=null?e.GeoLocation:"",Status:e!=null?e.Status:1,UrlToken:e!=null?"http://127.0.0.1:5173/home/cAppointment"+e.UrlToken:"",CheckToken:e!=null?e.CheckToken:""},validationSchema:X,onSubmit:(l,{resetForm:h})=>{var n,u;let r={Plant:{PlantId:e!=null?e.PlantId:0,PlantCode:e!=null?e.PlantCode:"",PlantName:l.PlantName,PlantType:l.PlantType,Address:l.Address,Geolocation:l.Geolocation,CountryId:l.CountryId,StateId:l.StateId,CityId:l.CityId,CompanyId:l.CompanyId,Status:l.Status,CreatedBy:e!=null?e.CreatedBy:localStorage.UserId,CreatedOn:e!=null?I(e.CreatedOn):I(new Date),ModifiedBy:e!=null?localStorage.UserId:null,ModifiedOn:e!=null?I(new Date):null,UrlToken:e!=null?e.UrlToken:"",CheckToken:e!=null?e.CheckToken:""}};if(e!=null){if(e.isCreate!=!1)try{m(P(r)).then(a=>{var y,f;(a.payload!=null||!a.payload)&&(a.payload.transtatus.result==!0?((y=i.current)==null||y.show({severity:"success",summary:"Success Message",detail:a.payload.transtatus.lstErrorItem[0].Message}),h(),setTimeout(()=>{j.push("/home/vPlant")},800)):a.payload.transtatus.result==!1&&((f=i.current)==null||f.show({severity:"error",summary:"Error Message",detail:a.payload.transtatus.lstErrorItem[0].Message})))})}catch(p){(n=i.current)==null||n.show({severity:"warn",summary:"Error Message",detail:p})}}else try{m(z(r)).then(a=>{var y,f;(a.payload!=null||!a.payload)&&(a.payload.transtatus.result==!0?(L(a.payload.HdrTable),(y=i.current)==null||y.show({severity:"success",summary:"Success Message",detail:a.payload.transtatus.lstErrorItem[0].Message}),h()):a.payload.transtatus.result==!1&&((f=i.current)==null||f.show({severity:"warn",summary:"Error Message",detail:a.payload.transtatus.lstErrorItem[0].Message})))}).catch(a=>{var y;(y=i.current)==null||y.show({severity:"warn",summary:"Error Message",detail:JSON.stringify(a.payload)})})}catch(p){(u=i.current)==null||u.show({severity:"warn",summary:"Error Message",detail:JSON.stringify(p.payload)})}}}),O=()=>{s.resetForm(),b([]),C([])},A=(l,h,r)=>{var n;try{b([]),C([]),s.setFieldValue("StateId",null),s.setFieldValue("CityId",null),s.setFieldValue(l,r),m(K({CountryId:r})).then(a=>{b(a.payload.StateList)})}catch(u){(n=i.current)==null||n.show({severity:"error",detail:"Error",summary:u.message||"An error occurred"})}},U=(l,h,r)=>{var n;try{C([]),s.setFieldValue("CityId",null),s.setFieldValue(l,r),m(W({StateId:r})).then(a=>{C(a.payload.CityList)})}catch(u){(n=i.current)==null||n.show({severity:"error",detail:"Error",summary:u.message||"An error occurred"})}},x=(l,h,r)=>{s.setFieldValue(l,r)};return t.jsxs(t.Fragment,{children:[t.jsx(J,{initialValues:s.initialValues,validationSchema:s.validationSchema,onSubmit:s.handleSubmit,children:t.jsx("div",{className:"page-container",children:t.jsxs("div",{className:"inner-page-container",children:[t.jsx("div",{className:"page-title",children:t.jsxs("div",{className:"grid grid-nogutter",children:[t.jsx("div",{className:"md:col-6",children:t.jsx("h1",{children:"Plant"})}),t.jsx("div",{className:"md:col-6 text-right",children:t.jsxs("div",{className:"action-btn",children:[t.jsxs(t.Fragment,{children:[t.jsx(g,{label:"",title:"Save",icon:"pi pi-save",className:"text-center",disabled:!!o,type:"submit",onClick:()=>s.handleSubmit()}),t.jsx(g,{label:"",severity:"danger",icon:"pi pi-trash",title:"Clear",disabled:!!(o||c==!1),className:"text-center",onClick:()=>O()})]}),t.jsx(g,{label:"",icon:"pi pi-search",title:"Back to Search",className:"p-button p-button-success text-center",onClick:()=>{j.push("/home/vPlant")}})]})})]})}),t.jsx("div",{className:"form-container scroll-y",children:t.jsx("form",{children:t.jsx("div",{className:"white",children:t.jsx("div",{className:"widget-body",children:t.jsx("div",{className:"normal-table",children:t.jsx("div",{className:"grid",children:F?t.jsx(Q,{}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"col-12 md:col-9",children:t.jsxs("div",{className:"grid",children:[t.jsx(d,{type:"select",name:"CompanyId",label:"Company",options:V,show:!0,required:!0,disable:o||!c,optionLabel:"CompanyName",optionValue:"CompanyId",handleSelect:x,formik:s,fldStyle:"col-12 md:col-4",showFilter:!0}),t.jsx(d,{type:"text",name:"PlantCode",label:"Plant Code",options:"",show:(c==null||c==!1,!1),required:!0,disable:!!(o||c==!1),optionLabel:"",optionValue:"",handleSelect:"",formik:s,fldStyle:"col-12 md:col-4"}),t.jsx(d,{type:"select",name:"PlantType",label:"Plant Type",options:k,show:!0,required:!0,disable:!!o,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:x,formik:s,fldStyle:"col-12 md:col-4"}),t.jsx(d,{type:"text",name:"PlantName",label:"Plant Name",options:"",show:!0,required:!0,disable:!!o,optionLabel:"PlantName",optionValue:"PlantId",handleSelect:"",formik:s,fldStyle:"col-12 md:col-4",maxlength:90}),t.jsx(d,{type:"select",name:"CountryId",label:"Country",options:T,show:!0,required:!0,disable:!!o,optionLabel:"CountryName",optionValue:"CountryId",handleSelect:A,formik:s,fldStyle:"col-12 md:col-4",showFilter:!0}),t.jsx(d,{type:"select",name:"StateId",label:"State",options:w,show:!0,required:!0,disable:!!o,optionLabel:"StateName",optionValue:"StateId",handleSelect:U,formik:s,fldStyle:"col-12 md:col-4",showFilter:!0}),t.jsx(d,{type:"select",name:"CityId",label:"City",options:N,show:!0,required:!0,disable:!!o,optionLabel:"CityName",optionValue:"CityId",handleSelect:x,formik:s,fldStyle:"col-12 md:col-4",showFilter:!0})]})}),t.jsx(d,{type:"textarea",name:"Address",label:"Address",options:"",show:!0,required:!0,disable:!!o,optionLabel:"Address",optionValue:"",handleSelect:"",formik:s,fldStyle:"col-12 md:col-3",maxlength:500,style:{maxHeight:"100px",overflowY:"auto"}}),t.jsx(d,{type:"text",name:"Geolocation",label:"Geolocation",options:"",show:!0,required:!1,disable:!!o,optionLabel:"",optionValue:"",handleSelect:"",formik:s,fldStyle:"col-12 md:col-3",maxlength:50}),t.jsx(d,{type:"select",name:"Status",label:"Status",options:M,show:!0,required:!0,disable:!!o||c==null||c==!0,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:x,formik:s,fldStyle:"col-12 md:col-3"})]})})})})})})})]})})}),t.jsx(Y,{toast:i})]})};export{se as default};
