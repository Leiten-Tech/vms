import{r,a as B,u as _,b as f,p as R,b3 as x,b4 as M,j as i,C as V,d as D,b5 as C,g as F,b6 as U}from"./index-25a41ef1.js";import{P as W,A as k}from"./PageHeader-b76b68bd.js";import{e as N}from"./ExportService-4b3a6c99.js";import{p as L}from"./PermissionService-9ad252b6.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const Y=()=>{const[v,A]=r.useState(null),h=B(),u=r.useRef(null),[a,E]=r.useState(),[s,p]=r.useState([]),o=_(),y=f(e=>e.material.MaterialList),j=f(e=>e.numberingSchema.loading),b=f(e=>e.numberingSchema.reload),[w,I]=r.useState(!1),S=f(e=>e.material.HdrTable);r.useEffect(()=>{R()}),r.useEffect(()=>{E(L({screenId:6}))},[]),r.useEffect(()=>{b&&o(x({MaterialId:0}))},[b]),r.useEffect(()=>{m()},[]);const m=()=>o(x({MaterialId:0}));r.useEffect(()=>{A(y)},[y]),r.useEffect(()=>{S!=null&&w&&h.push("/home/cMaterial")},[S]),r.useEffect(()=>{a!=null&&a._View&&s.filter(e=>e.name=="view").length==0&&p([...s,{title:"View",name:"view",disabled:!1}]),a!=null&&a._Update&&s.filter(e=>e.name=="edit").length==0&&p([...s,{title:"Edit",name:"edit",disabled:!1}]),a!=null&&a._Delete&&s.filter(e=>e.name=="delete").length==0&&p([...s,{title:"Delete",name:"delete",disabled:!1}]),a!=null&&a._View&&(a!=null&&a._Update)&&(a!=null&&a._Delete)&&g({...n,tableAction:!0})},[a,s]),r.useEffect(()=>{a!=null&&a._Add&&!n.pageHeader.pageActions[0].create&&g(e=>{const d={...e.pageHeader,pageActions:e.pageHeader.pageActions.map(c=>({...c,create:!!(a!=null&&a._Add)}))};return{...e,pageHeader:d}})},[a]),r.useEffect(()=>{g({...n,tableActions:s})},[s]);const[n,g]=r.useState({pageTitle:"Material",pageHeader:{pageActions:[{create:!1,clear:!1,save:!1,createQuery:"/home/cMaterial",createDispatch:()=>o(M({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{textAlign:"center"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:s,tableColumns:[{title:"Material Category",name:"MaterialCategoryName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"16rem"}},{title:"Material Type",name:"MaterialTypeName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Material Code",name:"MaterialCode",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Material Name",name:"MaterialName",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Created By",name:"CreatedByName",sort:!0,avatar:!1,badge:!1,colStyle:{textAlign:"center"}},{title:"Created On",name:"CreatedOn",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Modified By",name:"ModifiedByName",sort:!0,avatar:!1,badge:!1,colStyle:{textAlign:"center"}},{title:"Modified On",name:"ModifiedOn",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Status",name:"StatusName",sort:!0,avatar:!1,badge:!0,colStyle:{minWidth:"2rem",textAlign:"center"}}],tableExport:e=>{m().then(c=>{O(c.payload.MaterialList).then(t=>{e==="pdf"?N.Export("Material",t,"pdf"):e==="excel"&&N.Export("Material",t,"excel")}).catch(t=>{console.error(t.message)})})}}),O=e=>new Promise((d,c)=>{let t=[];e.length>0?(e.forEach(l=>{let H={"Material Category":l.MaterialCategoryName,"Material Type":l.MaterialTypeName,"Material Code":l.MaterialCode,"Material Name":l.MaterialName,"Created By":l.CreatedByName,"Created On":l.CreatedOn,"Modified By":l.ModifiedByName,"Modified On":l.ModifiedOn,Status:l.StatusName};t.push(H)}),d(t)):c(new Error("No data available for export."))}),T={view:e=>{const d={MaterialId:e.data.MaterialId};o(C(d)),o(M(e)),I(!0)},edit:e=>{const d={MaterialId:e.data.MaterialId,Taskname:"CreateInitialize"};o(C(d)).then(t=>{t.payload.transtatus.result==!0&&h.push("/home/cMaterial")}).catch(t=>{}),o(M(e))},delete:e=>{F(`Are you sure you want to inactive this ${e.data.MaterialName}?`,"Confirmation",()=>{let d={MaterialId:e.data.MaterialId};o(U(d)).then(t=>{var l;t.payload.transtatus.result==!0&&((l=u.current)==null||l.show({severity:"success",summary:"Success Message",detail:t.payload.transtatus.lstErrorItem[0].Message}),m())}).catch(t=>{var l;(l=u.current)==null||l.show({severity:"error",summary:"Error Message",detail:JSON.stringify(t)})})},()=>{})}};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"page-container",children:i.jsxs("div",{className:"inner-page-container",children:[i.jsx(W,{pageTitle:n.pageTitle,pageConfig:n}),i.jsx("div",{className:"form-container scroll-y",children:i.jsx("div",{className:"white",children:i.jsx("div",{className:"widget-body",children:i.jsx("div",{className:"card",children:i.jsx(k,{handleActions:T,data:v,loading:j,pageConfig:n,screenPermissions:a})})})})})]})}),i.jsx(V,{}),i.jsx(D,{toast:u})]})};export{Y as default};
