import{r as s,a as v,u as w,b as C,p as j,dw as T,dx as g,j as r,C as V,d as H,dy as y,g as _,dz as F}from"./index-25a41ef1.js";import{P as z,A as R}from"./PageHeader-b76b68bd.js";import{p as D}from"./PermissionService-9ad252b6.js";import{e as x}from"./ExportService-4b3a6c99.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const $=()=>{s.useState(null);const I=v(),[t,b]=s.useState(),u=s.useRef(null),c=w(),[i,f]=s.useState([]),{InstructionsList:E,loading:S}=C(e=>e.instructions);s.useEffect(()=>{j()}),s.useEffect(()=>{b(D({screenId:39}))},[]),s.useEffect(()=>{m()},[]);const m=()=>c(T({InstructionsId:0,Taskname:"SearchInitialize"}));s.useEffect(()=>{t!=null&&t._View&&i.filter(e=>e.name=="view").length==0&&f([...i,{title:"View",name:"view",disabled:!1}]),t!=null&&t._Update&&i.filter(e=>e.name=="edit").length==0&&f([...i,{title:"Edit",name:"edit",disabled:!1}]),t!=null&&t._Delete&&i.filter(e=>e.name=="delete").length==0&&f([...i,{title:"Delete",name:"delete",disabled:!1}]),t!=null&&t._View&&(t!=null&&t._Update)&&(t!=null&&t._Delete)&&h({...d,tableAction:!0})},[t,i]),s.useEffect(()=>{t!=null&&t._Add&&!d.pageHeader.pageActions[0].create&&h(e=>{const n={...e.pageHeader,pageActions:e.pageHeader.pageActions.map(o=>({...o,create:!!(t!=null&&t._Add)}))};return{...e,pageHeader:n}})},[t]),s.useEffect(()=>{}),s.useEffect(()=>{h({...d,tableActions:i})},[i]);const[d,h]=s.useState({pageTitle:"Instructions",pageHeader:{pageActions:[{create:!1,clear:!1,save:!1,createQuery:"/home/cInstructions",createDispatch:()=>c(g({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{width:"120px",textAlign:"center"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:i,tableColumns:[{title:"Company Name",name:"CompanyName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"16rem"}},{title:"Plant Name",name:"PlantName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Visitor Type",name:"VisitorTypeName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}}],tableExport:e=>{m().then(o=>{A(o.payload.InstructionsList).then(a=>{e==="pdf"?x.Export("Instructions",a,"pdf"):e==="excel"&&x.Export("Instructions",a,"excel")}).catch(a=>{console.error(a.message)})})}}),A=e=>new Promise((n,o)=>{let a=[];e.length>0?(e.forEach(l=>{let p={"Company Name":l.CompanyName,"Plant Name":l.PlantName,"Visitor Type":l.VisitorTypeId};a.push(p)}),n(a)):o(new Error("No data available for export."))}),N={view:e=>{const n={InstructionsId:e.data.InstructionsId,Taskname:"CreateInitialize"};c(y(n)).then(a=>{a.payload.transtatus.result==!0&&I.push("/home/cInstructions")}).catch(a=>{}),c(g(e))},edit:e=>{const n={InstructionsId:e.data.InstructionsId,Taskname:"CreateInitialize"};c(y(n)).then(a=>{a.payload.transtatus.result==!0&&I.push("/home/cInstructions")}).catch(a=>{}),c(g(e))},delete:e=>{_(`Are you sure you want to inactive this ${e.data.CompanyName}?`,"Confirmation",()=>{let n={InstructionsId:e.data.InstructionsId};c(F(n)).then(a=>{var l,p;a.payload.transtatus.result==!0?((l=u.current)==null||l.show({severity:"success",summary:"Success Message",detail:a.payload.transtatus.lstErrorItem[0].Message}),m()):a.payload.transtatus.result==!1&&((p=u.current)==null||p.show({severity:"warn",summary:"Warning Message",detail:a.payload.transtatus.lstErrorItem[0].Message}))}).catch(a=>{var l;(l=u.current)==null||l.show({severity:"error",summary:"Error Message",detail:JSON.stringify(a)})})},()=>{})}};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"page-container",children:r.jsxs("div",{className:"inner-page-container",children:[r.jsx(z,{pageTitle:d.pageTitle,pageConfig:d}),r.jsx("div",{className:"form-container scroll-y",children:r.jsx("div",{className:"white",children:r.jsx("div",{className:"widget-body",children:r.jsx("div",{className:"card",children:r.jsx(R,{handleActions:N,data:E,loading:S,pageConfig:d,screenPermissions:t})})})})})]})}),r.jsx(V,{}),r.jsx(H,{toast:u})]})};export{$ as default};
