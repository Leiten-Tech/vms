import{j as t,a as al,r as n,I as Dt,B as le,cE as Bt,A as Wa,F as sl,n as x,u as ll,p as vi,aK as jr,cF as at,cG as Pr,cH as Fr,cI as kr,cJ as Ar,cK as Or,cL as Ur,cM as Wr,cN as Rr,cO as Br,L as Rt,b as zs,c as Ta,cD as Gr,cP as Hr,cQ as Zr,cv as wa,cs as Xs,az as Ks,a9 as _s,aS as $s,d as Jr,t as it,cB as Qr,cC as el,cw as Yr,cA as qr,cz as zr,cR as Xr,cS as Kr,cT as _r,aW as $r,aX as tl,aU as eo,aV as to,cu as io}from"./index-25a41ef1.js";import{I as rl}from"./inputswitch.esm-a89edc74.js";import{S as Li}from"./sidebar.esm-f3fc22cd.js";import{D as Ra,C as Ne}from"./column.esm-11a46c7b.js";import{P as ao}from"./PhotoCapture-c5d70e6b.js";import{V as ol,g as so}from"./Master-b11b8a2f.js";import{PrintPassComponent as lo}from"./PrintPass-0577c3b9.js";import{V as ro}from"./VisitorManagement-638cb0f9.js";import"./index.esm-9a713e1a.js";import"./index.esm-21a4a4d3.js";import"./jspdf.es.min-40ee8370.js";import"./html2canvas.esm-e0a7d97b.js";const oo="/assets/ico-visitor-6f8b8fff.png",il="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpGRjhGNDU1NkUwNEVFRTExQTk2REVGOTMyRTdFMjdFNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGMUM4RDVEOTRFRjMxMUVFOUQwRkNFRjIxMkQwOEMyNSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGMUM4RDVEODRFRjMxMUVFOUQwRkNFRjIxMkQwOEMyNSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1LjEgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZGOEY0NTU2RTA0RUVFMTFBOTZERUY5MzJFN0UyN0U3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkZGOEY0NTU2RTA0RUVFMTFBOTZERUY5MzJFN0UyN0U3Ii8+IDwvcmRmOkRlc2NyaXB0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",no="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpGRjhGNDU1NkUwNEVFRTExQTk2REVGOTMyRTdFMjdFNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowNkM2NTFCQTRFRjQxMUVFOTcxNEVEOEI0ODE2RUVDNiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowNkM2NTFCOTRFRjQxMUVFOTcxNEVEOEI0ODE2RUVDNiIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1LjEgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZGOEY0NTU2RTA0RUVFMTFBOTZERUY5MzJFN0UyN0U3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkZGOEY0NTU2RTA0RUVFMTFBOTZERUY5MzJFN0UyN0U3Ii8+IDwvcmRmOkRlc2NyaXB0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",co=I=>{const{dialogVisible:o,setDialogVisible:l,setVisible:m,contWorker:S,handlePassPreview:A,passData:D,selectedHost:L,selectedVisitor:c,tabConfig:j,itemTemplate:B,toast:C,handleClosePassPrev:Q}=I;return t.jsx(Li,{visible:o,onHide:()=>Q(),className:"preview-container",fullScreen:!0,children:t.jsx("div",{className:"widget-body",children:t.jsxs("div",{className:"grid",children:[t.jsx("div",{className:"col-8",children:t.jsx("div",{className:"white",children:t.jsx(Co,{tabConfig:j,itemTemplate:B,passData:D,sHost:L,sVisit:c,toast:C})})}),t.jsx("div",{className:"col-4",children:t.jsx("div",{className:"white",children:t.jsx(Mo,{tabConfig:j,itemTemplate:B,passData:D,sHost:L,sVisit:c,toast:C})})})]})})})},uo=I=>{const{itemBook:o,handleBookedVisitor:l,editData:m}=I;return t.jsx("div",{className:"col-2 relative",onClick:S=>l(S,o,!1),children:t.jsx("div",{className:`white ${o!=null&&o.IsActive?"select":""}`,children:t.jsxs("div",{className:"widget-body",children:[t.jsx("strong",{children:o.VisitorTypeName}),t.jsx("div",{className:"visitor-name text-overflow-ellipsis white-space-nowrap overflow-hidden",children:o==null?void 0:o.PersonName}),t.jsx("div",{className:"emp-id",children:o==null?void 0:o.VisitorEntryCode}),t.jsx("div",{className:"visitor-company",children:o==null?void 0:o.VisitorCompany}),!1]})})},o==null?void 0:o.VisitorCode)},mo=I=>{const{config:o,lstItem:l}=I,m=()=>{var S,A,D,L;if(o.searchId==="visit_search")return t.jsx(t.Fragment,{children:l.search.length>0?(S=l.search)==null?void 0:S.map(c=>t.jsxs("div",{className:"col-4 relative",onClick:j=>l.searchFunc(j,c),children:[t.jsx("div",{className:`white ${c!=null&&c.IsActive?"select":""}`,children:t.jsxs("div",{className:"widget-body",children:[t.jsxs("div",{className:"visitor-name text-overflow-ellipsis white-space-nowrap overflow-hidden",children:[c==null?void 0:c.FirstName," -"," ",t.jsx("span",{className:"visitor-company text-overflow-ellipsis white-space-nowrap overflow-hidden",children:c.Status==1?"Active":"InActive"})]}),t.jsx("div",{className:"emp-id",children:t.jsx("strong",{children:c==null?void 0:c.VisitorCode})}),t.jsx("div",{className:"emp-id",children:t.jsx("strong",{children:c==null?void 0:c.MobileNo})}),t.jsxs("div",{className:"visitor-company text-overflow-ellipsis white-space-nowrap overflow-hidden",children:[" ",c!=null&&c.VisitorCompany&&(c==null?void 0:c.VisitorCompany)!=null?c==null?void 0:c.VisitorCompany:"-"]})]})}),+localStorage.DefaultRoleId==2&&t.jsx(le,{label:"",severity:"success",icon:"pi pi-pencil",title:"Edit",className:"absolute h-2rem mr-4 mt-4 p-1 p-button p-button-icon-only p-button-info p-button-success p-component right-0 top-0 w-2rem",disabled:!1,onClick:j=>{j.stopPropagation(),l.editData(j,c)}})]},c==null?void 0:c.VisitorCode)):t.jsx(Bt,{text:"No Visitors Found"})});if(o.searchId=="host_search")return t.jsx(t.Fragment,{children:l.search.length>0?(A=l.search)==null?void 0:A.map(c=>t.jsx("div",{className:"col-4",onClick:j=>l.searchFunc(j,c),children:t.jsx("div",{className:`white ${c!=null&&c.IsActive?"select":""}`,children:t.jsxs("div",{className:"widget-body",children:[t.jsx("div",{className:"visitor-name text-overflow-ellipsis white-space-nowrap overflow-hidden",children:c==null?void 0:c.UserName}),t.jsx("div",{className:"emp-id",children:t.jsx("strong",{children:c!=null&&c.UserCode?c==null?void 0:c.UserCode:"-"})}),t.jsxs("div",{className:"emp-id",children:[" ",t.jsx("strong",{children:c!=null&&c.UserTelNo?c==null?void 0:c.UserTelNo:"-"})]}),t.jsxs("div",{className:"visitor-company text-overflow-ellipsis white-space-nowrap overflow-hidden",children:[" ",c!=null&&c.CompanyName?c==null?void 0:c.CompanyName:"-"]})]})})},c==null?void 0:c.UserId)):t.jsx(Bt,{text:"No Hosts Found"})});if(o.searchId=="vehicle_search")return t.jsx(t.Fragment,{children:l.search.length>0?(D=l.search)==null?void 0:D.map((c,j)=>t.jsx("div",{className:"col-2",onClick:B=>l.searchFunc(B,c),children:t.jsx("div",{className:`white ${c!=null&&c.IsActive?"select":""}`,children:t.jsxs("div",{className:"widget-body",children:[t.jsx("div",{className:"visitor-name text-overflow-ellipsis white-space-nowrap overflow-hidden",children:c==null?void 0:c.VehicleNo}),t.jsx("div",{className:"emp-id",children:c==null?void 0:c.VehicleName}),t.jsx("div",{className:"visitor-company",children:c==null?void 0:c.VehicleNameAndNo})]})})},j)):t.jsx(Bt,{text:"No Vehicles Found"})});if(o.searchId=="work_permit_search")return t.jsx(t.Fragment,{children:l.search.length>0?(L=l.search)==null?void 0:L.map((c,j)=>t.jsx("div",{className:"col-2",onClick:B=>l.searchFunc(B,c),children:t.jsx("div",{className:`white ${c!=null&&c.IsActive?"select":""}`,children:t.jsxs("div",{className:"widget-body",children:[t.jsx("div",{className:"visitor-name text-overflow-ellipsis white-space-nowrap overflow-hidden",children:c==null?void 0:c.ContractorName}),t.jsx("div",{className:"emp-id",children:c==null?void 0:c.WorkPermitCode}),t.jsx("div",{className:"visitor-company",children:c==null?void 0:c.WorkPermitDate})]})})},j)):t.jsx(Bt,{text:"No Approved Work Permits Found"})})};return t.jsx(t.Fragment,{children:m()})},po=I=>{const{handleSearchAction:o,VisitorEntryBooked:l,handleBookedVisitor:m,editData:S}=I;return t.jsx("div",{className:"grid",children:t.jsxs("div",{className:"col-12",children:[t.jsx("div",{className:"white",children:t.jsx("div",{className:"widget-body",children:t.jsx("div",{className:"normal-table visitor-table",children:t.jsx("table",{children:t.jsx("tbody",{children:t.jsx("tr",{children:t.jsx("td",{colSpan:2,children:t.jsx(Dt,{id:"appointment_search",placeholder:"Enter Appointment Number",className:"w-full visitor-search",onChange:A=>{A.target.value=A.target.value.toUpperCase(),o(A)}})})})})})})})}),t.jsx("div",{className:"search-container",children:t.jsx("div",{className:"grid",children:l&&l.length>0?l.map((A,D)=>t.jsx(uo,{itemBook:A,handleBookedVisitor:m,editData:S},D)):t.jsx(Bt,{text:"No Appointments Found !!!"})})})]})})},Vo=I=>{const{checked:o,selectedData:l,setVisible:m,searchConfig:S,VisitorNameList:A,VisitorEmployeeList:D,VehicleList:L,handleSearchAction:c,handleVehicleSelect:j,VisitorEntryBooked:B,handleBookedVisitor:C,setSelectedVisitor:Q,setSelectedHost:P,selectedHost:F,handleEmployeeSelect:R,handleVisitorSelect:_,isIndCon:X,visitorShow:Y,setVisitorShow:U,setVehicleShow:q,setEmployeeShow:re,editData:ye,searchTerm:je,handleSelectedPop:xe,handleEditData:$,handleWorkPermitSelect:oe,WorkPermitList:Ce}=I,ne=al(),[Pe,ee]=n.useState([]);return n.useEffect(()=>{switch(l==null?void 0:l.selectedType){case 35:ee([{type:l==null?void 0:l.selectedType,changeClass:"col-6",changeVis:!1,searchId:"visit_search",changeTitle:"Visitor Name",btnTitle:"Add New Visitor",createBtn:!0,search:!0,createLnk:function(){xe()},changeList:[{search:A,searchFunc:function(Z,O){O.Status!=2&&_(O)},editData:function(Z,O){$(O)}}]},{type:l==null?void 0:l.selectedType,changeClass:"col-6",changeVis:!1,searchId:"host_search",changeTitle:"Person to Visit",btnTitle:"Add New Employee",createBtn:!1,search:!0,createLnk:function(){re(!0)},changeList:[{search:D,searchFunc:function(Z,O){R(O)}}]}]);break;case 36:ee([{type:l==null?void 0:l.selectedType,changeClass:"col-6",changeVis:!1,searchId:"visit_search",changeTitle:"Contractor Name",btnTitle:"Add New Contractor",createBtn:!0,search:!0,createLnk:function(){xe()},changeList:[{search:A,searchFunc:function(Z,O){O.Status!=2&&_(O)},editData:function(Z,O){$(O)}}]},{type:l==null?void 0:l.selectedType,changeClass:"col-6",changeVis:!1,searchId:"host_search",changeTitle:"Person to Visit",btnTitle:"Add New Employee",createBtn:!1,search:!0,createLnk:function(){re(!0)},changeList:[{search:D,searchFunc:function(Z,O){R(O)}}]}]);break;case 65:ee([{type:l==null?void 0:l.selectedType,changeClass:"col-12",changeVis:!1,searchId:"invoice_search",changeTitle:"Invoice",createBtn:!0,search:!1,createLnk:function(){},changeList:[{search:L,searchFunc:function(Z,O){j(Z,O)}}]}]);break;case 64:ee([{type:l==null?void 0:l.selectedType,changeClass:"col-12",changeVis:!1,searchId:"vehicle_search",changeTitle:"Vehicle",createBtn:!1,search:!0,createLnk:function(){ne.push("/home/cVehicle")},changeList:[{search:L,searchFunc:function(Z,O){j(Z,O)}}]}]);break;case 66:ee([{type:l==null?void 0:l.selectedType,changeClass:"col-12",changeVis:!1,searchId:"vehicle_search",changeTitle:"Vehicle",createBtn:!1,search:!0,createLnk:function(){ne.push("/home/cVehicle")},changeList:[{search:L,searchFunc:function(Z,O){j(Z,O)}}]}]);break;case 100:ee([{type:l==null?void 0:l.selectedType,changeClass:"col-12",changeVis:!1,searchId:"work_permit_search",changeTitle:"Work Permit",createBtn:!1,search:!0,createLnk:function(){ne.push("/home/cVehicle")},changeList:[{search:Ce,searchFunc:function(Z,O){oe(Z,O)}}]}]);break}},[l,A,D,L,Ce]),t.jsxs(t.Fragment,{children:[o&&t.jsx(po,{handleSearchAction:c,VisitorEntryBooked:B,handleBookedVisitor:C,editData:ye}),!o&&t.jsx("div",{className:"grid",children:Pe.map((Z,O)=>t.jsx(t.Fragment,{children:t.jsx(ho,{selectedData:l,config:Z,routePage:ne,handleSearchAction:c,VisitorNameList:A,VisitorEntryBooked:B,VisitorEmployeeList:D,handleVisitorSelect:_,handleEmployeeSelect:R,VehicleList:L,searchTerm:je,WorkPermitList:Ce},O)}))})]})},ho=I=>{const{selectedData:o,config:l,handleSearchAction:m,searchTerm:S,routePage:A,VisitorNameList:D,VisitorEmployeeList:L,handleVisitorSelect:c,handleEmployeeSelect:j,VisitorEntryBooked:B,handleBookedVisitor:C,VehicleList:Q,WorkPermitList:P}=I;return t.jsxs("div",{className:`${l==null?void 0:l.changeClass}`,hidden:l==null?void 0:l.changeVis,children:[t.jsx("div",{className:"white",children:l!=null&&l.search?t.jsx("div",{className:"widget-body",children:t.jsx("div",{className:"normal-table visitor-table",children:t.jsx("table",{children:t.jsx("tbody",{children:t.jsx("tr",{children:t.jsxs("td",{colSpan:2,children:[t.jsx(Dt,{id:l==null?void 0:l.searchId,placeholder:`Search ${l==null?void 0:l.changeTitle}`,className:`${l!=null&&l.createBtn?"":"w-full"} visitor-search`,onChange:F=>{m(F)}}),l!=null&&l.createBtn?t.jsx(le,{label:"",title:l==null?void 0:l.btnTitle,icon:"pi pi-plus-circle",onClick:()=>l==null?void 0:l.createLnk(),className:"visitor-add text-center"}):null]})})})})})}):null}),t.jsx("div",{className:"search-container",children:t.jsx("div",{className:"grid",children:l.changeList.map((F,R)=>t.jsx(mo,{lstItem:F,config:l},R))})})]})},yo=I=>{const{isView:o,isCreate:l,VisitorTypeList:m,handleSelect:S,handleOnChange:A,TitleList:D,formik:L,CountryList:c,Onchangecountry:j,StateList:B,Onchangestate:C,CityList:Q,IdCardList:P,StatusList:F,onUpload:R,itemTemplate:_,imageUrl:X,values:Y,visitorForm:U,visitorRef:q,onSubmit:re,onChangeVisitorType:ye,tempStateList:je,tempCityList:xe,handleCloseImage:$,handleChange:oe,profUploadRef:Ce,VisitorhandleHyperlink:ne,onUploadDocumentVisitor:Pe,deleteDocumentsVisitor:ee,documentVisitorUploadRef:Z,documentUrlVisitor:O,VisType:K,isCurrentCreate:fe,createVisEnt:te}=I;return t.jsx(sl,{initialValues:U,validationSchema:ol,onSubmit:re,ref:q,children:t.jsx("div",{className:"widget-body",children:t.jsx("div",{className:"normal-table",children:t.jsxs("div",{className:"grid",children:[t.jsx("div",{className:"col-12 md:col-12",children:t.jsxs("div",{className:"grid",children:[t.jsx(x,{type:"text",name:"VisitorCode",label:"Visitor Code ",options:"",show:!1,required:!0,disable:!!(o||l==!1),optionLabel:"",optionValue:"",handleSelect:"",onKeyPress:()=>{},fldStyle:"col-12 md:col-3",formik:L}),t.jsx(x,{type:"select",name:"VisitorTypeId",label:"Visitor Type ",options:m,show:!1,required:!0,disable:!0,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:ye,fldStyle:"col-12 md:col-3",formik:L}),t.jsx(x,{type:"text",name:"FirstName",label:`${K==36?"Worker":"Visitor"} Name`,options:"",show:!0,required:!0,disable:!!(o||!te&&!fe),optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:L,maxlength:50}),t.jsx(x,{type:"text",name:"LastName",label:"Last Name ",options:"",show:!1,required:!0,disable:!!o,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:L,maxlength:50}),t.jsx(x,{type:"text",name:"VisitorCompany",label:"Visitor Company ",options:"",show:!0,required:!1,disable:!!o,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:L,maxlength:100}),t.jsx(x,{type:"text",name:"MailId",label:"Mail ID ",options:"",show:!0,required:!0,disable:!!(o||!te&&!fe),optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:L}),t.jsx(x,{type:"text",name:"MobileNo",label:"Mobile No ",options:"",show:!0,required:!0,disable:!!(o||!te&&!fe),optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:L,maxlength:10,minLength:10})]})}),t.jsx("div",{className:"col-12 md:col-9",children:t.jsxs("div",{className:"grid",children:[fe?null:t.jsx(x,{type:"select",name:"Status",label:"Status ",options:F,show:!0,required:!0,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:S,fldStyle:"col-12 md:col-4",formik:L,disable:!1}),t.jsx(x,{type:"textarea",name:"Address",label:"Address",options:"",show:!1,required:!0,disable:!!o,optionLabel:"",optionValue:"",handleSelect:"",formik:L,fldStyle:"col-12 md:col-4",maxlength:"500",style:{maxHeight:"100px",overflowY:"auto"}})]})})]})})})})},nl=I=>{const{setVisitorShow:o,fetchAllData:l,visType:m,isViewVM:S,isCreateVM:A,VisitorTypeListVM:D,handleSelectVM:L,TitleListVM:c,CountryListVM:j,OnchangecountryVM:B,StateListVM:C,OnchangestateVM:Q,CityListVM:P,IdCardListVM:F,StatusListVM:R,onUploadVM:_,itemTemplateVM:X,imageUrlVM:Y,handleOnChangeVM:U,visitorFormVM:q,visitorRefVM:re,visitorFormikVM:ye,onChangeVisitorTypeVM:je,tempStateListVM:xe,tempCityListVM:$,handleCloseImageVM:oe,handleChangeVM:Ce,profUploadRefVM:ne,VisitorhandleHyperlinkVM:Pe,onUploadDocumentVisitorVM:ee,deleteDocumentsVisitorVM:Z,documentUrlVisitorVM:O,documentVisitorUploadRefVM:K,visitorDetailListVM:fe,filtersVM:te,TableHeaderVM:dt,DepartmentListVM:ge,OnClearVM:Ze,visitorDetailFormVM:ae,visitorDetailRefVM:st,setVisitorDetailListVM:Fe,documentUrlVM:It,onUploadDocumentVM:k,disableFormVM:St,onRowSelectVM:ke,toastVM:se,deleteDocumentsVM:de,handleHyperlinkVM:ie,handleDChangeVM:Ae,documentUploadRefVM:Je,WorkSeverityListVM:Qe,loadingVM:Oe,handleDSelectVM:ce,visitorDFormikVM:lt,VisType:rt,isCurrentCreate:Ye,createVisEnt:w}=I;return t.jsx(t.Fragment,{children:t.jsx("div",{children:t.jsxs("div",{className:"white",children:[t.jsxs("div",{className:"widget-hdr",children:[t.jsx("div",{className:"sub-title",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"col-12",children:t.jsx("h2",{children:`${rt==36?"Worker":"Visitor"} Information`})})})}),Oe?t.jsx(Wa,{}):t.jsx(t.Fragment,{children:t.jsx(yo,{isView:S,isCreate:A,VisitorTypeList:D,handleSelect:L,TitleList:c,CountryList:j,Onchangecountry:B,StateList:C,Onchangestate:Q,CityList:P,IdCardList:F,StatusList:R,onUpload:_,itemTemplate:X,imageUrl:Y,handleOnChange:U,visitorForm:q,visitorRef:re,formik:ye,onChangeVisitorType:je,tempStateList:xe,tempCityList:$,handleCloseImage:oe,handleChange:Ce,profUploadRef:ne,VisitorhandleHyperlink:Pe,onUploadDocumentVisitor:ee,deleteDocumentsVisitor:Z,documentUrlVisitor:O,documentVisitorUploadRef:K,VisType:rt,isCurrentCreate:Ye,createVisEnt:w})})]}),Ye?null:t.jsxs("div",{className:"widget-ftr text-center",children:[t.jsx(le,{label:"Save",title:"Save",icon:"pi pi-save",type:"submit",onClick:ye.handleSubmit}),t.jsx(le,{label:"Cancel",severity:"danger",className:"preview-close",title:"Cancel",icon:"pi pi-times-circle",onClick:()=>o(!1)})]})]})})})},fo=I=>{const{visitorEntryForm:o,VisitorEntryValidationSchema:l,formik:m,onUpload:S,itemTemplate:A,isView:D,imageUrl:L,IsPreBookingList:c,VisitorTypeList:j,onChangeVisitorType:B,isCreate:C,handleSelect:Q,autoCompleteRef:P,OnSelectVisitorCode:F,onChangeMatType:R,filteritemType:_,VisitorNameList:X,onChangeVisitor:Y,handleIsPreBook:U,VECodeDisable:q,EmployeeList:re,ProofList:ye,onClickIsAppointmentBooking:je,ValidFromDisable:xe,ValidToDisable:$,onChageFromDate:oe,onChageToDate:Ce,TominDate:ne,CheckboxDisable:Pe,onClickIsExistingVehicle:ee,HideVehicleDD:Z,HideDriverDD:O,onUploadDocument:K,documentUrl:fe,onClickIsExistingDriver:te,OnChangePartyTypes:dt,PartyTypeList:ge,PartyNameList:Ze,AreaList:ae,RouteList:st,DriverList:Fe,VehicleList:It,IsDeliveryChallan:k,IsInvoiceBased:St,IsVehicleTripBased:ke,IsPartyDisable:se,IsVehicleDetailsDisable:de,ShowVisitorContranctor:ie,IsMaterialDetailsShow:Ae,InvoiceNumberDisable:Je,DcNumberDisable:Qe,PoNumberDisable:Oe,ContainerNumberDisable:ce,StatusList:lt,OnChangeVehicle:rt,deleteDocuments:Ye,handleHyperlink:w,cameraOff:Me,setCameraOff:bt,handleChange:Gt,handleRouteSelect:Nt,initFldDisable:Ee,PurposeList:qe,ChallanTypeList:xt,handlePoVSelect:y,checkedVehicle:Ue,setCheckedVehicle:Ct,setCreateVisEnt:ve,createVisEnt:De,isCurrentCreate:Le}=I;return t.jsx(sl,{initialValues:o,validationSchema:l,onSubmit:m.handleSubmit,children:t.jsx(t.Fragment,{children:de?t.jsx("div",{className:D?"p-disabled":"",children:t.jsx("div",{className:"normal-table",children:t.jsxs("div",{className:"grid",children:[t.jsx("div",{className:"col-12 md:col-9",children:t.jsxs("div",{className:"grid",children:[t.jsx(x,{type:"radiobox",name:"IsPreBooking",label:"Is Pre Booking ?",options:c,show:!1,required:!1,disable:D||!C,optionLabel:"",optionValue:"",handleSelect:"",handleChange:U,formik:m,fldStyle:"col-12 md:col-4"}),t.jsx(x,{type:"text",name:"VisitorEntryCode",label:"Visitor Entry Code ",options:"",show:!1,required:!1,disable:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:m}),t.jsx(x,{type:"select",name:"VisitorTypeId",label:"Visitor Type ",options:j,show:!0,required:!1,disable:D||!C||Ee,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:B,fldStyle:"col-12 md:col-4",formik:m}),t.jsx(x,{type:"select",name:"ChallanType",label:"Challan Type ",options:xt,show:!se,required:!0,disable:C?se:!0,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:Q,fldStyle:"col-12 md:col-4",formik:m}),t.jsx(x,{type:"select",name:"VisitorId",label:"Visitor Name ",options:X,show:!Le,disable:!Le,required:!1,optionLabel:"FirstName",optionValue:"VisitorDetailId",handleSelect:Y,fldStyle:"col-12 md:col-4",formik:m}),t.jsx(x,{type:"text",name:"PersonName",label:"Visitor Name ",options:"",show:!ie,required:!1,disable:D||!Le,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:m,maxlength:100}),t.jsx(x,{type:"Calendar",name:"VisitorEntryDate",label:"Visitor Entry Date",options:"",show:!1,required:!1,disable:!0,optionLabel:"",optionValue:"",handleChange:Gt,fldStyle:"col-12 md:col-4",formik:m,maxDate:new Date}),t.jsx(x,{type:"select",name:"VisitedEmployeeId",label:"Person to Visit",options:re,show:!0,required:!0,disable:!Le,optionLabel:"UserName",optionValue:"UserId",handleSelect:Q,fldStyle:"col-12 md:col-4",formik:m}),t.jsx(x,{type:"text",name:"MobileNo",label:"Mobile No ",options:"",show:!ie,required:!1,disable:C?ie:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:m,keyfilter:"int",maxlength:15,minLength:9}),t.jsx(x,{type:"select",name:"IdProofType",label:"ID Proof Type ",options:ye,show:!ie,required:!1,disable:C?ie:!0,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:Q,fldStyle:"col-12 md:col-4",formik:m}),t.jsx(x,{type:"text",name:"IdProofNo",label:"ID Proof No ",options:"",show:!ie,required:!1,disable:C?ie:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:m,maxlength:"20"}),t.jsx(x,{type:"multi_select",name:"AreaToVisit",label:"Area To Visit ",options:ae.filter(ze=>ze.PlantId==+localStorage.PlantId),show:!0,required:!1,disable:D||!C,optionLabel:"AreaName",optionValue:"AreaId",handleSelect:y,fldStyle:"col-12 md:col-4",formik:m}),t.jsx(x,{type:"select",name:"PartyType",label:"Party Type ",options:ge,show:!se,required:!1,disable:C?se:!0,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:dt,fldStyle:"col-12 md:col-4",formik:m}),t.jsx(x,{type:"select",name:"PartyName",label:"Party Name ",options:Ze,show:!se,required:!1,disable:C?se:!0,optionLabel:"RefName",optionValue:"RefId",handleSelect:Q,fldStyle:"col-12 md:col-4",formik:m}),t.jsx(x,{type:"checkbox",name:"IsAppointmentBooking",label:"Is Appointment Booking ",options:"",show:!1,required:!1,disable:C?Pe:!0,optionLabel:"",optionValue:"",handleChange:je,fldStyle:"col-12 md:col-4",formik:m}),t.jsx(x,{type:"Calendar",name:"ValidFrom",label:m.values.VisitorTypeId==36?"Valid From":"Appointment Date",options:"",show:!0,required:!0,disable:C?xe:!0,optionLabel:"",optionValue:"",handleChange:oe,fldStyle:"col-12 md:col-4",formik:m,minDate:new Date,showTime:!0}),t.jsx(x,{type:"Calendar",name:"ValidTo",label:"Valid To",options:"",show:!$,required:!0,disable:$,optionLabel:"",optionValue:"",handleChange:Ce,fldStyle:"col-12 md:col-4",formik:m,minDate:ne??new Date,showTime:!0}),t.jsx(x,{type:"text",name:"DcNumber",label:"Dc Number ",options:"",show:!Qe,required:!1,disable:C?Qe:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:m,maxlength:"20"}),t.jsx(x,{type:"text",name:"InvoiceNumber",label:"Invoice Number ",options:"",show:!Je,required:!1,disable:C?Je:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:m,maxlength:"20"}),t.jsx(x,{type:"text",name:"PoNumber",label:"Po Number ",options:"",show:!Oe,required:!1,disable:C?Oe:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:m,maxlength:"20"}),t.jsx(x,{type:"text",name:"ContainerNumber",label:"Container Number ",options:"",show:!ce,required:!1,disable:C?ce:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:m,maxlength:"20"}),t.jsx(x,{type:"select",name:"Status",label:"Status ",options:lt,show:!1,required:!1,disable:!0,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:Q,fldStyle:"col-12 md:col-4",formik:m}),t.jsx(x,{type:"",name:"",label:"",options:"",show:m.values.VisitorTypeId==66,required:!1,disable:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-4",formik:m}),t.jsx(x,{type:"select",name:"PurposeOfVisit",label:"Purpose Of Visit ",options:qe,show:!0,required:!0,disable:!C,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:Q,formik:m,fldStyle:"col-12 md:col-4",filter:!0}),t.jsx(x,{type:"textarea",name:"VisitorRemarks",label:"Visitor Remarks ",options:"",show:!0,required:!1,disable:D||!C,optionLabel:"",optionValue:"",handleSelect:"",formik:m,fldStyle:"col-12 md:col-4",maxlength:"500",style:{maxHeight:"100px",overflowY:"auto"}})]})}),t.jsx(ao,{onUpload:S,ImageUrl:L,isView:D||!C,cameraOff:Me,setCameraOff:bt,fldStyle:"col-12 md:col-3 text-center"})]})})}):t.jsx("div",{hidden:de,children:t.jsx("div",{className:D?"p-disabled":"",children:t.jsx("div",{className:"normal-table",children:t.jsxs("div",{className:"grid",children:[Ee?t.jsx(x,{type:"",fldStyle:"col-12 md:col-3",show:!1}):t.jsx(x,{type:"checkbox",name:"IsExistingVehicle",label:"Is Existing Vehicle ",options:"",show:!1,required:!1,disable:D||!C,optionLabel:"",optionValue:"",handleChange:ee,fldStyle:"col-12 md:col-3",formik:m}),t.jsx("div",{className:"col-12 md:col-12",children:t.jsx("div",{className:"normal-table visitor-table",children:t.jsx("table",{children:t.jsx("tbody",{children:t.jsxs("tr",{children:[t.jsx("td",{style:{width:"50%"},className:"text-right",children:"Out"}),t.jsx("td",{children:t.jsx(rl,{checked:Ue,onChange:ze=>Ct(ze.target.value)})}),t.jsx("td",{style:{width:"50%"},children:"In"})]})})})})}),t.jsx(x,{type:"select",name:"VisitorTypeId",label:"Visitor Type ",options:j,show:!0,required:!1,disable:D||!C||Ee,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:B,fldStyle:"col-12 md:col-3",formik:m}),t.jsx(x,{type:"text",name:"VehicleName",label:"Vehicle Name ",options:"",show:!Z,required:!1,disable:D||!C,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:m,maxlength:"50"}),t.jsx(x,{type:"text",name:"VehicleNo",label:"Vehicle No ",options:"",show:!0,required:!1,disable:C?Z:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:m,maxlength:"50"}),t.jsx(x,{type:"checkbox",name:"IsExistingDriver",label:"Is Existing Driver ",options:"",show:!1,required:!1,disable:D||!C,optionLabel:"",optionValue:"",handleChange:te,fldStyle:"col-12 md:col-3",formik:m}),t.jsx(x,{type:"select",name:"DriverId",label:"Driver Name ",options:Fe,show:O,required:!1,disable:D||!C,optionLabel:"UserName",optionValue:"UserId",handleSelect:Q,fldStyle:"col-12 md:col-3",formik:m}),t.jsx(x,{type:"text",name:"DriverId",label:"Driver Name ",options:"",show:!O,required:!1,disable:D||!C,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:m,maxlength:"50"}),t.jsx(x,{type:"select",name:"RouteId",label:"Route ",options:st,show:!1,required:!1,disable:D||!C,optionLabel:"RouteName",optionValue:"RouteId",handleSelect:Nt,fldStyle:"col-12 md:col-3",formik:m}),t.jsx(x,{type:"text",name:"NumberOfPassengers",label:"No.Of Passengers ",options:"",show:!1,required:!1,disable:C?de:!0,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:m,keyfilter:"int",maxlength:"10"}),t.jsx(x,{type:"",name:"",label:"",options:"",show:!1,required:!1,disable:D||!C,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:m}),t.jsx(x,{type:"number",name:"StartingKm",label:"Starting Km",options:"",show:!0,required:!Ue,disable:Ue,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:m,maxFractionDigits:2,minFractionDigits:2,mode:"decimal",max:999999999}),t.jsx(x,{type:"number",name:"EndingKm",label:"Ending Km",options:"",show:!0,required:Ue,disable:!Ue,optionLabel:"",optionValue:"",handleSelect:"",fldStyle:"col-12 md:col-3",formik:m,maxFractionDigits:2,minFractionDigits:2,mode:"decimal",max:999999999}),t.jsx(x,{type:"select",name:"PurposeOfVisit",label:"Purpose Of Visit ",options:qe,show:!0,required:!0,disable:!C,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:Q,formik:m,fldStyle:"col-12 md:col-3",filter:!0}),t.jsx(x,{type:"textarea",name:"VisitorRemarks",label:"Visitor Remarks ",options:"",show:!1,required:!1,disable:D||!C,optionLabel:"",optionValue:"",handleSelect:"",formik:m,fldStyle:"col-12 md:col-3",maxlength:"500",style:{maxHeight:"100px",overflowY:"auto"}})]})})})})})})},go=I=>{const{visitorEntryBelongingDetailForm:o,formik:l,VisitorEntryBelongingDetailList:m,TableHeader:S,filters:A,isView:D,setVisitorEntryBelongingDetailList:L,toast:c,isCreate:j}=I,B=P=>{const F=m.indexOf(P),R=()=>{var U;if(m.filter(q=>q.DeviceName==""||q.DeviceNo=="").length>0){(U=c==null?void 0:c.current)==null||U.show({severity:"warn",detail:"Please Enter Device Name And No.",summary:"Warning Message"});return}const Y={VisitorEntryBelongingDetailId:0,VisitorEntryId:0,DeviceNo:"",DeviceName:""};L([...m,Y])},_=()=>{const X=[...m];X.splice(F,1),X.length==0?L([{VisitorEntryBelongingDetailId:0,VisitorEntryId:0,DeviceNo:"",DeviceName:""}]):L(X)};return t.jsxs(t.Fragment,{children:[t.jsx(le,{label:"",severity:"success",title:"Add",icon:"las la-plus",className:"mr-2 p-1",onClick:R,disabled:D||!j}),t.jsx(le,{label:"",severity:"danger",title:"Delete",icon:"las la-times",className:"mr-2 p-1",onClick:_,disabled:D||!j})]})},C=(P,F,R)=>{const _=[...m];_[R.rowIndex][R.field]=P.target.value,L(_)},Q=(P,F)=>t.jsx(Dt,{className:"w-full",value:P[F.field],onChange:R=>{C(R,P,F)},maxLength:50,disabled:D||!j});return t.jsxs("div",{className:"widget-body",children:[t.jsx("div",{className:"sub-title",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"col-12",children:t.jsx("h2",{children:"Belonging Details"})})})}),t.jsx("div",{className:"normal-table",children:t.jsxs(Ra,{value:m,showGridlines:!0,paginator:!0,filterDisplay:"menu",globalFilterFields:["VisitorName","DepartMentName","Dob","MobileNo","MailId","IdCardTypeName","IdCardNo","StatusName"],emptyMessage:"No Data found.",editMode:"cell",rows:5,rowsPerPageOptions:[5,10,25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Entries",paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",tableStyle:{minWidth:"50rem"},children:[t.jsx(Ne,{field:"Action",header:"Action",style:{width:"15%",textAlign:"center"},body:B}),t.jsx(Ne,{field:"DeviceName",header:"Property Name",style:{width:"25%"},body:(P,F)=>Q(P,F)}),t.jsx(Ne,{field:"DeviceNo",header:"No Of Count",style:{width:"25%"},body:(P,F)=>Q(P,F)})]})})]})},Do=I=>{const{VisitorEntryMaterialDetailList:o,setVisitorEntryMaterialDetailList:l,isView:m,toast:S,MaterialList:A,IsMaterialDetailsShow:D,isCreate:L}=I,c=P=>{const F=o.indexOf(P),R=()=>{var U;if(o.filter(q=>q.MaterialId==null||q.Qty=="").length>0){(U=S==null?void 0:S.current)==null||U.show({severity:"warn",detail:"Please Enter Device Name And No.",summary:"Warning Message"});return}const Y={VisitorEntryMaterialDetailId:0,VisitorEntryId:0,MaterialId:null,Uom:null,Qty:""};l([...o,Y])},_=()=>{const X=[...o];X.splice(F,1);let Y={};Y.VisitorEntryMaterialDetailId=0,Y.VisitorEntryId=0,Y.MaterialId=0,Y.Uom=0,Y.Qty="",l(Y),X.length==0?l([{VisitorEntryMaterialDetailId:0,VisitorEntryId:0,MaterialId:null,Uom:null,Qty:""}]):l(X)};return t.jsxs(t.Fragment,{children:[t.jsx(le,{label:"",severity:"success",title:"Add",icon:"las la-plus",className:"mr-2 p-1",onClick:R,disabled:m||!L}),t.jsx(le,{label:"",severity:"danger",title:"Delete",icon:"las la-times",className:"mr-2 p-1",onClick:_,disabled:m||!L})]})},j=(P,F,R)=>{var Y;if(o.find(U=>U.MaterialId==P.target.value)){(Y=S==null?void 0:S.current)==null||Y.show({severity:"warn",summary:"Warning Message",detail:"Material Already Exists."});return}const X=[...o];X[R.rowIndex][R.field]=P.target.value,X[R.rowIndex].Uom=A.find(U=>U.MaterialId==P.target.value).Uom,l(X)},B=(P,F,R)=>{const _=[...o];_[R.rowIndex][R.field]=P.target.value,l(_)},C=(P,F)=>t.jsx(jr,{value:P[F.field],options:A,optionLabel:"MaterialName",optionValue:"MaterialId",className:"w-full",onChange:R=>j(R,P,F),filter:!0,disabled:m||!L}),Q=(P,F)=>t.jsx(Dt,{className:"w-full",keyfilter:"int",value:P[F.field],onChange:R=>{B(R,P,F)},maxLength:10,disabled:m||!L});return t.jsx("div",{className:"widget-body",children:t.jsxs("div",{className:"normal-table",children:[t.jsx("div",{className:"page-title",children:t.jsx("div",{className:"grid grid-nogutter",children:t.jsx("div",{className:"md:col-6",children:t.jsx("h1",{children:"Material Details"})})})}),t.jsx("div",{className:"card",children:t.jsxs(Ra,{value:o,showGridlines:!0,paginator:!0,filterDisplay:"menu",globalFilterFields:[],emptyMessage:"No Data found.",editMode:"cell",rows:5,rowsPerPageOptions:[5,10,25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Entries",paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",tableStyle:{minWidth:"50rem"},children:[t.jsx(Ne,{field:"Action",header:"Action",style:{width:"15%"},body:c}),t.jsx(Ne,{field:"MaterialId",header:"Material Name",style:{width:"25%"},body:(P,F)=>C(P,F)}),t.jsx(Ne,{field:"Qty",header:"Qty",style:{width:"25%"},body:(P,F)=>Q(P,F)})]})})]})})},Io=I=>{const o=n.useRef(null),{toast:l,tabConfig:m,visitorEntryFormik:S,isCreate:A,isView:D,loading:L,selectedData:c,setShowEntryDetail:j,setVisible:B,VisitorNameList:C,visitorEntryDetailList:Q,setvisitorEntryDetailList:P,setVisitorTypeList:F,setIsPreBookingList:R,setProofList:_,setStatusList:X,setTitleList:Y,setEmployeeList:U,setDepartmentList:q,setTempVisitorNameList:re,setVisitorNameList:ye,setPartyTypeList:je,setAreaList:xe,setRouteList:$,setDriverList:oe,setVehicleList:Ce,setMaterialList:ne,setVisitorEntryBelongingDetailList:Pe,setList:ee,visitorEntryForm:Z,VisitorEntryValidationSchema:O,onUpload:K,itemTemplate:fe,imageUrl:te,IsPreBookingList:dt,VisitorTypeList:ge,onChangeVisitorType:Ze,handleSelect:ae,autoCompleteRef:st,OnSelectVisitorCode:Fe,onChangeMatType:It,filteritemType:k,handleIsPreBook:St,VECodeDisable:ke,EmployeeList:se,onChangeVisitor:de,ProofList:ie,onClickIsAppointmentBooking:Ae,ValidFromDisable:Je,ValidToDisable:Qe,onChageFromDate:Oe,TominDate:ce,CheckboxDisable:lt,onClickIsExistingVehicle:rt,HideVehicleDD:Ye,HideDriverDD:w,onUploadDocument:Me,documentUrl:bt,onClickIsExistingDriver:Gt,OnChangePartyTypes:Nt,PartyTypeList:Ee,PartyNameList:qe,AreaList:xt,RouteList:y,DriverList:Ue,VehicleList:Ct,IsDeliveryChallan:ve,IsInvoiceBased:De,IsVehicleTripBased:Le,IsPartyDisable:ze,IsVehicleDetailsDisable:Mt,ShowVisitorContranctor:Ht,IsMaterialDetailsShow:Zt,InvoiceNumberDisable:Jt,DcNumberDisable:Ti,PoNumberDisable:Qt,ContainerNumberDisable:wi,StatusList:Yt,OnChangeVehicle:ji,onChageToDate:qt,deleteDocuments:Pi,handleHyperlink:zt,cameraOff:Xt,setCameraOff:ct,handleChange:Kt,handleRouteSelect:Xe,initFldDisable:ut,CreatePageOnLoadCVisitorEntry:Ke,resetAllForm:mt,IsWorkerDetailsShow:Ie,IsBelongingDetailsShow:_t,VisitorEntryBelongingDetailList:Fi,VisitorEntryMaterialDetailList:Ba,setVisitorEntryMaterialDetailList:ki,MaterialList:$t,PurposeList:Ai,ChallanTypeList:ei,IsdisableSave:Et,handlePoVSelect:ti,setCheckedVehicle:Oi,checkedVehicle:vt,vehicleDetails:Lt,setVisitorShow:ii,fetchAllData:Ui,visType:pt,isViewVM:ai,isCreateVM:si,VisitorTypeListVM:_e,handleSelectVM:We,TitleListVM:li,CountryListVM:ri,OnchangecountryVM:Wi,StateListVM:Ga,OnchangestateVM:Ri,CityListVM:Re,IdCardListVM:Bi,StatusListVM:Be,onUploadVM:Gi,itemTemplateVM:Hi,imageUrlVM:Zi,handleOnChangeVM:oi,visitorFormVM:Ji,visitorRefVM:Qi,visitorFormikVM:Yi,onChangeVisitorTypeVM:qi,tempStateListVM:zi,tempCityListVM:ni,handleCloseImageVM:Xi,handleChangeVM:di,profUploadRefVM:Ki,VisitorhandleHyperlinkVM:ci,onUploadDocumentVisitorVM:_i,deleteDocumentsVisitorVM:Tt,documentUrlVisitorVM:$i,documentVisitorUploadRefVM:Vt,visitorDetailListVM:ea,filtersVM:wt,TableHeaderVM:ta,DepartmentListVM:jt,OnClearVM:ia,visitorDetailFormVM:ui,visitorDetailRefVM:aa,setVisitorDetailListVM:mi,documentUrlVM:pi,onUploadDocumentVM:G,disableFormVM:$e,onRowSelectVM:et,toastVM:tt,deleteDocumentsVM:Ge,handleHyperlinkVM:sa,handleDChangeVM:Vi,documentUploadRefVM:Te,WorkSeverityListVM:pe,loadingVM:la,handleDSelectVM:Pt,visitorDFormikVM:ra,saveVisitor:hi,setCreateVisEnt:oa,createVisEnt:yi,VisType:fi,isCurrentCreate:ot}=I;return ll(),n.useState([]),n.useState([]),n.useState({}),n.useState([]),n.useState([]),n.useState([]),n.useState([]),n.useState([]),n.useState([]),n.useState([]),n.useEffect(()=>{vi()}),n.useEffect(()=>{A==!1?ee():(console.log("qweqwe"),Ke(0))},[]),t.jsx("div",{ref:o,children:t.jsxs("div",{className:"white",children:[t.jsx("div",{className:"widget-hdr",children:t.jsx("div",{className:"sub-title",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"col-12 flex",children:t.jsx("h2",{children:Mt?"Visitor Entry":"Vehicle Information"})})})})}),t.jsx("div",{className:"widget-body",children:L?t.jsx(Wa,{}):t.jsxs(t.Fragment,{children:[t.jsx(fo,{visitorEntryForm:Z,VisitorEntryValidationSchema:O,formik:S,onUpload:K,itemTemplate:fe,isView:D,imageUrl:te,IsPreBookingList:dt,VisitorTypeList:ge,onChangeVisitorType:Ze,isCreate:A,handleSelect:ae,autoCompleteRef:st,OnSelectVisitorCode:Fe,onChangeMatType:It,filteritemType:k,VisitorNameList:C,handleIsPreBook:St,VECodeDisable:ke,EmployeeList:se,onChangeVisitor:de,ProofList:ie,onClickIsAppointmentBooking:Ae,ValidFromDisable:Je,ValidToDisable:Qe,onChageFromDate:Oe,TominDate:ce,CheckboxDisable:lt,onClickIsExistingVehicle:rt,HideVehicleDD:Ye,HideDriverDD:w,onUploadDocument:Me,documentUrl:bt,onClickIsExistingDriver:Gt,OnChangePartyTypes:Nt,PartyTypeList:Ee,PartyNameList:qe,AreaList:xt,RouteList:y,DriverList:Ue,VehicleList:Ct,PurposeList:Ai,IsDeliveryChallan:ve,IsInvoiceBased:De,IsVehicleTripBased:Le,IsPartyDisable:ze,IsVehicleDetailsDisable:Mt,ShowVisitorContranctor:Ht,IsMaterialDetailsShow:Zt,InvoiceNumberDisable:Jt,DcNumberDisable:Ti,PoNumberDisable:Qt,ContainerNumberDisable:wi,StatusList:Yt,ChallanTypeList:ei,OnChangeVehicle:ji,onChageToDate:qt,deleteDocuments:Pi,handleHyperlink:zt,cameraOff:Xt,setCameraOff:ct,handleChange:Kt,handleRouteSelect:Xe,initFldDisable:ut,IsdisableSave:Et,handlePoVSelect:ti,setCheckedVehicle:Oi,checkedVehicle:vt,createVisEnt:yi,setCreateVisEnt:oa,isCurrentCreate:ot}),Mt&&ot?t.jsx(nl,{setVisitorShow:ii,fetchAllData:Ui,visType:pt,isViewVM:ai,isCreateVM:si,VisitorTypeListVM:_e,handleSelectVM:We,TitleListVM:li,CountryListVM:ri,OnchangecountryVM:Wi,StateListVM:Ga,OnchangestateVM:Ri,CityListVM:Re,IdCardListVM:Bi,StatusListVM:Be,onUploadVM:Gi,itemTemplateVM:Hi,imageUrlVM:Zi,handleOnChangeVM:oi,visitorFormVM:Ji,visitorRefVM:Qi,visitorFormikVM:Yi,onChangeVisitorTypeVM:qi,tempStateListVM:zi,tempCityListVM:ni,handleCloseImageVM:Xi,handleChangeVM:di,profUploadRefVM:Ki,VisitorhandleHyperlinkVM:ci,onUploadDocumentVisitorVM:_i,deleteDocumentsVisitorVM:Tt,documentUrlVisitorVM:$i,documentVisitorUploadRefVM:Vt,visitorDetailListVM:ea,filtersVM:wt,TableHeaderVM:ta,DepartmentListVM:jt,OnClearVM:ia,visitorDetailFormVM:ui,visitorDetailRefVM:aa,setVisitorDetailListVM:mi,documentUrlVM:pi,onUploadDocumentVM:G,disableFormVM:$e,onRowSelectVM:et,toastVM:tt,deleteDocumentsVM:Ge,handleHyperlinkVM:sa,handleDChangeVM:Vi,documentUploadRefVM:Te,WorkSeverityListVM:pe,loadingVM:la,handleDSelectVM:Pt,visitorDFormikVM:ra,VisType:fi,isCurrentCreate:ot}):null,t.jsxs("div",{className:"col-12 flex flex-row gap-3 md:col-12    ",children:[t.jsx("div",{className:"white col-6 ",hidden:!_t,children:t.jsx("div",{className:D?"p-disabled":"",children:t.jsx(go,{VisitorEntryBelongingDetailList:Fi,setVisitorEntryBelongingDetailList:Pe,isView:D,isCreate:A,toast:l,IsBelongingDetailsShow:_t})})}),t.jsx("div",{className:"white col-6",hidden:!Zt,children:t.jsx("div",{className:D?"p-disabled":"",children:t.jsx(Do,{VisitorEntryMaterialDetailList:Ba,setVisitorEntryMaterialDetailList:ki,isView:D,isCreate:A,toast:l,MaterialList:$t,IsMaterialDetailsShow:Zt})})})]})]})}),t.jsxs("div",{className:"widget-ftr text-center",children:[t.jsx(le,{label:"Save",title:"Save",icon:"pi pi-save",type:"submit",disabled:D||Et,onClick:fi!=66?hi:S.handleSubmit}),t.jsx(le,{label:"Cancel",severity:"danger",className:"preview-close",title:"Cancel",icon:"pi pi-times-circle",disabled:!!(D||A==!1),onClick:()=>mt()})]})]})})},ja=at("visitorentry/fetch",async(I,o)=>{try{return(await Pr(I)).data}catch(l){return o.rejectWithValue(l.message)}}),Pa=at("visitorentry/createInit",async(I,o)=>{try{return(await Fr(I)).data}catch(l){return o.rejectWithValue(l.message)}}),Fa=at("visitorentry/OnChangeVisitorType",async(I,o)=>{try{return(await kr(I)).data}catch(l){return o.rejectWithValue(l.message)}}),ka=at("visitorentry/OnChangeVisitor",async(I,o)=>{try{return(await Ar(I)).data}catch(l){return o.rejectWithValue(l.message)}}),Aa=at("visitorentry/OnChangePartyType",async(I,o)=>{try{return(await Or(I)).data}catch(l){return o.rejectWithValue(l.message)}}),Oa=at("visitorentry/create",async(I,o)=>{try{return(await Ur(I)).data}catch(l){return o.rejectWithValue(l.message)}}),Ua=at("visitorentry/update",async(I,o)=>{try{return(await Wr(I)).data}catch(l){return o.rejectWithValue(l.message)}});at("visitorentry/changestatus",async(I,o)=>{try{return(await Rr(I)).data}catch(l){return o.rejectWithValue(l.message)}});const So={isCreate:!0,isView:!1,createEditData:null,loading:!1,error:null,tranStatus:null,DtoEmployeeList:[],DtoDepartmentList:[],DtoStatusList:[],DtoTitleList:[],DtoIsPreBookingList:[],DtoVisitorTypeList:[],DtoProofList:[],DtoVisitorEntryTypeList:[],DtoVisitorEntryHeader:null,DtoVisitorEntryDetail:[],DtoVisitorEntryBelongingDetail:[],DtoVisitorEntryMaterialDetail:[],DtoVisitorEntryList:[],DtoVisitorEntryCodeList:[],DtoVisitorEmployeeList:[],DtoVisitorNameList:[],DtoVisitorWorkerList:[],DtoPreBookingList:[],DtoPartyTypeList:[],DtoAreaList:[],DtoRouteList:[],DtoPartyNameList:[],DtoDriverList:[],DtoVehicleList:[],DtoMaterialList:[],DtoPurposeList:[],DtoVisitorEntryPovDetail:[],DtoPlantList:[]},bo=Br({name:"visitorentry",initialState:So,reducers:{createOrEdit:(I,o)=>{o.payload!=null&&(I.DtoVisitorEntryHeader=null,I.isCreate=o.payload.data==null,I.isView=o.payload.isView)}},extraReducers:I=>{I.addCase(Ua.pending,o=>{o.loading=!0,o.error=null}).addCase(Ua.fulfilled,(o,l)=>{o.loading=!1,o.tranStatus=l.payload.tranStatus}).addCase(Ua.rejected,(o,l)=>{o.loading=!1,o.error=l.payload}).addCase(Fa.pending,o=>{o.loading=!0,o.error=null}).addCase(Fa.fulfilled,(o,l)=>{o.loading=!1}).addCase(Fa.rejected,(o,l)=>{o.loading=!1,o.error=l.payload}).addCase(ka.pending,o=>{o.loading=!0,o.error=null}).addCase(ka.fulfilled,(o,l)=>{o.loading=!1}).addCase(ka.rejected,(o,l)=>{o.loading=!1,o.error=l.payload}).addCase(ja.pending,o=>{o.loading=!0,o.error=null}).addCase(ja.fulfilled,(o,l)=>{o.loading=!1}).addCase(ja.rejected,(o,l)=>{o.loading=!1,o.error=l.payload}).addCase(Oa.pending,o=>{o.loading=!0,o.error=null}).addCase(Oa.fulfilled,(o,l)=>{o.loading=!1}).addCase(Oa.rejected,(o,l)=>{o.loading=!1,o.error=l.payload}).addCase(Aa.pending,o=>{o.loading=!0,o.error=null}).addCase(Aa.fulfilled,(o,l)=>{o.loading=!1}).addCase(Aa.rejected,(o,l)=>{o.loading=!1,o.error=l.payload}).addCase(Pa.pending,o=>{o.loading=!0,o.error=null}).addCase(Pa.fulfilled,(o,l)=>{o.loading=!1,o.DtoVisitorTypeList=l.payload.VisitorTypeList,o.DtoIsPreBookingList=l.payload.IsPreBookingList,o.DtoProofList=l.payload.ProofList,o.DtoStatusList=l.payload.StatusList,o.DtoTitleList=l.payload.TitleList,o.DtoEmployeeList=l.payload.EmployeeList,o.DtoDepartmentList=l.payload.DepartmentList,o.DtoVisitorNameList=l.payload.VisitorNameList,o.DtoPartyTypeList=l.payload.PartyTypeList,o.DtoAreaList=l.payload.AreaList,o.DtoRouteList=l.payload.RouteList,o.DtoDriverList=l.payload.DriverList,o.DtoVehicleList=l.payload.VehicleList,o.DtoMaterialList=l.payload.MaterialList,o.DtoVisitorEntryHeader=l.payload.VisitorEntryHeader,o.DtoVisitorEntryDetail=l.payload.VisitorEntryDetail,o.DtoVisitorEntryBelongingDetail=l.payload.VisitorEntryBelongingDetail,o.DtoVisitorEntryMaterialDetail=l.payload.VisitorEntryMaterialDetail,o.DtoPurposeList=l.payload.PurposeList,o.DtoVisitorEntryPovDetail=l.payload.VisitorEntryAtvDetail,o.DtoPlantList=l.payload.PlantList}).addCase(Pa.rejected,(o,l)=>{o.loading=!1,o.error=l.payload})}}),{createOrEdit:No}=bo.actions,xo=I=>{const{WPworkPermitWorkers:o,WPfilters:l,WPheader:m,WPactionBodyTemplate:S,WPfilesContent:A,WPcellEditor:D,WPonCellEditComplete:L}=I;return t.jsxs("div",{className:"white",children:[t.jsx("div",{className:"widget-hdr",children:t.jsx("div",{className:"sub-title",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"md:col-6",children:t.jsx("h2",{children:"Workers List"})})})})}),t.jsx("div",{className:"widget-body",children:t.jsx("div",{className:"card",children:t.jsxs(Ra,{value:o,showGridlines:!0,paginator:!0,filters:l,filterDisplay:"menu",globalFilterFields:["WorkerName","WorkerPhoneNo","WorkerMailID","WorkerStatus"],header:m,emptyMessage:"No Data found.",rows:50,rowsPerPageOptions:[5,10,25,50,100],tableStyle:{minWidth:"50rem"},children:[t.jsx(Ne,{sortable:!0,field:"WorkerName",header:"Visitor Name"}),t.jsx(Ne,{sortable:!0,field:"WorkerMailID",header:"Worker Mail ID"}),t.jsx(Ne,{sortable:!0,field:"WorkerPhoneNo",header:"Phone No"}),t.jsx(Ne,{sortable:!0,field:"Validity",header:"Validity",body:(c,j)=>D(c,j)}),t.jsx(Ne,{sortable:!0,field:"WorkerStatus",header:"Worker Status"})]})})})]})},Co=I=>{const{tabConfig:o,itemTemplate:l,sHost:m,sVisit:S,passData:A,toast:D}=I;return console.log(S),console.log(m),t.jsxs("div",{className:"col-12",children:[t.jsxs("div",{className:"white",children:[t.jsx("div",{className:"widget-hdr",children:t.jsx("div",{className:"sub-title",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"col-12",children:t.jsx("h2",{children:"Visitor Information"})})})})}),t.jsxs("div",{className:"widget-body",children:[t.jsxs("div",{className:"visitor-name",children:[(S==null?void 0:S.FirstName)+" "+(S==null?void 0:S.LastName),t.jsxs("span",{className:"emp-id",children:[" - ",S==null?void 0:S.VisitorCode]})]}),t.jsx("div",{className:"visitor-company",children:t.jsx("strong",{children:(S==null?void 0:S.VisitorCompany)||"-"})}),t.jsx("div",{className:"visitor-company",children:S==null?void 0:S.MailId}),t.jsx("div",{className:"visitor-company",children:S==null?void 0:S.MobileNo})]})]}),t.jsxs("div",{className:"white",children:[t.jsx("div",{className:"widget-hdr",children:t.jsx("div",{className:"sub-title",children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"col-12",children:t.jsx("h2",{children:"Host Information"})})})})}),t.jsxs("div",{className:"widget-body",children:[t.jsxs("div",{className:"visitor-name",children:[m==null?void 0:m.UserName," -",t.jsx("span",{className:"emp-id",children:m==null?void 0:m.UserCode})]}),t.jsx("div",{className:"visitor-company",children:t.jsx("strong",{children:m==null?void 0:m.CompanyName})}),t.jsx("div",{className:"visitor-company",children:m==null?void 0:m.UserEmail}),t.jsx("div",{className:"visitor-company",children:m==null?void 0:m.MobileNo})]})]})]})},Mo=I=>{const{tabConfig:o,itemTemplate:l,sHost:m,sVisit:S,passData:A,toast:D}=I;return n.useRef(null),t.jsx("div",{className:"inner-page-container p-2 grid flex-column dp_pass",children:t.jsx("div",{className:"col-12",children:t.jsx(lo,{printPassData:A,toast:D})})})},nn=()=>{const I=al(),[o,l]=n.useState(!1),[m,S]=n.useState(!1),[A,D]=n.useState([]),[L,c]=n.useState(!1),[j,B]=n.useState(!1),[C,Q]=n.useState(!1),[P,F]=n.useState(!1),[R,_]=n.useState(!1),[X,Y]=n.useState(!1),[U,q]=n.useState([]),[re,ye]=n.useState([]),[je,xe]=n.useState([]),[$,oe]=n.useState([]),[Ce,ne]=n.useState([]),[Pe,ee]=n.useState({}),[Z,O]=n.useState([]),[K,fe]=n.useState(""),[te,dt]=n.useState("");n.useState(!1);const[ge,Ze]=n.useState(),[ae,st]=n.useState(),[Fe,It]=n.useState(),[k,St]=n.useState(),[ke,se]=n.useState(),[de,ie]=n.useState({}),[Ae,Je]=n.useState(),[Qe,Oe]=n.useState(!1),[ce,lt]=n.useState(!1),[rt,Ye]=n.useState(!1),[w,Me]=n.useState({}),[bt,Gt]=n.useState(!1),[Nt,Ee]=n.useState([]),[qe,xt]=n.useState([]),y=n.useRef(),[Ue,Ct]=n.useState(!1),[ve,De]=n.useState([]),[Le,ze]=n.useState([]),[Mt,Ht]=n.useState([]),[Zt,Jt]=n.useState([]),[Ti,Qt]=n.useState([]),[wi,Yt]=n.useState([]),[ji,qt]=n.useState([]),[Pi,zt]=n.useState([]),[Xt,ct]=n.useState([]),[Kt,Xe]=n.useState(Rt.NO_IMG),[ut,Ke]=n.useState(null),[mt,Ie]=n.useState(null),_t=n.useRef(null),[Fi,Ba]=n.useState([]),[ki,$t]=n.useState([]),[Ai,ei]=n.useState([]),[Et,ti]=n.useState([]),[Oi,vt]=n.useState([]),[Lt,ii]=n.useState([]),[Ui,pt]=n.useState([]),[ai,si]=n.useState([]),[_e,We]=n.useState([]),[li,ri]=n.useState(),[Wi,Ga]=n.useState(!0),[Ri,Re]=n.useState(!0),[Bi,Be]=n.useState(!0),[Gi,Hi]=n.useState(null),[Zi,oi]=n.useState(!1),[Ji,Qi]=n.useState(!1),[Yi,qi]=n.useState(!1),[zi,ni]=n.useState(!1),[Xi,di]=n.useState(!1),[Ki,ci]=n.useState(!1),[_i,Tt]=n.useState(!1),[$i,Vt]=n.useState(!0),[ea,wt]=n.useState(!1),[ta,jt]=n.useState(!1),[ia,ui]=n.useState(!1),[aa,mi]=n.useState(!0),[pi,G]=n.useState(!1),[$e,et]=n.useState([]),[tt,Ge]=n.useState([]),[sa,Vi]=n.useState([]),[Te,pe]=n.useState(""),[la,Pt]=n.useState(!0),[ra,hi]=n.useState(!0),[oa,yi]=n.useState(!0),[fi,ot]=n.useState(!0),[dl,Eo]=n.useState(!0),[cl,ul]=n.useState(!0),[vo,ml]=n.useState({}),[pl,Ha]=n.useState([]),[gi,Di]=n.useState([]),[Vl,hl]=n.useState();n.useState(!0);const[Ve,Ft]=n.useState(!0),[Za,yl]=n.useState(35),[kt,fl]=n.useState([{id:1,visitorTypeImg:oo,visitorTypeTxt:"Visitor",active:!0,disable:!1,type:35},{id:2,visitorTypeImg:il,visitorTypeTxt:"Contractor",disable:!1,type:36},{id:3,visitorTypeImg:il,visitorTypeTxt:"Work Permit",disable:!1,type:100},{id:4,visitorTypeImg:no,visitorTypeTxt:"Vehicle Trip",disable:!1,type:66}]),{isCreate:He,isView:na,SearchData:Lo,loading:da,error:To,tranStatus:wo,DtoEmployeeList:gl,DtoDepartmentList:Ja,DtoStatusList:Qa,DtoTitleList:Ya,DtoIsPreBookingList:Dl,DtoVisitorTypeList:Il,DtoProofList:qa,DtoVisitorEntryTypeList:jo,DtoVisitorEntryHeader:u,DtoVisitorEntryDetail:za,DtoVisitorEntryBelongingDetail:Sl,DtoVisitorEntryMaterialDetail:bl,DtoVisitorEntryList:Po,DtoVisitorEntryCodeList:Fo,DtoVisitorEmployeeList:ko,DtoVisitorNameList:Nl,DtoVisitorWorkerList:Ao,DtoPreBookingList:Oo,DtoPartyTypeList:xl,DtoAreaList:Cl,DtoChallanTypeList:Xa,DtoRouteList:Ml,DtoPartyNameList:Uo,DtoDriverList:El,DtoVehicleList:vl,DtoMaterialList:Ll,DtoPurposeList:Tl,DtoVisitorEntryPovDetail:ca}=zs(e=>e.visitorentry),z=ll();n.useEffect(()=>{vi()});const Ka={VisitorEntryId:u?u.VisitorEntryId:0,VisitorEntryCode:u?u.VisitorEntryCode:"",VisitorEntryDate:u?new Date(u.VisitorEntryDate):new Date,CompanyId:u?u.CompanyId:localStorage.CompanyId,PlantId:u?u.PlantId:localStorage.PlantId,GateId:u?u.GateId:localStorage.GateId,VisitorTypeId:u?u.VisitorTypeId:35,VisitorId:u?u.VisitorDetailId:null,PersonName:u?u.PersonName:"",MobileNo:u?u.MobileNo:"",IdProofType:u?u.IdProofType:null,IdProofNo:u?u.IdProofNo:"",VisitedEmployeeId:u?u.VisitedEmployeeId:null,ValidFrom:u?new Date(u.ValidFrom):new Date,ValidTo:u?new Date(u.ValidTo):new Date,AccessType:u?u.AccessType:null,IsExtended:u?u.IsExtended:!1,IsAppointmentBooking:u?u.IsAppointmentBooking:!1,IsPreBooking:u?u.IsPreBooking:16,VisitorRemarks:u?u.VisitorRemarks:"",PurposeOfVisit:u?u.PurposeOfVisit:"",AreaToVisit:u?u.AreaToVisit:null,VisitorImageName:u?u.VisitorImageName:"",VisitorImageUrl:u?u.VisitorImageUrl:"",PartyType:u?u.PartyType:null,PartyName:u?u.PartyName:null,InvoiceNumber:u?u.InvoiceNumber:"",DcNumber:u?u.DcNumber:"",PoNumber:u?u.PoNumber:"",ContainerNumber:u?u.ContainerNumber:"",IsExistingVehicle:u?u.IsExistingVehicle:null,VehicleName:u?u.VehicleName:"",VehicleNo:u?u.VehicleNo:"",IsExistingDriver:u?u.IsExistingDriver:null,DriverId:u?u.DriverId:"",VehicleDocumentName:u?u.VehicleDocumentName:"",VehicleDocumentUrl:u?u.VehicleDocumentUrl:"",RouteId:u?u.RouteId:null,NumberOfPassengers:u?u.NumberOfPassengers:"",PlannedTravellingKm:u?u.PlannedTravellingKm:"",ActualTravellingKm:u?u.ActualTravellingKm:"",Status:u?u.Status:74,CreatedBy:u?u.CreatedBy:+localStorage.UserId,CreatedOn:u?new Date(u.CreatedOn):new Date,ModifiedBy:u?+localStorage.UserId:null,ModifiedOn:u?new Date:null,ChallanType:u?u.ChallanType:98},h=Ta({initialValues:Ka,validationSchema:ro,onSubmit:(e,{resetForm:s})=>{var be;console.log(e),console.log($[0].VisitorDetailId),e.IsExternal=!1,G(!0);const a=new FormData;if(e.VisitorTypeId!=66){if(e.VisitorId==""&&(e.VisitorTypeId==35||e.VisitorTypeId==36))return T("Please Select Visitor Name");if(e.PersonName==""&&e.VisitorTypeId!=35&&e.VisitorTypeId!=36)return T("Please Enter Visitor Name");if(!e.VisitedEmployeeId)return T("Please Select Person To Visit");if(e.IdProofNo!=""&&e.idProofType===17&&!/^\d{12}$/.test(e.IdProofNo))return T("Please Enter Valid Aadhar Proof No");if(!e.ValidFrom&&e.VisitorTypeId==36)return T("Please Select Valid From");if(!e.ValidFrom&&e.VisitorTypeId!=36)return T("Please Select Appointment Date");if(e.VisitorTypeId==36&&!e.ValidTo)return T("Please Select Valid To");if(e.VisitorTypeId==36&&e.ValidFrom>e.ValidTo)return T("From Date Should Not be Greater Than To Date");if(e.VisitorTypeId==64||e.VisitorTypeId==65){if(!e.PartyType)return T("Please Select Party Type");if(!e.PartyName)return T("Please Select Party Name");if(!tt||!tt.length||tt.length==0)return T("Please Add Material Details");if(tt.filter(N=>N.MaterialId==null||N.Qty=="").length>0)return T("Please Add All the Details In Material Details.")}if((e.VisitorTypeId==35||e.VisitorTypeId==36)&&$e.length>0){let J=$e.filter(N=>N.DeviceName==""&&N.DeviceNo=="");if(!($e.length==1&&J.length>0)){if($e.filter(M=>M.DeviceName==""||M.DeviceNo=="").length>0)return T("Please Add All the Details In Belonging Details.")}}if(e.VisitorTypeId==64&&e.DcNumber=="")return T("Please Enter DC Number");if(e.VisitorTypeId==65&&e.InvoiceNumber=="")return T("Please Enter Invoice Number");if(e.VisitorTypeId!=35&&e.VisitorTypeId!=36){if(e.VehicleName==""&&e.IsExistingVehicle)return T("Please Select Vehicle Name");if(e.VehicleName==""&&!e.IsExistingVehicle)return T("Please Enter Vehicle Name");if(e.VehicleNo=="")return T("Please Enter Vehicle No");if(!e.RouteId)return T("Select Route");if(e.PlannedTravellingKm=="")return T("Please Enter Planned Travelling Km");if(e.ActualTravellingKm=="")return T("Please Enter Actual Travelling Km");if(!gi||!gi.length||gi.length==0)return T("Please Select Area To Visit")}if(e.PurposeOfVisit==null||e.PurposeOfVisit=="")return T("Please Select Purpose Of Visit")}else if(e.VisitorTypeId==66){if(e.DriverId==""||e.DriverId==null)return T("Please Select Driver Name");if(!m&&e.StartingKm==null||e.StartingKm=="")return T("Please Enter Starting Km");if(m&&e.EndingKm==null||e.EndingKm=="")return T("Please Enter Ending Km");if(e.PurposeOfVisit==null||e.PurposeOfVisit=="")return T("Please Select Purpose Of Visit");if(m&&e.StartingKm>e.EndingKm)return T("Ending Km Should not Less than Starting Km ")}let i=$,r=$e,d=tt;e.VisitorTypeId==35&&(d=[]),e.VisitorTypeId==36&&(d=[]),e.VisitorTypeId==64&&(i=[],r=[]),e.VisitorTypeId==65&&(i=[],r=[]),e.VisitorTypeId==66&&(d=[],i=[]);let V=[],b=[],g=[],H=new Date(e.ValidFrom.getFullYear(),e.ValidFrom.getMonth(),e.ValidFrom.getDate());if(H.setHours(23,59,59,999),i.length>0)for(let J=0;J<i.length;J++){const N=i[J];let M={};M.VisitorEntryDetailId=N.VisitorEntryDetailId??0,M.VisitorEntryDetailCode=N.visitordetailCode??0,M.VisitorEntryId=N.VisitorEntryId??0,M.VisitorId=N.VisitorDetailId??0,M.TitleId=N.TitleId,M.FirstName=N.FirstName,M.LastName=N.LastName,M.DepartmentId=N.DepartmentId,M.Dob=N.Dob,M.MailId=N.MailId,M.MobileNo=N.MobileNo,M.IdCardType=N.IdCardType,M.IdCardNo=N.IdCardNo,M.DocumentName=Te,M.DocumentUrl=Te,M.Status=N.Status,M.ValidFrom=it(e.ValidFrom),M.ValidTo=e.VisitorTypeId==35?ue(H):it(e.ValidTo),M.IsEditedImage=!0,V.push(M)}if(r.length>0)for(let J=0;J<r.length;J++){const N=r[J];let M={};M.VisitorEntryBelongingDetailId=N.VisitorEntryBelongingDetailId??0,M.VisitorEntryId=N.VisitorEntryId??0,M.DeviceNo=N.DeviceNo,M.DeviceName=N.DeviceName,b.push(M)}if(d.length>0)for(let J=0;J<d.length;J++){const N=d[J];let M={};M.VisitorEntryMaterialDetailId=N.VisitorEntryMaterialDetailId??0,M.VisitorEntryId=N.VisitorEntryId??0,M.MaterialId=N.MaterialId,M.Uom=N.Uom,M.Qty=N.Qty,g.push(M)}if(!ut&&e.VisitorTypeId!=66){G(!1),(be=y.current)==null||be.show({severity:"warn",detail:"Please Capture Image",summary:"Warning Message"});return}var p=new Date(e.ValidFrom.getFullYear(),e.ValidFrom.getMonth(),e.ValidFrom.getDate());p.setHours(23,59,59,999),e.ValidFrom=ue(new Date(e.ValidFrom)),e.ValidFrom=ue(new Date(e.ValidFrom)),e.ValidTo=e.VisitorTypeId==35?ue(p):ue(new Date(e.ValidTo)),e.VisitorEntryDate=ue(new Date(e.VisitorEntryDate)),e.CreatedOn=ue(new Date(e.CreatedOn)),e.IsInternalAppointment=!1,e.VisitorId=$[0].VisitorDetailId,(!He||m)&&(e.ModifiedOn=ue(new Date),e.ModifiedBy=+localStorage.UserId);let me=JSON.stringify({VisitorEntry:e,VisitorEntryDetail:V??[],VisitorEntryBelongingDetail:b??[],VisitorEntryMaterialDetail:g??[],VisitorEntryAtvDetail:gi??[]});if(a.append("input",me),a.append("webfile",ut),a.append("webfile1",mt),a.append("webfiles",[]),console.log(Ve),m||!Ve){var he=z(Qr(a));he.then(J=>{var N,M;J.payload.tranStatus.result==!0?((N=y.current)==null||N.show({severity:"success",summary:"Success Message",detail:J.payload.tranStatus.lstErrorItem[0].Message}),c(!1),G(!1),we({target:{value:e.VisitorTypeId,id:e.VisitorTypeId}}),nt()):(we({target:{value:e.VisitorTypeId,id:e.VisitorTypeId}}),G(!1),(M=y.current)==null||M.show({severity:"error",summary:"Error Message",detail:J.payload.tranStatus.lstErrorItem[0].Message}))}).catch(J=>{var N;we({target:{value:e.VisitorTypeId,id:e.VisitorTypeId}}),G(!1),(N=y.current)==null||N.show({severity:"error",summary:"Error",detail:JSON.stringify(J)})})}else{var he=z(el(a));he.then(N=>{var M,qs;if(N.payload.tranStatus.result==!0){if(G(!1),(M=y.current)==null||M.show({severity:"success",summary:"Success Message",detail:N.payload.tranStatus.lstErrorItem[0].Message}),c(!1),+w.selectedType==35&&ya(event,N.payload.VisitorEntryHeader,!1),e.IsAppointmentBooking==!1&&+w.selectedType!=66){let wr={VisitorEntryDetailId:N.payload.VisitorEntryDetail[0].VisitorEntryDetailId,VisitorEntryCode:N.payload.VisitorEntryHeader.VisitorEntryCode};Pl(wr)}G(!1),nt()}else we({target:{value:35,id:35}}),G(!1),(qs=y.current)==null||qs.show({severity:"error",summary:"Error",detail:N.payload.tranStatus.lstErrorItem[0].Message})}).catch(N=>{var M;G(!1),we({target:{value:e.VisitorTypeId,id:e.VisitorTypeId}}),(M=y.current)==null||M.show({severity:"error",summary:"Error",detail:JSON.stringify(N)})})}}}),wl=e=>{Ft(!1),console.log(e);const s={VisitorId:e.VisitorId};var a=z($s(s));a.then(i=>{var r;if(i.payload.tranStatus.result){console.log(i.payload);let d={...i.payload.VisitorHeader};d.VisitorDetails=i.payload.VisitorDetail,console.log(d),cs(d),B(!0)}else(r=y.current)==null||r.show({severity:"error",summary:"Error",detail:i.payload.tranStatus.lstErrorItem.message})}).catch(i=>{var r;(r=y.current)==null||r.show({severity:"error",summary:"Error",detail:JSON.stringify(i)})})},jl=e=>{z(No(e)),Ft(!1),ws(e.VisitorId);const s={VisitorEntryId:e.VisitorEntryId,PlantId:+localStorage.PlantId,CompanyId:+localStorage.CompanyId,RoleId:+localStorage.DefaultRoleId};z(wa(s)).then(i=>{var r;i.payload.tranStatus.result==!0?(Hl(i.payload.VisitorEntryHeader),c(!0)):(r=y.current)==null||r.show({severity:"error",summary:"Error Message",detail:i.payload.tranStatus.lstErrorItem[0].Message})}).catch(i=>{var r;(r=y.current)==null||r.show({severity:"error",summary:"Error Message",detail:JSON.stringify(i)})})},Pl=e=>{let s={UserId:localStorage.UserId,VisitorEntryCode:e.VisitorEntryCode,VisitorEntryDetailId:e.VisitorEntryDetailId,Checkintime:it(new Date),type:"SelfApproval"};var a=z(Yr(s));a.then(i=>{var r,d;i.payload.tranStatus.result?((r=y.current)==null||r.show({severity:"success",summary:"Success Message",detail:"Checked In Successfully."}),ms()):(d=y.current)==null||d.show({severity:"error",summary:"Error",detail:i.payload.tranStatus.lstErrorItem[0].Message})}).catch(i=>{var r;(r=y.current)==null||r.show({severity:"error",summary:"Error",detail:JSON.stringify(i)})})},Fl=()=>{qt(Il),Yt(Dl),zt(qa),Ht(Qa),Jt(Xa),Qt(Ya),De(gl),ze(Ja),ct(Nl),$t(xl),ei(Cl),ti(Ml),ii(El),We(vl),Vi(Ll),Ha(Tl);let e=[];for(let a=0;a<za.length;a++){const i=za[a];let r={};r.VisitorEntryDetailId=i.VisitorEntryDetailId,r.VisitorEntryId=i.VisitorEntryId,r.VisitorId=i.VisitorDetailId,r.TitleId=i.TitleId,r.FirstName=i.FirstName,r.LastName=i.LastName,r.DepartmentId=i.DepartmentId,r.Dob=new Date(i.Dob),r.MailId=i.MailId,r.MobileNo=i.MobileNo,r.IdCardType=i.IdCardType,r.IdCardNo=i.IdCardNo,r.DocumentName=i.DocumentName,r.DocumentUrl=i.DocumentName,r.Status=i.Status,r.VisitorName=Ya.find(V=>V.MetaSubId==i.TitleId).MetaSubDescription+"."+r.FirstName+" "+r.LastName,r.StatusName=Qa.find(V=>V.MetaSubId==i.Status).MetaSubDescription,r.IdCardTypeName=qa.find(V=>V.MetaSubId==i.IdCardType).MetaSubDescription,i.DepartmentId?r.DepartMentName=Ja.find(V=>V.DepartmentId==i.DepartmentId).DepartmentName:r.DepartMentName="";const d=new Date(i.Dob).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});r.ShowDate=d,e.push(r)}oe(e),et(Sl),Ge(bl),Di(ca),ht("VisitorTypeId",{},u.VisitorTypeId),u.PartyType&&is("PartyType",{},u.PartyType);let s=ca.map(a=>a.AreaToVisit);_a("AreaToVisit",{},s,1),es(u.VisitorImageUrl).then(a=>{const i=new File([a],u.VisitorImageName,{type:"image/*",lastModified:1695716506050});Ke(i),Xe(u.VisitorImageUrl)}).catch(a=>{var i;(i=y.current)==null||i.show({severity:"error",detail:"Error",summary:JSON.stringify(a)})}),(u.VisitorTypeId==64||u.VisitorTypeId==65||u.VisitorTypeId==66)&&es(u.VehicleDocumentUrl).then(a=>{const i=new File([a],u.VehicleDocumentName,{type:"image/*",lastModified:1695716506050});Ie(i),pe(u.VehicleDocumentUrl)}).catch(a=>{var i;(i=y.current)==null||i.show({severity:"error",detail:"Error",summary:JSON.stringify(a)})})},kl=e=>{const s={VisitorEntryId:e,CompanyId:+localStorage.CompanyId,PlantId:+localStorage.PlantId,RoleId:+localStorage.DefaultRoleId};var a=z(wa(s));a.then(i=>{var r;if(i.payload.tranStatus.result==!0){if(qt(i.payload.VisitorTypeList),Yt(i.payload.IsPreBookingList),zt(i.payload.ProofList),Ht(i.payload.StatusList),Jt(i.payload.ChallanTypeList),Qt(i.payload.TitleList),De(i.payload.EmployeeList),ze(i.payload.DepartmentList),ct(i.payload.VisitorNameList),q(i.payload.VisitorNameList),$t(i.payload.PartyTypeList),ei(i.payload.AreaList),ti(i.payload.RouteList),ii(i.payload.DriverList),We(i.payload.VehicleList),ri(i.payload.VehicleList),Vi(i.payload.MaterialList),pt(i.payload.WorkPermitList),si(i.payload.WorkPermitList),Ha(i.payload.PurposeList),He==!0){+(w==null?void 0:w.selectedType)!=66&&+(w==null?void 0:w.selectedType)!=65&&ht("VisitorTypeId",{},w==null?void 0:w.selectedType);let d={};d.VisitorEntryBelongingDetailId=0,d.VisitorEntryId=0,d.DeviceNo="",d.DeviceName="",et([d]);let V={};V.VisitorEntryMaterialDetailId=0,V.VisitorEntryId=0,V.MaterialId=null,V.Uom=null,V.Qty="",Ge([V]),ce||h.setFieldValue("VisitedEmployeeId",w.selectedWhomToVisit)}}else(r=y.current)==null||r.show({severity:"error",detail:"Error",summary:i.payload.tranStatus.lstErrorItem[0].Message})}).catch(i=>{var r;(r=y.current)==null||r.show({severity:"error",detail:"Error",summary:JSON.stringify(i)})})},ua=(e,s,a)=>{h.setFieldValue(e,a)},_a=(e,s,a,i=0)=>{if(h.setFieldValue(e,a),i==0){Di([]);let r=[];for(let d=0;d<a.length;d++){const V=a[d];let b={};b.VisitorEntryAtvDetailId=0,b.VisitorEntryId=0,b.AreaToVisit=V,r.push(b)}Di(r)}},Al=(e,s,a)=>{h.setFieldValue(e,a);let i=Et.find(r=>r.RouteId==a).RouteDistanceInKm;h.setFieldValue("PlannedTravellingKm",i)},$a=e=>{h.setFieldValue(e.target.name,e.value)},Ol=(e,s,a)=>{h.setFieldValue(e,a)},T=e=>{var s;G(!1),(s=y.current)==null||s.show({severity:"warn",summary:"Warning Message",detail:e})},ue=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});async function es(e){const s=await Xs(e);if(!s.ok)throw new Error(`Failed to fetch image: ${s.statusText}`);return await s.blob()}const nt=()=>{h.resetForm();let e={};e.VisitorEntryBelongingDetailId=0,e.VisitorEntryId=0,e.DeviceNo="",e.DeviceName="",et([e]);let s={};s.VisitorEntryMaterialDetailId=0,s.VisitorEntryId=0,s.MaterialId=null,s.Uom=null,s.Qty="",Ge([s]),Ge([]),Di([]),Ke(null),Xe(Rt.NO_IMG),Ie(null),pe(""),vt([]),us(0),c(!1),fe(""),ie({}),se({}),Je({}),S(!1),we({target:{value:35,id:35}}),js()};n.useEffect(()=>{console.log(U),console.log(w),ce||U&&U.length>0&&Ii("VisitorId",{},w.selectedVisitorId,[])},[U]);const Ii=(e,s,a,i)=>{if(console.log(i),console.log(a),h.setFieldValue(e,a),i&&i.length>0){let r=i.find(d=>d.VisitorDetails.find(V=>V.VisitorDetailId==a));r&&ts(r,a)}else if(U&&U.length>0){let r=U.find(d=>d.VisitorDetailId==a);r&&ts(r,a)}},ts=(e,s)=>{if(console.log(e),h.setFieldValue("PersonName",e.FirstName),h.setFieldValue("VisitorId",e.VisitorDetailId),h.setFieldValue("MobileNo",e.MobileNo),h.setFieldValue("IdProofType",e.IdCardType),h.setFieldValue("IdProofNo",e.IdCardNo),oe([]),h.values.VisitorTypeId==36||h.values.VisitorTypeId==35){let i={VisitorTypeId:h.values.VisitorTypeId,VisitorId:s};var a=z(Gr(i));a.then(r=>{var d;if(r.payload.tranStatus.result==!0){let V=r.payload.VisitorWorkerList;for(let b=0;b<V.length;b++){const g=V[b];g.Dob=new Date(g.Dob);const H=g.Dob.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});g.ShowDate=H}oe(V)}else(d=y.current)==null||d.show({severity:"error",detail:"Error",summary:r.payload.tranStatus.lstErrorItem[0].Message})}).catch(r=>{var d;(d=y.current)==null||d.show({severity:"error",detail:"Error",summary:JSON.stringify(r)})})}},is=(e,s,a)=>{h.setFieldValue(e,a);var r=z(qr({PartyType:a}));r.then(d=>{var V;d.payload.tranStatus.result==!0?vt(d.payload.PartyNameList):(V=y.current)==null||V.show({severity:"error",detail:"Error",summary:d.payload.tranStatus.lstErrorItem[0].Message})}).catch(d=>{var V;(V=y.current)==null||V.show({severity:"error",detail:"Error",summary:JSON.stringify(d)})})},as=e=>{h.setFieldValue(e.target.name,e.checked);let s=e.value?e.value:h.values.VisitorTypeId,a={target:{name:"ValidFrom"},value:u?new Date(u.ValidFrom):new Date,VisitorTypeId:s},i={target:{name:"IsExistingVehicle"},checked:u?u.IsExistingVehicle:!0};ss(i);let r={target:{name:"IsExistingDriver"},checked:u?u.IsExistingDriver:!0};if(rs(r),Tt(!0),ni(!1),di(!1),ci(!1),Vt(!0),mi(!0),wt(!1),He){h.setFieldValue("PartyType",null),h.setFieldValue("PartyName",null),h.setFieldValue("RouteId",null),h.setFieldValue("NumberOfPassengers",""),h.setFieldValue("PlannedTravellingKm",""),h.setFieldValue("ActualTravellingKm",""),h.setFieldValue("ValidFrom",new Date),h.setFieldValue("ValidTo",new Date),vt([]),Ge([]),et([]);let d={};d.VisitorEntryBelongingDetailId=0,d.VisitorEntryId=0,d.DeviceNo="",d.DeviceName="",et([d]);let V={};V.VisitorEntryMaterialDetailId=0,V.VisitorEntryId=0,V.MaterialId=null,V.Uom=null,V.Qty="",Ge([V])}jt(!1),ui(!1),Pt(!0),hi(!0),yi(!0),ot(!0),oi(!0),s==35?(jt(!0),oi(!1),e.checked?(Re(!1),Be(!0)):(Re(!0),Be(!0)),ma(a)):s==36?(jt(!0),ui(!0),e.checked?(Re(!1),Be(!1),ma(a)):(Re(!0),Be(!0))):(mi(!1),s==64?(Tt(!1),ni(!0),Vt(!1),wt(!0),Re(!0),Be(!0),Pt(!1),hi(!1),ot(!1)):s==65?(Tt(!1),di(!0),Vt(!1),wt(!0),Re(!0),Be(!0),Pt(!1),yi(!1),ot(!1)):s==66&&(ci(!0),Vt(!1),Re(!0),Be(!0)))},Ul=e=>{h.setFieldValue(e.target.name,e.value),e.value==15?I.push("/home/vVisitorEntry"):(h.setFieldValue("VisitorEntryCode",""),h.setFieldValue("VisitorEntryDate",new Date),ht("VisitorTypeId",{},35),Ma("VisitorTypeId",{},35))},ma=e=>{h.setFieldValue(e.target.name,e.value);let s=e.VisitorTypeId?e.VisitorTypeId:h.values.VisitorTypeId;s==35?h.setFieldValue("ValidTo",null):s==36&&(h.setFieldValue("ValidTo",null),Hi(e.value))},Wl=e=>{h.setFieldValue(e.target.name,e.value)},ss=e=>{h.setFieldValue(e.target.name,e.checked),He&&(h.setFieldValue("VehicleName",""),h.setFieldValue("VehicleNo","")),Qi(e.checked)},ls=(e,s,a,i)=>{console.log(a),h.setFieldValue(e,a),console.log(_e.find(r=>r.VehicleName==a)),h.setFieldValue("VehicleNo",_e.find(r=>r.VehicleNo==i).VehicleNo)},Rl=(e,s,a)=>{h.setFieldValue(e,a),Lt&&Lt.length>0&&h.setFieldValue("DriverId",Lt.find(i=>i.UserId==a).UserId)},rs=e=>{h.setFieldValue(e.target.name,e.checked),He&&h.setFieldValue("DriverId",""),qi(e.checked)},Bl=(e,s,a)=>{h.setFieldValue(e,a)},Gl=e=>{Ke(e),h.setFieldValue("VisitorImageName",e.name),h.setFieldValue("VisitorImageUrl",e.name);const s=URL.createObjectURL(e);Xe(s),W.setFieldValue("DocumentName",e.name),W.setFieldValue("DocumentUrl",e.name),pe(e.name)},os=e=>{Ie(e.files[0]),h.setFieldValue("VehicleDocumentName",e.files[0].name),h.setFieldValue("VehicleDocumentUrl",e.files[0].name);const s=URL.createObjectURL(e.files[0]);pe(s)},pa=()=>{pe(""),Ie(null),h.setFieldValue("VehicleDocumentName",""),h.setFieldValue("VehicleDocumentUrl","")},ns=()=>{Te!=""&&window.open(Te,"_blank")},ds=()=>t.jsxs("div",{className:"flex align-items-center flex-column",children:[t.jsx("i",{className:"pi pi-image mt-3 p-5",style:{fontSize:"5em",borderRadius:"50%",backgroundColor:"var(--surface-b)",color:"var(--surface-d)"}}),t.jsx("span",{style:{fontSize:"1.2em",color:"var(--text-color-secondary)"},className:"my-5",children:"Drag and Drop Image Here"})]}),ht=(e,s,a)=>{q([]),console.log(),He&&oe([]),h.setFieldValue(e,a);let i={VisitorTypeId:a,CompanyId:+localStorage.CompanyId,RoleId:+localStorage.DefaultRoleId};var r=z(zr(i));r.then(d=>{var V;if(d.payload.tranStatus.result==!0){q(d.payload.VisitorNameList),ct(d.payload.VisitorNameList),We(d.payload.VehicleList),ri(d.payload.VehicleList),pt(d.payload.WorkPermitList),si(d.payload.WorkPermitList),He&&(h.setFieldValue("IdProofType",null),h.setFieldValue("IdProofNo",""),h.setFieldValue("InvoiceNumber",""),h.setFieldValue("DcNumber",""),h.setFieldValue("PoNumber",""),h.setFieldValue("ContainerNumber",""));let b={target:{name:"IsAppointmentBooking"},checked:He?a==36:u.IsAppointmentBooking,value:a};as(b)}else(V=y.current)==null||V.show({severity:"error",detail:"Error",summary:d.payload.tranStatus.lstErrorItem[0].Message})}).catch(d=>{var V;(V=y.current)==null||V.show({severity:"error",detail:"Error",summary:JSON.stringify(d)})})};n.useEffect(()=>{console.log(w),vi(),Me({...w,selectedType:35}),(o||!o)&&us(0)},[o]),n.useEffect(()=>{if(!o){if((w==null?void 0:w.selectedType)!=66&&(w==null?void 0:w.selectedType)!=65&&!X&&ke&&de&&Object.keys(ke).length>0&&Object.keys(de).length>0&&ke&&de&&(lt(!1),c(!0)),Ae&&Object.keys(Ae).length>0){let s={VehicleData:Ae.vehicleNo,CompanyId:+localStorage.CompanyId,PlantId:+localStorage.PlantId};var e=z(Hr(s));e.then(a=>{var i;if(a.payload.tranStatus.result)if(a.payload.VehicleDataList!=null&&a.payload.VehicleDataList.length>0){D(a.payload.VehicleDataList);let r=a.payload.VehicleDataList[0];ql({},{DriverId:+r.Driver_Id}),h.setFieldValue("StartingKm",r.Starting_Km),h.setFieldValue("PurposeOfVisit",r.Purpose_Of_Visit),h.setFieldValue("VisitorEntryId",r.Visitor_Entry_Id),h.setFieldValue("VisitorEntryCode",r.Visitor_Entry_Code),h.setFieldValue("VisitorTypeId",r.Visitor_Type_Id),h.setFieldValue("Status",r.Status),S(!0),c(!0)}else h.setFieldValue("StartingKm",""),h.setFieldValue("EndingKm",""),h.setFieldValue("PurposeOfVisit",""),h.setFieldValue("VisitorEntryId",0),h.setFieldValue("VisitorEntryCode",""),h.setFieldValue("Status",74),S(!1),c(!0);else(i=y.current)==null||i.show({severity:"error",summary:"Error",detail:a.payload.tranStatus.lstErrorItem[0].Message})})}if(ge&&Object.keys(ge).length>0){let s={WorkPermitId:ge.WorkPermitId,WorkPermitCode:ge.WorkPermitCode,CompanyId:+localStorage.CompanyId,PlantId:+localStorage.PlantId};var e=z(Zr(s));e.then(i=>{var r;i.payload.tranStatus.result?i.payload.WorkPermitWorkerDetails!=null&&i.payload.WorkPermitWorkerDetails.length>0&&(fr(new Date(i.payload.WorkPermitHeader.ValidFrom)),yr(new Date(i.payload.WorkPermitHeader.ValidTo)),St(i.payload.WorkPermitHeader),st(i.payload.WorkPermitWorkerDetails),It(i.payload.WorkPermitEntryDetails),Er(i),Q(!0)):(r=y.current)==null||r.show({severity:"error",summary:"Error",detail:i.payload.tranStatus.lstErrorItem[0].Message})})}Qe&&c(!0)}},[ke,de,Ae,Qe,ge]);const Hl=e=>{const s={VisitorTypeId:e.VisitorTypeId,VisitorId:e.VisitorId,UserId:e.VisitedEmployeeId,VisitorEntryCode:e.VisitorEntryCode,CompanyId:+localStorage.CompanyId,PlantId:+localStorage.PlantId};var a=z(Xr(s));a.then(i=>{i.payload.tranStatus.result==!0&&i.payload.LastVisitorEntryList&&i.payload.LastVisitorEntryList.length>0&&(Jl(i.payload.LastVisitorEntryList),Zl(i.payload.LastVisitorEntryBelongList),cs(i.payload.LastVisitorEntryList),c(!0))}).catch(i=>{})},Zl=e=>{},cs=e=>{console.log(e),W.setFieldValue("FirstName",e.hasOwnProperty("WorkerName")?e.WorkerName:e.FirstName),W.setFieldValue("VisitorCode",e.VisitorCode),W.setFieldValue("VisitorCompany",e.VisitorCompany),W.setFieldValue("VisitorId",e.VisitorId),W.setFieldValue("MailId",e.MailId),W.setFieldValue("MobileNo",e.MobileNo),W.setFieldValue("Status",e.Status),E.setFieldValue("VisitorDetailId",e.VisitorDetails[0].VisitorDetailId),E.setFieldValue("VisitorId",e.VisitorDetails[0].VisitorId),E.setFieldValue("TitleId",e.VisitorDetails[0].TitleId),E.setFieldValue("FirstName",e.VisitorDetails[0].FirstName),E.setFieldValue("LastName",e.VisitorDetails[0].LastName),E.setFieldValue("DepartmentId",e.VisitorDetails[0].DepartmentId),E.setFieldValue("Dob",e.VisitorDetails[0].Dob),E.setFieldValue("MailId",e.VisitorDetails[0].MailId),E.setFieldValue("MobileNo",e.VisitorDetails[0].MobileNo),E.setFieldValue("IdCardType",e.VisitorDetails[0].IdCardType),E.setFieldValue("IdCardNo",e.VisitorDetails[0].IdCardNo),E.setFieldValue("DocumentName",e.VisitorDetails[0].DocumentName),E.setFieldValue("DocumentUrl",e.VisitorDetails[0].DocumentUrl),E.setFieldValue("Status",e.VisitorDetails[0].Status),E.setFieldValue("ExpirryDate",new Date(e.VisitorDetails[0].ExpirryDate)),E.setFieldValue("WorkSeverity",e.VisitorDetails[0].WorkSeverity)},Jl=e=>{let s=Object.keys(Ka);e&&e.map(a=>{Object.entries(a).map(([i,r])=>{s.includes(i)&&s.forEach(d=>{h.setFieldValue(i,r)})})}),Ii("VisitorId",{},e[0].VisitorDetailId,[]),ua("PersonToVisit",{},e[0].VisitedEmployeeId),console.log(ca)},Ql=()=>{c(!0),Ft(!0),lt(!0)},us=e=>{o&&ms(),At(e)},At=e=>{const s={VisitorEntryId:e,CompanyId:+localStorage.CompanyId,PlantId:+localStorage.PlantId,RoleId:+localStorage.DefaultRoleId};var a=z(wa(s));a.then(i=>{i.payload.tranStatus.result==!0&&(De(i.payload.EmployeeList),O(i.payload.EmployeeList),q(i.payload.VisitorNameList),ct(i.payload.VisitorNameList))}).catch(i=>{})},ms=()=>{let e={PlantId:+localStorage.PlantId};var s=z(Xs(e));s.then(a=>{var i;a.payload.tranStatus.result==!0?(Ee(a.payload.VisitorEntryList),xt(a.payload.VisitorEntryList)):(i=y.current)==null||i.show({severity:"error",detail:"Error",summary:a.payload.tranStatus.lstErrorItem[0].Message})}).catch(a=>{var i;(i=y.current)==null||i.show({severity:"error",detail:"Error",summary:JSON.stringify(a)})})};Ks.Fragment,n.useEffect(()=>{const e=setTimeout(()=>{if(te=="visit_search"){const s=Xt.filter(a=>a.FirstName.toLowerCase().includes(K.toLowerCase())||a.VisitorCode.toLowerCase().includes(K.toLowerCase())||a.MobileNo.includes(K));q(s),K==""&&q(Xt)}if(te=="host_search"){const s=Z.filter(a=>a.UserName.toLowerCase().includes(K.toLowerCase()));De(s),K==""&&De(Z)}if(te=="vehicle_search"){const s=li.filter(a=>a.VehicleNo.toLowerCase().includes(K.toLowerCase()));We(s),K==""&&We(li)}if(te=="appointment_search"){const s=qe.filter(a=>a.VisitorEntryCode.toLowerCase().includes(K.toLowerCase()));Ee(s),K==""&&Ee(qe)}if(te=="work_permit_search"){const s=ai.filter(a=>a.WorkPermitCode.toLowerCase().includes(K.toLowerCase())||a.ContractorName.toLowerCase().includes(K.toLowerCase()));pt(s),K==""&&pt(ai)}},10);return()=>clearTimeout(e)},[K,te]);const Yl=e=>{fe(e.target.value),dt(e.target.id)},Va=e=>{if(e){Me({...w,selectedWhomToVisit:e.UserId}),ie(e),De({...ve});const s=ve.map(a=>({...a,IsActive:a.UserId===e.UserId}));De(s)}},ha=e=>{if(console.log(e),console.log(w),e){Me({...w,selectedVisitorId:e.VisitorDetailId}),se(e),q({...U});const s=U.map(a=>({...a,IsActive:a.VisitorDetailId===e.VisitorDetailId}));q(s)}},ql=(e,s)=>{s&&Rl("DriverId",{},s.DriverId)},zl=(e,s)=>{s&&Ze({...ge,...s})},Xl=(e,s)=>{if(s){Je({...Ae,vehicleNo:s.VehicleNo});const a=_e.map(i=>({...i,IsActive:i.VehicleNo===s.VehicleNo}));We(a),ls("VehicleName",{},s.VehicleName,s.VehicleNo)}},ya=(e,s,a)=>{if(console.log(s),console.log(re),s){let i=ve.filter(b=>b.UserId==s.VisitedEmployeeId),r=re.filter(b=>b.VisitorDetailId==s.VisitorId);console.log(U),console.log(r),ha(r[0]),Va(i[0]),console.log(w),Me({...w,selectedVisitorId:s.VisitorDetailId}),ee(s);let d={VisitorEntryId:s==null?void 0:s.VisitorEntryId};z(Kr(d)).then(b=>{Kl(s,b,a)})}},Kl=(e,s,a)=>{let i,r,d;console.log(a),console.log(e),console.log(s),a?(i=e==null?void 0:e.VisitorEntryDetailId,r=e==null?void 0:e.VisitorEntryId,d=e==null?void 0:e.VisitorEntryCode,e==null||e.VisitorTypeId):(i=s.payload.OnChangeEntryDetailList[0].VisitorEntryDetailId,r=e==null?void 0:e.VisitorEntryId,d=e==null?void 0:e.VisitorEntryCode,e==null||e.VisitorTypeId);let V={VisitorEntryId:r,VisitorEntryCode:d,DetailId:i,CompanyId:+localStorage.CompanyId,PlantId:+localStorage.PlantId,VisitorTypeId:e==null?void 0:e.VisitorTypeId};z(_r(V)).then(g=>{var H;if(g.payload.tranStatus.result==!0){g.payload.VisitorEntryHeader.VisitorEntryCode,g.payload.VisitorEntryHeader.VisitorTypeId;let p=g.payload.VisitorEntryDetails;ul(p),ml(g.payload.VisitorEntryHeader),ye(g.payload.UpdatedVisitorNameList),ne(g.payload.VisitorEntryDetails),xe(g.payload.VisitorEntryBelongingDetail),_l(g.payload.VisitorEntryHeader,g.payload.UpdatedVisitorNameList,g.payload.VisitorEntryBelongingDetail)}else(H=y.current)==null||H.show({severity:"error",detail:"Error",summary:g.payload.tranStatus.lstErrorItem[0].Message})}).catch(g=>{})},_l=(e,s,a)=>{console.log(e);let i=ve.filter(d=>d.UserId==e.VisitedEmployeeId),r;s&&s.length>0?r=s.filter(d=>d.VisitorDetailId==e.VisitorId):r=re.filter(d=>d.VisitorDetailId==e.VisitorId),ha(r[0]),Va(i[0]),console.log(w),Me({...w,selectedVisitorId:e.VisitorId}),ee(e),{...e},hl(e),Y(!0)},we=e=>{if(e&&e.hasOwnProperty("type")&&e.stopPropagation(),e.target.id!="BACK"){const s=e.target.id;console.log(w),Me({...w,selectedType:+e.target.id});const a=kt.map(i=>({...i,active:i.type===+s}));se({}),ie({}),ht("VisitorTypeId",{},+e.target.id),Ma("VisitorTypeId",{},+e.target.id),yl(+e.target.id),+e.target.id==65&&Oe(!0),fl(a)}else(e.target.id="BACK")&&(Ye(!1),ee({}),Ee(qe))},$l=()=>{const e=U.map(i=>({...i,IsActive:!1}));q(e);const s=ve.map(i=>({...i,IsActive:!1}));De(s);const a=_e.map(i=>({...i,IsActive:!1}));We(a),we({target:{value:35,id:35}}),Oe(!1),c(!1),nt()},er=()=>{B(!1),nt(),js()},tr=()=>{Q(!1),Ze({})},ir=e=>{const s=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/;return e.TitleId==""||e.TitleId==null?T("Please Select Title."):e.FirstName==""||e.FirstName==null?T(`Please Enter ${e.VisitorTypeId==36?"Worker":"Visitor"} Name.`):e.MailId==""||e.MailId==null?T("Please enter Mail ID."):s.test(e.MailId)?e.MobileNo==""||e.MobileNo==null?T("Please Enter Mobile No."):e.MobileNo.length!=10?T("Please Enter Valid Mobile No."):!0:T("Please Enter Valid Mail ID.")},ar=e=>{var s;if(e.PlantId==""||e.PlantId==null)return T("Please Select Plant");if(!e.VisitedEmployeeId)return T("Please Select Person To Visit");if(!e.ValidFrom&&e.VisitorTypeId!=36)return T("Please Select Appointment Date");if(!e.ValidTo&&e.VisitorTypeId==36)return T("Please Select Valid To");if(!ut&&e.VisitorTypeId!=66){G(!1),(s=y.current)==null||s.show({severity:"warn",detail:"Please Capture Image",summary:"Warning Message"});return}return e.PurposeOfVisit==null||e.PurposeOfVisit==""?T("Please Select Purpose Of Visit"):!0},sr=()=>{ar(h.values)==!0&&(ce?ir(W.values)==!0&&W.handleSubmit():h.handleSubmit())};n.useEffect(()=>{ce&&$&&$.length>0&&(h.handleSubmit(),G(!1),c(!1))},[$]);const lr=()=>{nt(),Y(!1),c(!1)},ps=n.useRef(),Vs=n.useRef(),[hs,Wo]=n.useState(Rt.NO_IMG),[rr,Ro]=n.useState(""),[Si,fa]=n.useState(""),[Se,yt]=n.useState([]);n.useState(null),n.useState(null);const[or,ys]=n.useState(null),[ft,ga]=n.useState([]),[Da,Bo]=n.useState([]),[fs,Ia]=n.useState(!0),[gs,bi]=n.useState([]),[Ds,Ot]=n.useState([]);n.useState(!1);const Ut=n.useRef(),Wt=n.useRef(),Sa=n.useRef(),[Is,Ss]=n.useState(-1),[Ni,bs]=n.useState({global:{value:null,matchMode:_s.CONTAINS}}),[Ns,xs]=n.useState("");n.useEffect(()=>{vi()});const{isCreateVM:Cs,isViewVM:Ms,createEditDataVM:Go,loadingVM:nr,errorVM:Ho,tranStatusVM:Zo,VisitorHeaderVM:f,VisitorTypeListVM:Es,TitleListVM:vs,IdCardListVM:xi,StatusListVM:Ci,CountryListVM:Ls,StateListVM:Mi,CityListVM:Ei,DepartmentListVM:dr,VisitorDetailVM:gt,VisitorSearchListVM:Jo,WorkSeverityListVM:ba}=zs(e=>e.visitor),Ts=()=>{const e=s=>{const a=s.target.value;let i={...Ni};i.global.value=a,bs(i),xs(a)};return t.jsx("div",{className:"flex justify-content-between",children:t.jsxs("span",{className:"p-input-icon-left",children:[t.jsx("i",{className:"pi pi-search"}),t.jsx(Dt,{value:Ns,onChange:e,placeholder:"Keyword Search"})]})})};n.useEffect(()=>{var e,s;if(console.log(Ve,f,gt),!Ve&&f&&gt){Ve||(f&&f.VisitorTypeId==35?Ia(!0):Ia(!1));let a=[];for(let i=0;i<gt.length;i++){const r=gt[i];let d={};d.VisitorDetailId=r.VisitorDetailId,d.VisitorId=r.VisitorId,d.TitleId=r.TitleId,d.FirstName=r.FirstName,d.LastName=r.LastName,d.DepartmentId=r.DepartmentId,d.Dob=new Date(r.Dob),d.MailId=r.MailId,d.MobileNo=r.MobileNo,d.IdCardType=r.IdCardType,d.IdCardNo=r.IdCardNo,d.DocumentName=r.DocumentName,d.DocumentUrl=r.DocumentName,d.Status=r.Status,d.ExpirryDate=r.ExpirryDate,d.WorkSeverity=r.WorkSeverity,d.VisitorName=r.FirstName+" "+r.LastName,d.DepartMentName=r.DepartmentId?Le.find(g=>g.DepartmentId==r.DepartmentId).DepartmentName:null,d.IdCardTypeName=(e=xi.find(g=>g.MetaSubId==r.IdCardType))==null?void 0:e.MetaSubDescription,d.StatusName=Ci.find(g=>g.MetaSubId==r.Status).MetaSubDescription,d.WorkSeverityName=(s=ba.find(g=>g.MetaSubId==r.WorkSeverity))==null?void 0:s.MetaSubDescription;const V=new Date(r.Dob).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});d.ShowDate=V;const b=new Date(r.ExpirryDate).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});d.ShowExpirryDate=b,a.push(d),console.log(a)}console.log(gt),console.log(a),yt(a),fa(f.VisitorDocumentUrl)}else ws(0)},[Ve,f,gt]);const ws=e=>{var a=z($s({VisitorId:e}));a.then(i=>{var r;i.payload.tranStatus.result||(r=y.current)==null||r.show({severity:"error",summary:"Error",detail:i.payload.tranStatus.lstErrorItem.message})}).catch(i=>{var r;(r=y.current)==null||r.show({severity:"error",summary:"Error",detail:JSON.stringify(i)})})};n.useEffect(()=>{Ot(Ei),bi(Mi)},[Ei,Mi]);const Na={VisitorId:f!=null?f.VisitorId:0,VisitorCode:f!=null?f.VisitorCode:"",VisitorTypeId:f!=null?f.VisitorTypeId:35,CompanyId:f!=null?f.CompanyId:localStorage.CompanyId,PlantId:f!=null?f.PlantId:localStorage.PlantId,CountryId:f!=null?f.CountryId:null,StateId:f!=null?f.StateId:null,CityId:f!=null?f.CityId:null,TitleId:f!=null?f.TitleId:37,FirstName:f!=null?f.FirstName:"",LastName:f!=null?f.LastName:"",Dob:f!=null?new Date(f.Dob):new Date,VisitorCompany:f!=null?f.VisitorCompany:"",Address:f!=null?f.Address:"",MailId:f!=null?f.MailId:"",MobileNo:f!=null?f.MobileNo:"",IdCardType:f!=null?f.IdCardType:17,IdCardNo:f!=null?f.IdCardNo:"",DocumentName:f!=null?f.DocumentName:"",DocumentUrl:f!=null?f.DocumentUrl:"",VisitorDocumentName:f!=null?f.VisitorDocumentName:"",VisitorDocumentUrl:f!=null?f.VisitorDocumentUrl:"",Status:f!=null?f.Status:1,CreatedBy:f!=null?f.CreatedBy:+localStorage.UserId,CreatedOn:f!=null?new Date(f.CreatedOn):new Date,ModifiedBy:f!=null?+localStorage.UserId:null,ModifiedOn:f!=null?new Date:null},xa={VisitorDetailId:0,VisitorId:0,TitleId:37,FirstName:"",LastName:"",DepartmentId:null,Dob:new Date,MailId:"",MobileNo:"",IdCardType:17,IdCardNo:"",DocumentName:"",DocumentUrl:"",Status:1,ExpirryDate:new Date,WorkSeverity:96},W=Ta({initialValues:Na,validationSchema:ol,onSubmit:(e,{resetForm:s})=>{G(!0);const a=new FormData;let i=[];if(e.Dob=ue(new Date(e.Dob)),e.CreatedOn=ue(new Date(e.CreatedOn)),Ve||(e.ModifiedOn=ue(new Date(e.ModifiedOn))),(e.VisitorTypeId==35||e.VisitorTypeId==36)&&ce&&Ve){let p={};p.VisitorDetailId=0,p.VisitorId=0,p.TitleId=e.TitleId,p.FirstName=e.FirstName,p.LastName=e.LastName,p.DepartmentId=null,p.Dob=e.Dob,p.MailId=e.MailId,p.MobileNo=e.MobileNo,p.IdCardType=e.IdCardType,p.IdCardNo=e.IdCardNo,p.DocumentName=e.DocumentName,p.DocumentUrl=e.DocumentName,p.Status=e.Status,p.ExpirryDate=new Date,p.WorkSeverity=96,i.push(p)}else(e.VisitorTypeId==35||e.VisitorTypeId==36)&&(!ce||!Ve)?(Se.forEach(p=>{p.TitleId=e.TitleId,p.FirstName=e.FirstName,p.LastName=e.LastName,p.Dob=e.Dob,p.MailId=e.MailId,p.MobileNo=e.MobileNo,p.IdCardType=e.IdCardType,p.IdCardNo=e.IdCardNo}),i=Se,console.log(i)):(Se.forEach(p=>{delete p.VisitorName,delete p.DepartMentName,delete p.IdCardTypeName,delete p.StatusName,delete p.ShowExpirryDate,delete p.WorkSeverityName,p.Dob=ue(new Date(p.Dob)),p.ExpirryDate=ue(new Date(p.ExpirryDate))}),i=Se);console.log(i),i.length==0,a.append("webfile",ut),a.append("webfile1",or);for(var r in ft){var d=i.findIndex(p=>p.DocumentName==ft[r].name);d!=-1&&a.append("webfiles",ft[r])}for(var V in Da){var d=i.findIndex(v=>v.DocumentName==Da[r].name);d!=-1&&a.append("webfile1",Da[r])}let g=JSON.stringify({Visitor:e,VisitorDetail:i});if(a.append("input",g),Ve){var H=z(tl(a));H.then(v=>{var me,he,be,J,N;v.payload.tranStatus.result==!0?(G(!1),B(!1),Zs((be=(he=(me=v.payload)==null?void 0:me.VisitorHeader)==null?void 0:he.VisitorDetails[0])==null?void 0:be.VisitorDetailId,(J=v.payload)==null?void 0:J.VisitorList)):(G(!1),(N=y.current)==null||N.show({severity:"error",summary:"Error",detail:v.payload.tranStatus.lstErrorItem[0].Message}))}).catch(v=>{var me;G(!1),(me=y.current)==null||me.show({severity:"error",summary:"Error",detail:v})})}else{var H=z($r(a));H.then(p=>{var v,me,he,be,J;p.payload.tranStatus.result==!0?(G(!1),B(!1),At(0),Zs((me=(v=p.payload)==null?void 0:v.VisitorHeader)==null?void 0:me.VisitorId,(he=p.payload)==null?void 0:he.VisitorList),(be=y.current)==null||be.show({severity:"success",summary:"Success Message",detail:p.payload.tranStatus.lstErrorItem[0].Message}),Ft(!0)):(G(!1),(J=y.current)==null||J.show({severity:"error",summary:"Error Message",detail:p.payload.tranStatus.lstErrorItem[0].Message}))}).catch(p=>{var v;G(!1),(v=y.current)==null||v.show({severity:"error",summary:"Error",detail:JSON.stringify(p)})})}}}),E=Ta({initialValues:xa,validationSchema:so,onSubmit:(e,{resetForm:s})=>{var d,V,b;let a={};a.VisitorDetailId=e.VisitorDetailId,a.VisitorId=e.VisitorId,a.TitleId=e.TitleId,a.FirstName=e.FirstName.trim(),a.LastName=e.LastName.trim(),a.DepartmentId=e.DepartmentId,a.Dob=e.Dob,a.MailId=e.MailId,a.MobileNo=e.MobileNo,a.IdCardType=e.IdCardType,a.IdCardNo=e.IdCardNo,a.DocumentName=e.DocumentName||"",a.DocumentUrl=e.DocumentName||"",a.Status=e.Status,a.ExpirryDate=e.ExpirryDate,a.WorkSeverity=e.WorkSeverity,a.VisitorName=Ti.find(g=>g.MetaSubId==e.TitleId).MetaSubDescription+". "+a.FirstName+" "+a.LastName,a.DepartMentName=Le.find(g=>g.DepartmentId==e.DepartmentId).DepartmentName,a.IdCardTypeName=xi.find(g=>g.MetaSubId==e.IdCardType).MetaSubDescription,a.StatusName=Ci.find(g=>g.MetaSubId==e.Status).MetaSubDescription,a.WorkSeverityName=ba.find(g=>g.MetaSubId==e.WorkSeverity).MetaSubDescription;const i=e.Dob.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});a.ShowDate=i;const r=e.ExpirryDate.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});if(a.ShowExpirryDate=r,Is==-1){if((Se.filter(p=>p.VisitorName==a.VisitorName)||[]).length>0&&a.VisitorDetailId==0){(d=y.current)==null||d.show({severity:"warn",summary:"Warning Message",detail:"Worker Already Exists"});return}if((Se.filter(p=>p.MobileNo==a.MobileNo)||[]).length>0&&a.VisitorDetailId==0){(V=y.current)==null||V.show({severity:"warn",summary:"Warning Message",detail:"Mobile No Already Exists"});return}if(a.MailId!=""&&(Se.filter(v=>v.MailId==a.MailId)||[]).length>0&&a.VisitorDetailId==0){(b=y.current)==null||b.show({severity:"warn",summary:"Warning Message",detail:"Mail ID Already Exists"});return}yt([...Se,a])}else{let g=Se;g[Is]=a,yt(g),Ss(-1)}mt&&(ft.length>0?ga([...ft,mt]):ga([mt])),Ca()}}),js=()=>{W.resetForm(),E.resetForm(),ga([]),Ie(null),Ke(null),Ia(!0),yt([]),Xe(Rt.NO_IMG),pe(""),bi([]),Ot([])},Ps=e=>{Ie(null),E.setFieldValue("",e),E.setFieldValue("VisitorDetailId",e.data.VisitorDetailId),E.setFieldValue("VisitorId",e.data.VisitorId),E.setFieldValue("TitleId",e.data.TitleId),E.setFieldValue("FirstName",e.data.FirstName),E.setFieldValue("LastName",e.data.LastName),E.setFieldValue("DepartmentId",e.data.DepartmentId),E.setFieldValue("Dob",e.data.Dob),E.setFieldValue("MailId",e.data.MailId),E.setFieldValue("MobileNo",e.data.MobileNo),E.setFieldValue("IdCardType",e.data.IdCardType),E.setFieldValue("IdCardNo",e.data.IdCardNo),E.setFieldValue("DocumentName",e.data.DocumentName),E.setFieldValue("DocumentUrl",e.data.DocumentUrl),E.setFieldValue("Status",e.data.Status),E.setFieldValue("ExpirryDate",new Date(e.data.ExpirryDate)),E.setFieldValue("WorkSeverity",e.data.WorkSeverity);let s=ft[e.index];pe(e.data.DocumentUrl),Ie(s),Ss(e.index)},Fs=(e,s,a)=>{W.setFieldValue(e,a)},cr=e=>{W.setFieldValue(e.target.name,e.value)},ks=e=>{E.setFieldValue(e.target.name,e.value)},As=(e,s,a)=>{E.setFieldValue(e,a)},Os=(e,s,a)=>{W.setFieldValue(e??W[s][e],W,a)},Ca=()=>{E.resetForm(),Ie(null),pe("")},Ma=(e,s,a)=>{W.setFieldValue(e,a)},Ea=()=>{var e;Xe(Rt.NO_IMG),Ke(null),(e=Sa.current)==null||e.clear(),W.setFieldValue("DocumentName",""),W.setFieldValue("DocumentUrl","")},Us=(e,s,a)=>{bi([]),Ot([]),W.setFieldValue(e,a),W.setFieldValue("StateId",null);var r=z(eo({CountryId:a}));r.then(d=>{var V;d.payload.tranStatus.result?(bi(d.payload.StateList),d.payload.StateList&&d.payload.StateList.length&&d.payload.StateList.length>0&&va("StateId",{},d.payload.StateList[0].StateId)):(V=y.current)==null||V.show({severity:"error",summary:"Error",detail:d.payload.tranStatus.lstErrorItem.message})}).catch(d=>{var V;(V=y.current)==null||V.show({severity:"error",summary:"Error",detail:JSON.stringify(d)})})},va=(e,s,a)=>{Ot([]),W.setFieldValue(e,a),W.setFieldValue("CityId",null);var r=z(to({StateId:a}));r.then(d=>{var V;d.payload.tranStatus.result?(Ot(d.payload.CityList),d.payload.CityList&&d.payload.CityList.length&&d.payload.CityList.length>0&&ua("CityId",{},d.payload.CityList[0].CityId)):(V=y.current)==null||V.show({severity:"error",summary:"Error",detail:d.payload.tranStatus.lstErrorItem.message})}).catch(d=>{var V;(V=y.current)==null||V.show({severity:"error",summary:"Error",detail:JSON.stringify(d)})})},Ws=e=>{var s,a;if(Kt!=""&&Ea(),e.files[0].type!="image/jpeg"&&e.files[0].type!="image/png"&&e.files[0].type!="image/jpg"){(s=y.current)==null||s.show({severity:"warn",summary:"Error Message",detail:"Please Upload only Files with Format (Image/ JPEG, JPG, PNG)"});return}if(e.files.length>0){Ke(e.files[0]),W.setFieldValue("DocumentName",e.files[0].name),W.setFieldValue("DocumentUrl",e.files[0].name);const i=URL.createObjectURL(e.files[0]);Xe(i)}else{(a=y.current)==null||a.show({severity:"warn",summary:"Error Message",detail:"Please Upload only Files with Format (Image/ JPEG, JPG, PNG)"});return}},Rs=(e,s)=>{const a=e.name.slice((e.name.lastIndexOf(".")-1>>>0)+2).toLowerCase(),i=e.type.toLowerCase();return s.includes(a)||s.includes(i)},Bs=e=>{var a,i,r;Wt.current&&La();const s=["jpeg","jpg","png","pdf","doc","docx","xls","xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"];if(e.files&&!Rs(e.files[0],s)){(a=y.current)==null||a.show({severity:"warn",summary:"Error Message",detail:"Please Upload only Files with Format (Image/ JPEG, JPG, PNG & DOC/ WORD, EXCEL, PDF)"}),(i=Wt.current)==null||i.clear();return}if(e.files.length>0){ys(e.files[0]),W.setFieldValue("VisitorDocumentName",e.files[0].name);const d=URL.createObjectURL(e.files[0]);W.setFieldValue("VisitorDocumentUrl",e.files[0].name),fa(d)}else{(r=y.current)==null||r.show({severity:"warn",summary:"Error Message",detail:"Please Upload only Files with Format (Image/ JPEG, JPG, PNG & DOC/ WORD, EXCEL, PDF)"});return}},ur=e=>{var a,i,r;Ut.current&&pa();const s=["jpeg","jpg","png","pdf","doc","docx","xls","xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"];if(e.files&&!Rs(e.files[0],s)){(a=y.current)==null||a.show({severity:"warn",summary:"Error Message",detail:"Please Upload only Files with Format (Image/ JPEG, JPG, PNG & DOC/ WORD, EXCEL, PDF)"}),(i=Ut.current)==null||i.clear();return}if(e.files.length>0){Ie(e.files[0]),E.setFieldValue("DocumentName",e.files[0].name);const d=URL.createObjectURL(e.files[0]);E.setFieldValue("DocumentUrl",e.files[0].name),pe(d)}else{(r=y.current)==null||r.show({severity:"warn",summary:"Error Message",detail:"Please Upload only Files with Format (Image/ JPEG, JPG, PNG & DOC/ WORD, EXCEL, PDF)"});return}},mr=()=>{var e;(e=Ut.current)==null||e.clear(),pe(""),Ie(null),E.setFieldValue("DocumentName",""),E.setFieldValue("DocumentUrl","")},La=()=>{var e;(e=Wt.current)==null||e.clear(),fa(""),ys(null),W.setFieldValue("VisitorDocumentName",""),W.setFieldValue("VisitorDocumentUrl","")},pr=()=>{Te!=""&&window.open(Te,"_blank")},Gs=()=>{Si!=""&&window.open(Si,"_blank")},Hs=()=>t.jsxs("div",{className:"flex align-items-center flex-column",children:[t.jsx("i",{className:"pi pi-image mt-3 p-5",style:{fontSize:"5em",borderRadius:"50%",backgroundColor:"var(--surface-b)",color:"var(--surface-d)"}}),t.jsx("span",{style:{fontSize:"1.2em",color:"var(--text-color-secondary)"},className:"my-5",children:"Drag and Drop Image Here"})]}),Zs=(e,s)=>{q(s);let i=s.filter(r=>r.VisitorDetails.some(d=>d.VisitorDetailId===e)).map(r=>({...r,VisitorDetails:r.VisitorDetails.filter(d=>d.VisitorDetailId===e)})).flatMap(r=>r.VisitorDetails);Ii("VisitorId",{},i[0].VisitorDetailId,s)},[Vr,Js]=n.useState([]),[Qo,hr]=n.useState([]),[Qs,yr]=n.useState(new Date),[Ys,fr]=n.useState(new Date),gr=(e,s)=>{if(console.log(e,s),s.field==="Validity")return Ir(e)},Dr=(e,s)=>{console.log(e,s),hr([e.value[0],e.value[1]]),Js(a=>a.map(i=>s.WPWorkerDetailId===i.WPWorkerDetailId?{...i,ValidFrom:e.value[0],ValidTo:e.value[1]}:i)),st(a=>a.map(i=>s.WPWorkerDetailId===i.WPWorkerDetailId?{...i,ValidFrom:e.value[0],ValidTo:e.value[1]}:i))},Ir=(e,s)=>(console.log(Ys),console.log(Qs),t.jsx(io,{className:"w-full",onChange:a=>Dr(a,e),minDate:Ys,maxDate:Qs,name:"",value:e!=null&&e.ValidFrom||e!=null&&e.ValidTo?[e==null?void 0:e.ValidFrom,e==null?void 0:e.ValidTo]:null,disabled:!1,dateFormat:"dd/mm/yy",showIcon:!0,showTime:!0,hourFormat:"12",timeOnly:!1,selectionMode:"range",readOnlyInput:!0})),Sr=e=>{let{rowData:s,newValue:a,field:i,originalEvent:r}=e;switch(console.log(e),i){default:a&&a.length>0?s[i]=a:r.preventDefault();break}},br=e=>{const s=e.target.value;let a={...Ni};a.global.value=s,bs(a),xs(s)},Nr=(()=>t.jsx("div",{className:"flex justify-content-end",children:t.jsxs("span",{className:"p-input-icon-left",children:[t.jsx("i",{className:"pi pi-search"}),t.jsx(Dt,{value:Ns,onChange:br,placeholder:"Keyword Search"})]})}))(),[xr,qo]=n.useState({global:{value:null,matchMode:_s.CONTAINS}}),Cr=(e,s)=>t.jsx("div",{className:"action-btn",children:t.jsxs(Ks.Fragment,{children:[t.jsx(le,{label:"",title:"Edit",icon:"pi pi-pencil",className:"mr-2 p-1 p-button-success",disabled:na}),t.jsx(le,{label:"",severity:"danger",icon:"pi pi-trash",title:"Delete",className:"mr-2 p-1",disabled:na})]})}),Mr=e=>(console.log(e),t.jsx("div",{children:t.jsx("div",{children:e.WorkerDocs&&e.WorkerDocs.map(s=>t.jsx("div",{className:"mb-2",children:t.jsx("a",{className:"text-blue-600 underline",target:"_blank",href:s.FileBlobUrl,children:s.FileName})}))})})),Er=e=>{Js(e.payload.WorkPermitWorkerDetails)},vr=()=>{G(!0);const e=new FormData;let s=[],a={VisitorId:0,VisitorCode:"",VisitorTypeId:117,CompanyId:k!=null?k.CompanyId:localStorage.CompanyId,PlantId:k!=null?k.PlantId:localStorage.PlantId,CountryId:k!=null?k.CountryId:null,StateId:k!=null?k.StateId:null,CityId:k!=null?k.CityId:null,TitleId:k!=null?k.TitleId:37,FirstName:ae[0].WorkerName,LastName:"",Dob:it(new Date),VisitorCompany:"",Address:"",MailId:"",MobileNo:"",IdCardType:17,IdCardNo:"",DocumentName:"",DocumentUrl:"",VisitorDocumentName:"",VisitorDocumentUrl:"",Status:k!=null?k.Status:1,CreatedBy:k!=null?k.CreatedBy:+localStorage.UserId,CreatedOn:k!=null?new Date(k.CreatedOn):new Date,ModifiedBy:k!=null?+localStorage.UserId:null,ModifiedOn:k!=null?new Date:null};if(ae.length>0)for(let V=0;V<ae.length;V++){let b={};const g=ae[V];b.VisitorDetailId=0,b.VisitorId=0,b.TitleId=0,b.FirstName=g.WorkerName,b.LastName="",b.DepartmentId=null,b.Dob=null,b.MailId=g.WorkerMailID==null||g.WorkerMailID==null?"":g.WorkerMailID,b.MobileNo=g.WorkerPhoneNo,b.IdCardType=0,b.IdCardNo=0,b.DocumentName="",b.DocumentUrl="",b.Status=g.Status,b.ExpirryDate=null,b.WorkSeverity=null,s.push(b)}console.log(s),s.length==0,e.append("webfile",[]),e.append("webfile1",[]);let r=JSON.stringify({Visitor:a,VisitorDetail:s});e.append("input",r);var d=z(tl(e));d.then(V=>{var b,g,H;V.payload.tranStatus.result==!0?(G(!1),B(!1),Lr((g=(b=V.payload)==null?void 0:b.VisitorHeader)==null?void 0:g.VisitorId)):(G(!1),(H=y.current)==null||H.show({severity:"error",summary:"Error",detail:V.payload.tranStatus.lstErrorItem[0].Message}))}).catch(V=>{var b;G(!1),(b=y.current)==null||b.show({severity:"error",summary:"Error",detail:V})})},Lr=e=>{var g;let s=!1;if(Fe&&Fe.length>0&&(Fe.forEach(H=>{ae.forEach(p=>{if(new Date(H.ValidFrom)&&new Date(H.ValidTo)&&(p.ValidFrom||k.ValidFrom)&&(p.ValidTo||k.ValidTo)){const v=new Date(H.ValidFrom),me=new Date(H.ValidTo),he=p.ValidFrom?new Date(p.ValidFrom):new Date(k.ValidFrom),be=p.ValidTo?new Date(p.ValidTo):new Date(k.ValidTo);(v>=he&&v<=be||me>=he&&me<=be)&&(s=!0)}})}),s)){s=!1,G(!1),(g=y.current)==null||g.show({severity:"error",summary:"Error",detail:"Worker Already Working in this Date."});return}const a=new FormData;let i={};i.CompanyId=+localStorage.CompanyId,i.PlantId=+localStorage.PlantId,i.GateId=+localStorage.GateId,i.VisitorTypeId=117,i.VisitorId=e,i.PersonName=k.ContractorName,i.VisitedEmployeeId=k.WorkOrganizer,i.VisitorEntryDate=it(new Date),i.ValidFrom=k.ValidFrom,i.ValidTo=k.ValidTo,i.PoNumber=k.PoNo,i.PurposeOfVisit=118,i.RefNo=k.WorkPermitCode,i.CreatedBy=+localStorage.UserId,i.CreatedOn=it(new Date),i.ModifiedBy=null,i.ModifiedOn=null;let r=[];if(ae.length>0)for(let H=0;H<ae.length;H++){const p=ae[H];let v={};v.VisitorEntryDetailId=0,v.VisitorEntryId=0,v.VisitorEntryDetailCode=p.visitordetailCode??0,v.TitleId=null,v.FirstName=p.WorkerName,v.LastName="",v.DepartmentId=null,v.Dob=null,v.MailId=p.WorkerMailID==null||p.WorkerMailID==null?"":p.WorkerMailID,v.MobileNo=p.WorkerPhoneNo,v.IdCardType=null,v.IdCardNo="",v.DocumentName="",v.DocumentUrl="",v.Status=p.Status,v.ValidFrom=it(p.ValidFrom||k.ValidFrom),v.ValidTo=it(p.ValidTo||k.ValidTo),r.push(v)}let V=JSON.stringify({VisitorEntry:i,VisitorEntryDetail:r??[],VisitorEntryBelongingDetail:[],VisitorEntryMaterialDetail:[],VisitorEntryAtvDetail:[]});a.append("input",V),a.append("webfile",[]),a.append("webfile1",[]),a.append("webfiles",[]);var b=z(el(a));b.then(H=>{var p,v;H.payload.tranStatus.result==!0?(G(!1),(p=y.current)==null||p.show({severity:"success",summary:"Success Message",detail:H.payload.tranStatus.lstErrorItem[0].Message}),Q(!1),Ze({}),nt()):(we({target:{value:35,id:35}}),G(!1),(v=y.current)==null||v.show({severity:"error",summary:"Error",detail:H.payload.tranStatus.lstErrorItem[0].Message}))}).catch(H=>{var p;G(!1),we({target:{value:35,id:35}}),(p=y.current)==null||p.show({severity:"error",summary:"Error",detail:JSON.stringify(H)})})},Tr=()=>{console.log(ae),console.log(Fe),G(!0),vr()};return t.jsxs(t.Fragment,{children:[t.jsx("div",{children:t.jsx("div",{className:"page-container",children:t.jsxs("div",{className:"inner-page-container visitor-info",children:[t.jsxs("div",{className:"card flex justify-content-center",children:[t.jsx(Li,{visible:L,onHide:()=>$l(),className:"preview-container",fullScreen:!0,children:t.jsx(Io,{tabConfig:kt,isCreate:He,isView:na,loading:da,visitorEntryFormik:h,selectedData:w,setShowEntryDetail:Ye,setVisible:c,setVisitorNameList:q,VisitorNameList:U,visitorEntryDetailList:$,setvisitorEntryDetailList:oe,setVisitorEntryBelongingDetailList:et,setList:Fl,visitorEntryForm:!0,VisitorEntryValidationSchema:!0,onUpload:Gl,itemTemplate:ds,imageUrl:Kt,IsPreBookingList:wi,VisitorTypeList:ji,onChangeVisitorType:ht,handleSelect:ua,autoCompleteRef:_t,OnSelectVisitorCode:Ol,onChangeMatType:Bl,filteritemType:Fi,handleIsPreBook:Ul,VECodeDisable:Wi,EmployeeList:ve,onChangeVisitor:Ii,ProofList:Pi,ValidFromDisable:Ri,ValidToDisable:Bi,onChageFromDate:ma,TominDate:Gi,CheckboxDisable:Zi,onClickIsExistingVehicle:ss,HideVehicleDD:Ji,HideDriverDD:Yi,onUploadDocument:os,documentUrl:Te,onClickIsExistingDriver:rs,OnChangePartyTypes:is,PartyTypeList:ki,PartyNameList:Oi,AreaList:Ai,RouteList:Et,onClickIsAppointmentBooking:as,DriverList:Lt,VehicleList:_e,IsDeliveryChallan:zi,IsInvoiceBased:Xi,IsVehicleTripBased:Ki,IsPartyDisable:_i,IsVehicleDetailsDisable:$i,ShowVisitorContranctor:aa,IsMaterialDetailsShow:ea,InvoiceNumberDisable:la,DcNumberDisable:ra,PoNumberDisable:oa,ContainerNumberDisable:fi,StatusList:Mt,ChallanTypeList:Xa,OnChangeVehicle:ls,onChageToDate:Wl,deleteDocuments:pa,handleHyperlink:ns,cameraOff:Ue,setCameraOff:Ct,handleChange:$a,handleRouteSelect:Al,initFldDisable:dl,CreatePageOnLoadCVisitorEntry:kl,resetAllForm:nt,IsWorkerDetailsShow:ia,IsBelongingDetailsShow:ta,VisitorEntryBelongingDetailList:$e,VisitorEntryMaterialDetailList:tt,setVisitorEntryMaterialDetailList:Ge,MaterialList:sa,PurposeList:pl,IsdisableSave:pi,toast:y,handlePoVSelect:_a,checkedVehicle:m,setCheckedVehicle:S,vehicleDetails:A,setVisitorShow:B,fetchAllData:At,VisType:Za,isViewVM:Ms,isCreateVM:Cs,VisitorTypeListVM:Es,handleSelectVM:Fs,TitleListVM:vs,CountryListVM:Ls,OnchangecountryVM:Us,StateListVM:Mi,OnchangestateVM:va,CityListVM:Ei,IdCardListVM:xi,StatusListVM:Ci,onUploadVM:Ws,itemTemplateVM:Hs,imageUrlVM:hs,handleOnChangeVM:Os,visitorFormVM:Na,visitorRefVM:ps,visitorFormikVM:W,onChangeVisitorTypeVM:Ma,tempStateListVM:gs,tempCityListVM:Ds,handleCloseImageVM:Ea,handleChangeVM:cr,profUploadRefVM:Sa,VisitorhandleHyperlinkVM:Gs,onUploadDocumentVisitorVM:Bs,deleteDocumentsVisitorVM:La,documentUrlVisitorVM:Si,documentVisitorUploadRefVM:Wt,visitorDetailListVM:Se,filtersVM:Ni,TableHeaderVM:Ts,DepartmentListVM:dr,OnClearVM:Ca,visitorDetailFormVM:xa,visitorDetailRefVM:Vs,setVisitorDetailListVM:yt,documentUrlVM:rr,onUploadDocumentVM:ur,disableFormVM:fs,onRowSelectVM:Ps,toastVM:y,deleteDocumentsVM:mr,handleHyperlinkVM:pr,handleDChangeVM:ks,documentUploadRefVM:Ut,WorkSeverityListVM:ba,loadingVM:nr,handleDSelectVM:As,visitorDFormikVM:E,saveVisitor:sr,setCreateVisEnt:Ft,createVisEnt:Ve,isCurrentCreate:ce})}),t.jsx(Li,{visible:j,onHide:()=>er(),className:"preview-container",style:{width:"70vw",minWidth:"70vw",maxWidth:"70vw",height:"50vh",minHeight:"50vh",maxHeight:"50vh",top:"25%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:10},children:t.jsx(nl,{setVisitorShow:B,fetchAllData:At,visType:Za,isViewVM:Ms,isCreateVM:Cs,VisitorTypeListVM:Es,handleSelectVM:Fs,TitleListVM:vs,CountryListVM:Ls,StateListVM:Mi,CityListVM:Ei,IdCardListVM:xi,StatusListVM:Ci,onUploadVM:Ws,itemTemplateVM:Hs,imageUrlVM:hs,OnchangecountryVM:Us,OnchangestateVM:va,handleOnChangeVM:Os,visitorFormVM:Na,visitorRefVM:ps,visitorFormikVM:W,onChangeVisitorTypeVM:ht,tempStateListVM:gs,tempCityListVM:Ds,handleCloseImageVM:Ea,handleChangeVM:$a,profUploadRefVM:Sa,VisitorhandleHyperlinkVM:Gs,onUploadDocumentVisitorVM:Bs,deleteDocumentsVisitorVM:La,documentUrlVisitorVM:Si,documentVisitorUploadRefVM:Wt,visitorDetailListVM:Se,filtersVM:Ni,TableHeaderVM:Ts,DepartmentListVM:Le,OnClearVM:Ca,visitorDetailFormVM:xa,visitorDetailRefVM:Vs,setVisitorDetailListVM:yt,documentUrlVM:Te,onUploadDocumentVM:os,disableFormVM:fs,onRowSelectVM:Ps,toastVM:y,deleteDocumentsVM:pa,handleHyperlinkVM:ns,handleDChangeVM:ks,documentUploadRefVM:Ut,loadingVM:da,handleDSelectVM:As,visitorDFormikVM:E,createVisEnt:Ve})}),t.jsxs(Li,{visible:C,onHide:()=>tr(),className:"preview-container",style:{width:"70vw",minWidth:"70vw",maxWidth:"70vw",height:"50vh",minHeight:"50vh",maxHeight:"50vh",top:"25%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:10},children:[t.jsx(xo,{WPheader:Nr,WPfilters:xr,WPfilesContent:Mr,WPactionBodyTemplate:Cr,WPworkPermitWorkers:Vr,WPcellEditor:gr,WPonCellEditComplete:Sr}),t.jsxs("div",{className:"text-center mb-2",children:[t.jsx(le,{label:"Save",title:"Save",icon:"pi pi-save",className:"text-center",onClick:()=>Tr(),disabled:pi}),t.jsx(le,{label:"Cancel",severity:"danger",icon:"pi pi-trash",title:"Clear",className:"text-center"})]})]})]}),t.jsx(t.Fragment,{children:t.jsx("div",{className:"grid",children:t.jsx("div",{className:"col-12 preview-left",children:t.jsxs("div",{className:"form-container scroll-y",children:[t.jsx("div",{className:"normal-table visitor-table",children:t.jsx("table",{children:t.jsx("tbody",{children:t.jsxs("tr",{children:[t.jsx("td",{style:{width:"50%"},className:"text-right",children:"Pre-Appointment?"}),t.jsx("td",{children:t.jsx(rl,{checked:o,onChange:e=>l(e.value)})})]})})})}),!o&&t.jsx("div",{className:"flex justify-content-center flex-wrap visitor-type",children:kt&&kt.map(e=>t.jsx("div",{id:e.type,className:`${e.disable?"opacity-70 pointer-events-none":""}
                          ${e.active?"select white":"white"}`,onClick:we,children:t.jsxs("div",{id:e.type,style:{userSelect:"none"},children:[t.jsx("img",{id:e.type,src:e.visitorTypeImg,alt:e.visitorTypeTxt}),t.jsx("h5",{id:e.type,children:e.visitorTypeTxt})]})},e.id))}),rt?t.jsx(t.Fragment,{}):t.jsxs("div",{className:"appointment-container",children:[t.jsx(Vo,{checked:o,selectedData:w,setVisible:c,VisitorNameList:U,VisitorEmployeeList:ve,VisitorEntryBooked:Nt,VehicleList:_e,handleSearchAction:Yl,setSelectedVisitor:se,setSelectedHost:ie,selectedHost:de,handleEmployeeSelect:Va,handleVisitorSelect:ha,handleBookedVisitor:ya,handleVehicleSelect:Xl,isIndCon:bt,visitorShow:j,setVisitorShow:B,setVehicleShow:F,setEmployeeShow:_,toast:y,editData:jl,searchTerm:K,handleSelectedPop:Ql,handleEditData:wl,handleWorkPermitSelect:zl,WorkPermitList:Ui}),t.jsx(co,{dialogVisible:X,setDialogVisible:Y,setVisible:c,contWorker:cl,handlePassPreview:ya,passData:Vl,selectedHost:de,selectedVisitor:ke,tabConfig:kt,itemTemplate:ds,toast:y,handleClosePassPrev:lr})]})]})})})})]})})}),da?t.jsx(Wa,{}):null,t.jsx(Jr,{toast:y})]})};export{Co as CVisitorInfo,Mo as CVistorDetail,nn as default};
