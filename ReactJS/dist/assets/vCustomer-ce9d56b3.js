import{r,a as R,u as W,b as m,b$ as E,c0 as g,j as o,C as L,d as V,c1 as v,g as B,c2 as F}from"./index-25a41ef1.js";import{P as k,A as U}from"./PageHeader-b76b68bd.js";import{p as J}from"./PermissionService-9ad252b6.js";import{e as x}from"./ExportService-4b3a6c99.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const ee=()=>{const[A,I]=r.useState(null),w=R(),c=r.useRef(null),d=W(),j=m(e=>e.customer.loading);m(e=>e.customer.reload);const[t,H]=r.useState(),[l,p]=r.useState([]),y=m(e=>e.customer.HdrTable),M=m(e=>e.customer.createEditData),h=m(e=>e.customer.CustomerList),[O,S]=r.useState(!1),[$,N]=r.useState(null);r.useEffect(()=>{b()},[]),r.useEffect(()=>{H(J({screenId:23}))},[]);const b=()=>{const e={CustomerId:0,Taskname:"SEARCHINITIALIZE",CompanyId:+localStorage.CompanyId};return d(E(e))};r.useEffect(()=>{I(h)},[h]),r.useEffect(()=>{y!=null&&O&&w.push("/home/cCustomer")},[y]),r.useEffect(()=>{t!=null&&t._View&&l.filter(e=>e.name=="view").length==0&&p([...l,{title:"View",name:"view",disabled:!1}]),t!=null&&t._Update&&l.filter(e=>e.name=="edit").length==0&&p([...l,{title:"Edit",name:"edit",disabled:!1}]),t!=null&&t._Delete&&l.filter(e=>e.name=="delete").length==0&&p([...l,{title:"Delete",name:"delete",disabled:!1}]),t!=null&&t._View&&(t!=null&&t._Update)&&(t!=null&&t._Delete)&&C({...u,tableAction:!0})},[t,l]),r.useEffect(()=>{t!=null&&t._Add&&!u.pageHeader.pageActions[0].create&&C(e=>{const i={...e.pageHeader,pageActions:e.pageHeader.pageActions.map(n=>({...n,create:!!(t!=null&&t._Add)}))};return{...e,pageHeader:i}})},[t]),r.useEffect(()=>{C({...u,tableActions:l})},[l]);const[u,C]=r.useState({pageTitle:"Customer",pageHeader:{pageActions:[{create:!1,clear:!1,save:!1,createQuery:"/home/cCustomer",createDispatch:()=>d(g({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{textAlign:"center"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:l,tableColumns:[{title:"Customer Name",name:"CustomerName",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Company Name",name:"CompanyName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Country Name",name:"CountryName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"State Name",name:"StateName",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"City Name",name:"CityName",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Created By",name:"CreatedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created On",name:"CreatedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified By",name:"ModifiedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified On",name:"ModifiedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Status",name:"StatusName",sort:!0,avatar:!1,badge:!0,colStyle:{minWidth:"2rem",textAlign:"center"}}],tableExport:e=>{b().then(n=>{_(n.payload.CustomerList).then(a=>{e==="pdf"?x.Export("Customer",a,"pdf"):e==="excel"&&x.Export("Customer",a,"excel")}).catch(a=>{console.error(a.message)})})}}),_=e=>new Promise((i,n)=>{let a=[];e.length>0?(e.forEach(s=>{let f={"Customer Name":s.CustomerName,"Company Name":s.CompanyName,"Country Name":s.CountryName,"State Name":s.StateName,"City Name":s.CityName,Status:s.StatusName};a.push(f)}),i(a)):n(new Error("No data available for export."))}),D={view:e=>{N(null);const i={CustomerId:e.data.CustomerId};d(v(i)),d(g(e)),S(!0)},edit:e=>{N(null);const i={CustomerId:e.data.CustomerId};d(v(i)),d(g(e)),S(!0)},delete:e=>{B(`Are you sure you want to inactive this Customer (${e.data.CustomerName}) ?`,"Confirmation",()=>{let i={CustomerId:e.data.CustomerId};d(F(i)).then(a=>{var s,f;a.payload.transtatus.result==!0?((s=c.current)==null||s.show({severity:"success",summary:"Success Message",detail:a.payload.transtatus.lstErrorItem[0].Message}),d(E({CustomerId:0}))):a.payload.transtatus.result==!1&&((f=c.current)==null||f.show({severity:"error",summary:"Error Message",detail:a.payload.transtatus.lstErrorItem[0].Message}))}).catch(a=>{var s;(s=c.current)==null||s.show({severity:"error",summary:"Error Message",detail:JSON.stringify(a)})})},()=>{})},print:e=>{T()}},T=()=>{localStorage.setItem("dataForPrint",JSON.stringify(M)),window.open("/home/print","_blank")};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"page-container",children:o.jsxs("div",{className:"inner-page-container",children:[o.jsx(k,{pageTitle:u.pageTitle,pageConfig:u}),o.jsx("div",{className:"form-container scroll-y",children:o.jsx("div",{className:"white",children:o.jsx("div",{className:"widget-body",children:o.jsx("div",{className:"card",children:o.jsx(U,{handleActions:D,data:A,loading:j,pageConfig:u,screenPermissions:t})})})})})]})}),o.jsx(L,{}),o.jsx(V,{toast:c})]})};export{ee as default};
