import{r as n,a as w,u as T,b as g,p as M,aQ as p,aR as V,j as r,aK as L,C as I,d as A,aS as S,g as O,aT as W}from"./index-25a41ef1.js";import{P as D,A as F}from"./PageHeader-b76b68bd.js";import{e as b}from"./ExportService-4b3a6c99.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const ie=()=>{n.useState(null);const y=w(),i=n.useRef(null),o=T();g(e=>e.visitor.VisitorList);const[c,h]=n.useState(97),{isCreate:B,isView:P,createEditData:R,loading:v,error:f,tranStatus:H,VisitorHeader:J,VisitorTypeList:Q,TitleList:$,IdCardList:k,StatusList:K,CountryList:q,StateList:z,CityList:G,DepartmentList:U,VisitorDetail:X,VisitorSearchList:x,VisitorTypeSearchList:C}=g(e=>e.visitor);n.useEffect(()=>{M()}),n.useEffect(()=>{m()},[]);const[u,Y]=n.useState({pageTitle:"Visitor",pageHeader:{pageActions:[{create:!0,clear:!1,save:!1,createQuery:"/home/cVisitor",createDispatch:()=>o(p({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{maxWidth:"12rem",textAlign:"center",justifySelf:"center"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:[{title:"View",name:"view"},{title:"Edit",name:"edit"},{title:"Delete",name:"delete"}],tableColumns:[{title:"Visitor Code",name:"VisitorCode",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Visitor Name",name:"VisitorName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"16rem"}},{title:"Visitor Type",name:"VisitorTypeName",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Visitor Company",name:"VisitorCompany",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Mobile No",name:"MobileNo",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Created By",name:"CreatedbyName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created On",name:"CreatedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified By",name:"ModifiedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified On",name:"ModifiedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Status",name:"StatusName",sort:!0,avatar:!1,badge:!0,colStyle:{minWidth:"2rem",textAlign:"center"}}],tableExport:e=>{m().then(l=>{N(l.payload.VisitorSearchList).then(a=>{e==="pdf"?b.Export("Visitor",a,"pdf"):e==="excel"&&b.Export("Visitor",a,"excel")}).catch(a=>{console.error(a.message)})})}}),N=e=>new Promise((s,l)=>{let a=[];e.length>0?(e.forEach(t=>{let d={"Visitor Code":t.VisitorCode,"Visitor Name":t.VisitorName,"Visitor Type":t.VisitorTypeName,"Visitor Company":t.VisitorCompany,"Mobile No":t.MobileNo,"Created By":t.CreatedbyName,Status:t.StatusName};a.push(d)}),s(a)):l(new Error("No data available for export."))}),m=()=>o(V({SearchType:c})),E={view:e=>{const s={VisitorId:e.data.VisitorId};o(S(s)).then(a=>{var t;a.payload.tranStatus.result==!0?y.push("/home/cVisitor"):(t=i.current)==null||t.show({severity:"error",detail:"Error",summary:a.payload.tranStatus.lstErrorItem[0].Message})}).catch(a=>{var t;(t=i.current)==null||t.show({severity:"error",detail:"Error",summary:JSON.stringify(f)})}),o(p(e))},edit:e=>{const s={VisitorId:e.data.VisitorId};o(S(s)).then(a=>{var t;a.payload.tranStatus.result==!0?y.push("/home/cVisitor"):(t=i.current)==null||t.show({severity:"error",detail:"Error",summary:a.payload.tranStatus.lstErrorItem[0].Message})}).catch(a=>{var t;(t=i.current)==null||t.show({severity:"error",detail:"Error",summary:JSON.stringify(f)})}),o(p(e))},delete:e=>{O(`Are you sure you want to inactive this Visitor (${e.data.VisitorName} - ${e.data.VisitorCode}) ?`,"Confirmation",()=>{const s={VisitorId:e.data.VisitorId};var l=o(W(s));l.then(a=>{var t,d;a.payload.tranStatus.result==!0?((t=i.current)==null||t.show({severity:"success",detail:"Inactivated Successfully.",summary:"Success Message"}),m()):(d=i.current)==null||d.show({severity:"error",detail:"Error",summary:a.payload.tranStatus.lstErrorItem[0].Message})}).catch(a=>{var t;(t=i.current)==null||t.show({severity:"error",detail:"Error",summary:JSON.stringify(a)})})},()=>{})}},j=e=>{h(e.target.value);const s={SearchType:e.target.value};return o(V(s))};return n.useEffect(()=>{h(c)},[c]),r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"page-container",children:r.jsxs("div",{className:"inner-page-container",children:[r.jsx(D,{pageTitle:u.pageTitle,pageConfig:u}),r.jsx("div",{className:"form-container scroll-y",children:r.jsx("div",{className:"white",children:r.jsx("div",{className:"widget-body",children:r.jsxs("div",{className:"card",children:[r.jsx("label",{className:"form-label",children:"Visitor Type  :"}),r.jsx(L,{value:c,options:C,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",name:"MetaSubDescription",filter:!0,onChange:e=>j(e),style:{width:"200px",marginBottom:"20px",marginLeft:"20px"}}),r.jsx(F,{handleActions:E,data:x,loading:v,pageConfig:u})]})})})})]})}),r.jsx(I,{}),r.jsx(A,{toast:i})]})};export{ie as default};
