import{r,p as B,a9 as q,b as z,u as H,c as U,aa as _,ab as J,j as e,F as K,B as F,n as M,A as Q,d as X,I as Y,ac as Z}from"./index-25a41ef1.js";import{d as $}from"./Master-b11b8a2f.js";import{D as ee,C as S}from"./column.esm-11a46c7b.js";import"./index.esm-21a4a4d3.js";import"./index.esm-9a713e1a.js";const de=()=>{const[v,f]=r.useState([]),[x,p]=r.useState([]),[w,u]=r.useState([]),[C,te]=r.useState(),[I,A]=r.useState([]);r.useEffect(()=>{B()});const[b,V]=r.useState({global:{value:null,matchMode:q.CONTAINS}}),[P,L]=r.useState(""),D=()=>{const l=n=>{const a=n.target.value;let t={...b};t.global.value=a,V(t),L(a)};return e.jsx("div",{className:"flex justify-content-between",children:e.jsxs("span",{className:"p-input-icon-left",children:[e.jsx("i",{className:"pi pi-search"}),e.jsx(Y,{value:P,onChange:l,placeholder:"Search"})]})})},{ModuleList:N,RoleMasterList:E,RolewiseScreenMappingViewList:m,AllScreens:k,isCreate:ae,FunctionRoleMapList:le,createEditData:c,isView:j,loading:y}=z(l=>l.roleWiseScreen),d=r.useRef(null),h=H(),W=()=>{u([]),s.resetForm()},R=l=>{f(l),p([]);let n=[];for(let a=0;a<l.length;a++){let t={};const i=l[a];t.FunctionRoleMapId=0,t.RoleId=s.values.RoleName,t.FunctionId=i.ScreenId,t.CompanyId=+localStorage.CompanyId,t.PlantId=+localStorage.PlantId,t.Status=1,t.CreatedBy=+localStorage.UserId,t.CreatedOn=new Date,t.ModifiedBy=+localStorage.UserId,t.ModifiedOn=new Date,n.push(t)}p(n)},s=U({initialValues:{RoleName:c!=null?c.RoleName:null,ModuleName:c!=null?c.ModuleName:null,ScreenName:c!=null?c.ScreenName:null},validationSchema:$,onSubmit:()=>{var a;if(x.length==0){(a=d.current)==null||a.show({severity:"warn",summary:"Validation Error",detail:"Please select at least one screen in the grid."});return}h(_({FunctionRoleMap:x})).then(t=>{var i,o;t.payload.transtatus.result==!0?((i=d.current)==null||i.show({severity:"success",summary:"Success Message",detail:t.payload.transtatus.lstErrorItem[0].Message}),T()):(o=d.current)==null||o.show({severity:"error",summary:"Error Message",detail:t.payload.transtatus.lstErrorItem[0].Message})}).catch(t=>{var i;(i=d.current)==null||i.show({severity:"warn",summary:"Error Message",detail:JSON.stringify(t.payload)})})}}),T=()=>{s.resetForm(),p([]),u([])},O=(l,n,a)=>{s.setFieldValue(l,a),h(Z({RoleId:a})).then(o=>{u(o.payload.AllScreens),o.payload.RolewiseScreenMappingViewList,s.setFieldValue("ModuleName",null)},o=>{})};r.useEffect(()=>{f(m)},[m]);const G=(l,n,a)=>{s.setFieldValue("Module",a),s.setFieldValue(l,a);let t=k.filter(i=>a.some(o=>o==i.ModuleId));u(t)};r.useEffect(()=>{h(J({RoleId:0,Taskname:"CreateInitialize"}))},[]),r.useEffect(()=>{A(N),R(m)},[N,m]);const[g,se]=r.useState({pageTitle:"Role Wise Screen Mapping",pageHeader:{pageActions:[{create:!1,clear:!0,save:!0,createQuery:" "}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{maxWidth:"4.5rem",textAlign:"center",justifySelf:"center"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:[{title:"View",name:"view"},{title:"Edit",name:"edit"},{title:"Delete",name:"delete"}],tableColumns:[{title:"Role Name",name:"RoleName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"16rem"}},{title:"Module Name",name:"ModuleName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Screen Name",name:"ScreenName",sort:!0,avatar:!1,badge:!1,colStyle:{}}]});return e.jsxs(e.Fragment,{children:[e.jsx(K,{initialValues:s.initialValues,validationSchema:s.validationSchema,onSubmit:s.handleSubmit,children:e.jsx("div",{className:"page-container",children:e.jsxs("div",{className:"inner-page-container",children:[e.jsx("div",{className:"page-title",children:e.jsxs("div",{className:"grid grid-nogutter",children:[e.jsx("div",{className:"md:col-6",children:e.jsx("h1",{children:"Role Wise Screen Mapping"})}),e.jsx("div",{className:"md:col-6 text-right",children:e.jsx("div",{className:"action-btn",children:e.jsxs(e.Fragment,{children:[e.jsx(F,{label:"",title:"Save",icon:"pi pi-save",className:"text-center",onClick:()=>s.handleSubmit()}),e.jsx(F,{label:"",severity:"danger",icon:"pi pi-trash",title:"Clear",className:"text-center",onClick:()=>W()})]})})})]})}),e.jsx("div",{className:"form-container scroll-y",children:e.jsx("div",{className:"white",children:e.jsxs("div",{className:"widget-body",children:[e.jsx("form",{children:e.jsx("div",{className:"normal-table",children:e.jsxs("div",{className:"grid",children:[e.jsx(M,{type:"select",name:"RoleName",label:"Role Name",options:E,show:!0,required:!0,disable:!!j,optionLabel:"RoleName",optionValue:"RoleId",handleSelect:O,fldStyle:"col-12 md:col-3",formik:s}),e.jsx(M,{type:"multi_select",name:"ModuleName",label:"Module Name",options:I,show:!0,required:!0,disable:!!j,optionLabel:"FunctionName",optionValue:"FunctionId",handleSelect:G,fldStyle:"col-12 md:col-3",formik:s,maxSelectedLabels:3})]})})}),e.jsx("div",{className:"card",children:y?e.jsx(Q,{}):e.jsxs(ee,{value:w,showGridlines:!0,filters:b,loading:y,selection:v,emptyMessage:"No Data Found",style:{minWidth:"50rem",textAlign:"center"},onSelectionChange:l=>{R(l.value)},dataKey:"ScreenName",paginator:g.tablePagination,rows:g.tableRows,rowsPerPageOptions:g.tableRowsOptions,currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Entries",paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",globalFilter:C,header:D,children:[e.jsx(S,{selectionMode:"multiple",headerStyle:{width:"5rem",textAlign:"center"},bodyStyle:{textAlign:"center"}}),e.jsx(S,{field:"ModuleName",header:"Module Name",sortable:!0}),e.jsx(S,{field:"ScreenName",header:"Screen Name",sortable:!0})]})})]})})})]})})}),e.jsx(X,{toast:d})]})};export{de as default};
