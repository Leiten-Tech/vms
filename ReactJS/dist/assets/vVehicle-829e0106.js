import{r,a as C,u as T,b as V,p as M,cf as j,cg as g,j as i,C as w,d as F,ch as S,g as O,ci as W}from"./index-25a41ef1.js";import{P as D,A as H}from"./PageHeader-b76b68bd.js";import{p as L}from"./PermissionService-9ad252b6.js";import{e as v}from"./ExportService-4b3a6c99.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const q=()=>{r.useState(null);const y=C(),o=T(),b=V(e=>e.vehicle.loading),E=V(e=>e.vehicle.VehicleList),[R,N]=r.useState(!1),[t,I]=r.useState(),[s,f]=r.useState([]);r.useState([]);const h=r.useRef(null);r.useEffect(()=>{M()}),r.useEffect(()=>{I(L({screenId:7}))},[]),r.useEffect(()=>{m()},[]);const m=()=>{const e={VehicleId:0,Taskname:"SEARCHINITIALIZE",CompanyId:+localStorage.CompanyId};return o(j(e))};r.useEffect(()=>{t!=null&&t._View&&s.filter(e=>e.name=="view").length==0&&f([...s,{title:"View",name:"view",disabled:!1}]),t!=null&&t._Update&&s.filter(e=>e.name=="edit").length==0&&f([...s,{title:"Edit",name:"edit",disabled:!1}]),t!=null&&t._Delete&&s.filter(e=>e.name=="delete").length==0&&f([...s,{title:"Delete",name:"delete",disabled:!1}]),t!=null&&t._View&&(t!=null&&t._Update)&&(t!=null&&t._Delete)&&p({...n,tableAction:!0})},[t,s]),r.useEffect(()=>{t!=null&&t._Add&&!n.pageHeader.pageActions[0].create&&p(e=>{const c={...e.pageHeader,pageActions:e.pageHeader.pageActions.map(d=>({...d,create:!!(t!=null&&t._Add)}))};return{...e,pageHeader:c}})},[t]),r.useEffect(()=>{p({...n,tableActions:s})},[s]);const[n,p]=r.useState({pageTitle:"Vehicle",pageHeader:{pageActions:[{create:!1,clear:!1,save:!1,createQuery:"/home/cVehicle",createDispatch:()=>o(g({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{textAlign:"center",minWidth:"10rem"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:s,tableColumns:[{title:"Vehicle Code",name:"VehicleCode",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Vehicle Name",name:"VehicleName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Vehicle No",name:"VehicleNo",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Vehicle Type",name:"VehicleTypeName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Last Vehicle Fc Date",name:"VehicleFcDate",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Last Service Date",name:"ServiceDate",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created By",name:"CreatedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created On",name:"CreatedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified By",name:"ModifiedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified On",name:"ModifiedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Status",name:"StatusName",sort:!0,avatar:!1,badge:!0,colStyle:{minWidth:"2rem"}}],tableExport:e=>{m().then(d=>{A(d.payload.VehicleList).then(a=>{e==="pdf"?v.Export("Vehicle",a,"pdf"):e==="excel"&&v.Export("Vehicle",a,"excel")}).catch(a=>{console.error(a.message)})})}}),A=e=>new Promise((c,d)=>{let a=[];e.length>0?(e.forEach(l=>{let u={"Vehicle Code":l.VehicleCode,"Vehicle Name":l.VehicleName,"Vehicle No":l.VehicleNo,"Vehicle Type":l.VehicleTypeName,"Last Vehicle Fc Date":l.VehicleFcDate,"Last Service Date":l.ServiceDate,"Created By":l.CreatedByName,"Created On":l.CreatedOn,"Modified By":l.ModifiedByName,"Modified On":l.ModifiedOn,Status:l.StatusName};a.push(u)}),c(a)):d(new Error("No data available for export."))}),x={view:e=>{const c={VehicleId:e.data.VehicleId,Taskname:"CREATEINITIALIZE"};o(S(c)).then(a=>{a.payload.transtatus.result==!0&&y.push("/home/cVehicle")}).catch(a=>{}),o(g(e)),N(!0)},edit:e=>{var a;const c={VehicleId:e.data.VehicleId,Taskname:"CREATEINITIALIZE"};if(o(S(c)).then(l=>{l.payload.transtatus.result==!0&&y.push("/home/cVehicle")}).catch(l=>{}),o(g(e)),console.log(e),e.VehicleType===29&&!e.SupplierId){(a=h.current)==null||a.show({severity:"error",summary:"Error Message",detail:"Please Select Supplier Name"});return}},delete:e=>{O(`Are you sure you want to inactive this ${e.data.VehicleName}?`,"Confirmation",()=>{let c={VehicleId:e.data.VehicleId};o(W(c)).then(a=>{var l,u;a.payload.transtatus.result==!0?((l=h.current)==null||l.show({severity:"success",summary:"Success Message",detail:a.payload.transtatus.lstErrorItem[0].Message}),m()):a.payload.transtatus.result==!1&&((u=h.current)==null||u.show({severity:"error",summary:"Error Message",detail:a.payload.transtatus.lstErrorItem[0].Message}))}).catch(a=>{var l;(l=h.current)==null||l.show({severity:"error",summary:"Error Message",detail:JSON.stringify(a)})})},()=>{})}};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"page-container",children:i.jsxs("div",{className:"inner-page-container",children:[i.jsx(D,{pageTitle:n.pageTitle,pageConfig:n}),i.jsx("div",{className:"form-container scroll-y",children:i.jsx("div",{className:"white",children:i.jsx("div",{className:"widget-body",children:i.jsx("div",{className:"card",children:i.jsx(H,{handleActions:x,data:E,loading:b,pageConfig:n,screenPermissions:t})})})})})]})}),i.jsx(w,{}),i.jsx(F,{toast:h})]})};export{q as default};
