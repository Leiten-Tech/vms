import{r as l,a as w,u as j,b as G,p as T,aq as W,ar as g,j as s,C as F,d as H,as as S,g as M,at as R}from"./index-25a41ef1.js";import{P as _,A as O}from"./PageHeader-b76b68bd.js";import{p as D}from"./PermissionService-9ad252b6.js";import{e as I}from"./ExportService-4b3a6c99.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const Q=()=>{const[b,E]=l.useState(null),y=w(),n=j(),[t,v]=l.useState(),[d,f]=l.useState([]),A=G(e=>e.gate.loading),N=G(e=>e.gate.GateList);l.useState(!1);const m=l.useRef(null);l.useEffect(()=>{T()}),l.useEffect(()=>{v(D({screenId:19}))},[]),l.useEffect(()=>{p()},[]);const p=()=>{const e={GateId:0,Taskname:"SEARCHINITIALIZE",CompanyId:+localStorage.CompanyId};return n(W(e))};l.useEffect(()=>{E(N)},[N]),l.useEffect(()=>{t!=null&&t._View&&d.filter(e=>e.name=="view").length==0&&f([...d,{title:"View",name:"view",disabled:!1}]),t!=null&&t._Update&&d.filter(e=>e.name=="edit").length==0&&f([...d,{title:"Edit",name:"edit",disabled:!1}]),t!=null&&t._Delete&&d.filter(e=>e.name=="delete").length==0&&f([...d,{title:"Delete",name:"delete",disabled:!1}]),t!=null&&t._View&&(t!=null&&t._Update)&&(t!=null&&t._Delete)&&h({...c,tableAction:!0})},[t,d]),l.useEffect(()=>{t!=null&&t._Add&&!c.pageHeader.pageActions[0].create&&h(e=>{const o={...e.pageHeader,pageActions:e.pageHeader.pageActions.map(i=>({...i,create:!!(t!=null&&t._Add)}))};return{...e,pageHeader:o}})},[t]),l.useEffect(()=>{h({...c,tableActions:d})},[d]);const[c,h]=l.useState({pageTitle:"Gate",pageHeader:{pageActions:[{create:!1,clear:!1,save:!1,createQuery:"/home/cGate",createDispatch:()=>n(g({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{textAlign:"center",minWidth:"10rem"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:d,tableColumns:[{title:"Gate Code",name:"GateCode",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Gate Name",name:"GateName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Gate No",name:"GateNo",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Incharge Name",name:"FirstName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Company Name",name:"CompanyName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Plant Name",name:"PlantName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created By",name:"CreatedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created On",name:"CreatedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified By",name:"ModifiedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified On",name:"ModifiedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Status",name:"StatusName",sort:!0,avatar:!1,badge:!0,colStyle:{minWidth:"2rem",textAlign:"center"}}],tableExport:e=>{p().then(i=>{x(i.payload.GateList).then(a=>{e==="pdf"?I.Export("Gate",a,"pdf"):e==="excel"&&I.Export("Gate",a,"excel")}).catch(a=>{console.error(a.message)})})}}),x=e=>new Promise((o,i)=>{let a=[];e.length>0?(e.forEach(r=>{let u={"Gate Code":r.GateCode,"Gate Name":r.GateName,"Gate No":r.GateNo,"Incharge Name":r.FirstName,"Company Name":r.CompanyName,"Plant Name":r.PlantName,Status:r.StatusName};a.push(u)}),o(a)):i(new Error("No data available for export."))}),C={view:e=>{const o={GateId:e.data.GateId,Taskname:"CREATEINITIALIZE",PlantId:localStorage.PlantId};n(S(o)).then(a=>{a.payload.transtatus.result==!0&&y.push("/home/cGate")}).catch(a=>{}),n(g(e))},edit:e=>{const o={GateId:e.data.GateId,Taskname:"CREATEINITIALIZE",PlantId:localStorage.PlantId};n(S(o)).then(a=>{a.payload.transtatus.result==!0&&y.push("/home/cGate")}).catch(a=>{}),n(g(e))},delete:e=>{M(`Are you sure you want to inactive this ${e.data.GateName}?`,"Confirmation",()=>{let o={GateId:e.data.GateId};n(R(o)).then(a=>{var r,u;a.payload.transtatus.result==!0?((r=m.current)==null||r.show({severity:"success",summary:"Success Message",detail:a.payload.transtatus.lstErrorItem[0].Message}),p()):a.payload.transtatus.result==!1&&((u=m.current)==null||u.show({severity:"error",summary:"Error Message",detail:a.payload.transtatus.lstErrorItem[0].Message}))}).catch(a=>{var r;(r=m.current)==null||r.show({severity:"error",summary:"Error Message",detail:JSON.stringify(a)})})},()=>{})}};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"page-container",children:s.jsxs("div",{className:"inner-page-container",children:[s.jsx(_,{pageTitle:c.pageTitle,pageConfig:c}),s.jsx("div",{className:"form-container scroll-y",children:s.jsx("div",{className:"white",children:s.jsx("div",{className:"widget-body",children:s.jsx("div",{className:"card",children:s.jsx(O,{handleActions:C,data:b,loading:A,pageConfig:c,screenPermissions:t})})})})})]})}),s.jsx(F,{}),s.jsx(H,{toast:m})]})};export{Q as default};
