import{am as Te,r,an as Re,bu as Se,ap as Be,ao as ae,bj as He,j as e,d9 as Fe,u as _e,L as Ue,a as Me,a9 as We,p as Ge,dc as Ze,cu as $e,B as re,dd as se,d as ze,I as Je,de as Ke}from"./index-25a41ef1.js";import{D as Ye,C as qe}from"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";var W=Te.extend({defaultProps:{__TYPE:"Chart",id:null,type:null,data:null,options:null,plugins:null,width:null,height:null,style:null,className:null,children:void 0}}),le=function(){try{return Chart}catch{return null}}(),G=r.memo(r.forwardRef(function(j,y){var A=r.useContext(Re),l=W.getProps(j,A),P=W.setMetaData({props:l}),h=P.ptm,D=r.useRef(null),g=r.useRef(null),x=r.useRef(null),V=function(){N();var O={type:l.type,data:l.data,options:l.options,plugins:l.plugins};le?g.current=new le(x.current,O):He(()=>import("./auto-fe80bb03.js"),[]).then(function(I){N(),x.current&&I&&(I.default?g.current=new I.default(x.current,O):g.current=new I(x.current,O))})},N=function(){g.current&&(g.current.destroy(),g.current=null)};r.useImperativeHandle(y,function(){return{props:l,getCanvas:function(){return x.current},getChart:function(){return g.current},getBase64Image:function(){return g.current.toBase64Image()},getElement:function(){return D.current},generateLegend:function(){return g.current&&g.current.generateLegend()},refresh:function(){return g.current&&g.current.update()}}}),r.useEffect(function(){V()}),Se(function(){N()});var R=Be("p-chart",l.className),Z=Object.assign({width:l.width,height:l.height},l.style),E=l.options&&l.options.plugins&&l.options.plugins.title&&l.options.plugins.title.text,w=l.ariaLabel||E,T=ae({id:l.id,ref:D,style:Z,className:R},W.getOtherProps(l),h("root")),S=ae({ref:x,width:l.width,height:l.height,role:"img","aria-label":w},h("canvas"));return r.createElement("div",T,r.createElement("canvas",S))}),function(j,y){return j.data===y.data&&j.options===y.options&&j.type===y.type});G.displayName="Chart";const Qe=j=>{const{visible:y,handleClosePop:A,data:l,filters:P,TableHeader:h,globalFilter:D,loadContent:g,viewList:x}=j;return e.jsx(Fe,{visible:y,onHide:()=>A(),className:"preview-container",children:e.jsx(Ye,{value:l,showGridlines:!0,filters:P,emptyMessage:"No Data Found",style:{minWidth:"50rem"},dataKey:"id",paginator:!0,rows:25,rowsPerPageOptions:[5,10,25,50,100],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Entries",paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",globalFilter:D,header:h,children:x.length>0&&x.map(V=>e.jsx(qe,{field:V.name,header:V.title,sortable:V.sort,className:"wrap-cell",style:V.colStyle,body:N=>g(N,V)},V.name))})})},rt=()=>{const j=new Date,[y,A]=r.useState([j,j]);r.useState({}),r.useState({}),r.useState({}),r.useState({}),r.useState({});const l=_e(),P=r.useRef(null),[h,D]=r.useState(),[g,x]=r.useState([]),[V,N]=r.useState({}),[R,Z]=r.useState(Ue.NO_DATA);r.useState(!1),r.useState(!1);const[E,w]=r.useState({}),[T,S]=r.useState({}),[k,O]=r.useState({}),[I,oe]=r.useState([]),[ie,ne]=r.useState({}),[_,ce]=r.useState("bar"),[U,de]=r.useState("pie"),$=r.useRef(null),z=r.useRef(null);Me();const b=getComputedStyle(document.documentElement),B=getComputedStyle(document.documentElement),J=b.getPropertyValue("--text-color"),H=b.getPropertyValue("--text-color-secondary"),M=b.getPropertyValue("--surface-border"),[K,ue]=r.useState({global:{value:null,matchMode:We.CONTAINS}}),[pe,he]=r.useState(""),[ge,Xe]=r.useState(),[me,Y]=r.useState(!1),[be,Ce]=r.useState([]),[ve,fe]=r.useState([]),ye=+localStorage.PlantId,je=()=>{const t=a=>{const o=a.target.value;let s={...K};s.global.value=o,ue(s),he(o)};return e.jsx("div",{className:"flex justify-content-between",children:e.jsxs("span",{className:"p-input-icon-left",children:[e.jsx("i",{className:"pi pi-search"}),e.jsx(Je,{value:pe,onChange:t,placeholder:"Search"})]})})},xe=t=>e.jsx("div",{children:t.StatusName},t.StatusName),Ve=(t,a)=>{if(a.badge)return xe(t);if(!a.badge||!a.action)return e.jsx(e.Fragment,{children:t[a.name]})},Pe=()=>{Y(!1)},ke={maintainAspectRatio:!1,aspectRatio:.6,plugins:{legend:{labels:{boxWidth:20,boxHeight:20,color:J},position:"top"}},scales:{x:{ticks:{color:H},grid:{color:M}},y:{ticks:{color:H},grid:{color:M}}}},q={plugins:{legend:{position:"right",align:"center",labels:{boxWidth:20,boxHeight:20,paddingLeft:20}}}},Ne={maintainAspectRatio:!1,aspectRatio:.8,plugins:{legend:{labels:{fontColor:J}}},scales:{x:{ticks:{color:H,font:{weight:500}},grid:{display:!1,drawBorder:!1}},y:{ticks:{color:H},grid:{color:M,drawBorder:!1}}}},we=[{id:"bar",label:"Bar Chart",command:t=>{F(t)}},{id:"pie",label:"Pie Chart",command:t=>{F(t)}},{id:"line",label:"Line Chart",command:t=>{F(t)}},{id:"doughnut",label:"Donut Chart",command:t=>{F(t)}}],Oe=[{id:"pie",label:"Pie Chart",command:t=>{Q(t)}},{id:"doughnut",label:"Donut Chart",command:t=>{Q(t)}}];r.useEffect(()=>{Ge()}),r.useEffect(()=>{te(y)},[]);const F=t=>{ce(t.item.id)},Q=t=>{de(t.item.id)},Ie=(t,a,o,s,u)=>{let p={...t},C={...a};delete p.Count,delete C.Count;const f={labels:Object.keys(p),datasets:[{label:"Visitors",data:Object.values(p),fill:!1,borderColor:b.getPropertyValue("--blue-500"),tension:.4},{label:"Contractors",data:Object.values(C),fill:!1,borderColor:b.getPropertyValue("--pink-500"),tension:.4},{label:"Vehicle Trip Based",data:Object.values(s),fill:!1,borderColor:b.getPropertyValue("--purple-500"),tension:.4},{label:"Work Permit",data:Object.values(u),fill:!1,borderColor:b.getPropertyValue("--yellow-500"),tension:.4}]};O(ke),w(f)},X=(t,a)=>{if(t){ne(q);const o=Object.values(t.PurposeOfVisitList).every(s=>s===0);if(!t.PurposeOfVisitList||o)S({});else{const s={labels:Object.keys(t.PurposeOfVisitList),datasets:[{data:Object.values(t.PurposeOfVisitList),backgroundColor:[a.getPropertyValue("--blue-500"),a.getPropertyValue("--yellow-500"),a.getPropertyValue("--green-500"),a.getPropertyValue("--red-500"),a.getPropertyValue("--purple-500"),a.getPropertyValue("--orange-500"),a.getPropertyValue("--pink-500"),a.getPropertyValue("--gray-500"),a.getPropertyValue("--red-400"),a.getPropertyValue("--cyan-500"),a.getPropertyValue("--teal-500"),a.getPropertyValue("--orange-400"),a.getPropertyValue("--indigo-500"),a.getPropertyValue("--cyan-600"),a.getPropertyValue("--yellow-300"),a.getPropertyValue("--blue-400")],hoverBackgroundColor:[a.getPropertyValue("--blue-400"),a.getPropertyValue("--yellow-400"),a.getPropertyValue("--green-400"),a.getPropertyValue("--red-400"),a.getPropertyValue("--purple-400"),a.getPropertyValue("--orange-400"),a.getPropertyValue("--pink-400"),a.getPropertyValue("--gray-400"),a.getPropertyValue("--red-300"),a.getPropertyValue("--cyan-400"),a.getPropertyValue("--teal-400"),a.getPropertyValue("--orange-300"),a.getPropertyValue("--indigo-400"),a.getPropertyValue("--cyan-500"),a.getPropertyValue("--yellow-200"),a.getPropertyValue("--blue-300")]}]};S(s)}}},ee=(t,a,o,s,u,p,C,f,d)=>{O(q),t={...V},N(t);let i=[{Type:"Visitors",Count:o},{Type:"Contractors",Count:s},{Type:"Vehicle Trip Based",Count:p},{Type:"Work Permit",Count:f}];const c={labels:i.map(n=>n.Type),datasets:[{data:i.map(n=>n.Count),backgroundColor:[d.getPropertyValue("--blue-500"),d.getPropertyValue("--pink-500"),d.getPropertyValue("--yellow-500"),d.getPropertyValue("--purple-500")],hoverBackgroundColor:[d.getPropertyValue("--blue-400"),d.getPropertyValue("--pink-400"),d.getPropertyValue("--yellow-400"),d.getPropertyValue("--purple-400")]}]};w(c)},Le=(t,a)=>{let o={...a};N(a),delete o.Count;const s={labels:Object.keys(o),datasets:[{label:"Visitors",backgroundColor:b.getPropertyValue("--blue-500"),borderColor:b.getPropertyValue("--blue-500"),data:Object.values(t.VisitorCountList)},{label:"Contractors",backgroundColor:b.getPropertyValue("--pink-500"),borderColor:b.getPropertyValue("--pink-500"),data:Object.values(t.ContractorCountList)},{label:"Vehicle Trip Based",backgroundColor:b.getPropertyValue("--yellow-500"),borderColor:b.getPropertyValue("--yellow-500"),data:Object.values(t.VehicleTripCountList)},{label:"Work Permit",backgroundColor:b.getPropertyValue("--purple-500"),borderColor:b.getPropertyValue("--purple-500"),data:Object.values(t.WorkpermitCountList)}]};w(s),O(Ne)};r.useEffect(()=>{});const De=t=>{let a={};a={Taskname:"SEARCHINITIALIZE",PlantId:localStorage.PlantId,UserId:localStorage.UserId,RoleId:localStorage.DefaultRoleId,Header:0,FromDate:y[0].toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}),ToDate:y[1].toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}),StsId:t};var o=l(Ke(a));o.then(s=>{var u;if(s.payload.transtatus.result){const p=[],C=[];s.payload.ViewList.forEach((d,i)=>{Object.keys(d).forEach(c=>{p.includes(c)||p.push(c)}),p.forEach((c,n)=>{C[n]||(C[n]=[]),C[n].push(d[c])})}),Y(!0);const f=p.map(d=>{const i="",c="",n=i.split(" ").concat([d]),m=c.split(" ").concat([d]);return{title:n.join(" ").replaceAll("_"," "),name:m.join(""),sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}}});fe(f),Ce(s.payload.ViewList)}else(u=P.current)==null||u.show({severity:"error",detail:"Error",summary:s.payload.transtatus.lstErrorItem[0].Message})}).catch(s=>{var u;(u=P.current)==null||u.show({severity:"error",detail:"Error",summary:s})})},te=t=>{let a={};a={Taskname:"SEARCHINITIALIZE",PlantId:localStorage.PlantId,UserId:localStorage.UserId,RoleId:localStorage.DefaultRoleId,Header:0,FromDate:t[0].toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}),ToDate:t[1].toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"})};var o=l(Ze(a));o.then(s=>{var u;if(s.payload.transtatus.result){x(s.payload.VisitorList),D(s.payload),X(h,B);let p=s.payload.VisitorList,C=[];for(const f in p[0])if(p[0].hasOwnProperty(f)){const d=p[0][f];let i="",c="",n="",m="",v=0,L="";switch(f){case"Individual":v=77,i="Individual",n="las la-user-clock",m="color01",c="Visitors",L="/home/vVisitor";break;case"Contractor":v=78,i="Contractor",n="las la-users",m="color04",c="Contractors",L="/home/vVisitor";break;case"checkedIn":v=79,i="CheckedIn",n="las la-sign-out-alt",m="color02",c="Checked In Count",L="/home/vCheckInOut";break;case"checkedOut":v=80,i="checkedOut",n="las la-sign-out-alt",m="color03",c="Checked Out Count",L="/home/vCheckInOut";break;case"GateActive":v=81,i="GateActive",n="las la-dungeon",m="color02",c="Active Gates";break;case"SecurityLoged":v=83,i="SecurityLoged",n="las la-shield-alt",m="color04",c="No Of Security Logged";break;case"VehicleTripBased":v=84,i="VehicleTripBased",n="las la-taxi",m="color02",c="Vehicles";break;case"VisitUser":v=85,i="VisitUser",n="las la-user",m="color03",c="Visitors Came to Visit";break;case"approved":v=86,i="approved",n="las la-check-circle",m="color01",c="Approved Visitors";break;case"pendingApproval":v=87,i="pendingApproval",n="las la-pause-circle",m="color04",c="Pending Approvals";break;case"InsideVisitor":v=88,i="InsideVisitor",n="las la-pause-circle",m="color04",c="Visitors inside the company";break;case"checkedInAll":v=89,i="checkedInAll",n="las la-sign-out-alt",m="color02",c="Checked In Count",L="/home/vCheckInOut";break;case"checkedOutAll":v=90,i="checkedOutAll",n="las la-sign-out-alt",m="color03",c="Checked Out Count",L="/home/vCheckInOut";break}C.push({count:d,stsId:v,text:i,icon:n,iconCol:m,description:c,Path:L})}C.push({stsId:100,text:"Appoinment",icon:"las la-sign-out-alt",iconCol:"color03",description:"Checked Out Count",Path:"/home/cAppointment"}),oe(C)}else(u=P.current)==null||u.show({severity:"error",detail:"Error",summary:s.payload.transtatus.lstErrorItem[0].Message})}).catch(s=>{var u;(u=P.current)==null||u.show({severity:"error",detail:"Error",summary:s})})};r.useEffect(()=>{h&&Ae()},[h,_]),r.useEffect(()=>{U&&X(h,B)},[h,U]);const Ae=()=>{if(h){let t=h.VisitorCountList,a;t.hasOwnProperty("Count")?a=t.Count:a=V.Count;let o=h.ContractorCountList,s=o.Count,u=h.InvoicedCountList,p=u.Count,C=h.VehicleTripCountList,f=C.Count,d=h.WorkpermitCountList,i=d.Count;switch(_){case"bar":Le(h,t);break;case"pie":ee(t,o,a,s,p,f,d,i,B);break;case"line":Ie(t,o,u,C,d);break;case"doughnut":ee(t,o,a,s,p,f,d,i,B);break}a==0&&s==0&&f==0&&p==0&&i==0&&w({})}},Ee=t=>{var u;const a=new Date(t.value[0]),o=new Date(a);o.setDate(a.getDate()+6);let s=null;if(t.value[1]!=null&&(s=new Date(t.value[1]),s>o)){(u=P.current)==null||u.show({severity:"warn",summary:"warn",detail:"Please Select Date between 7 days"});return}a!=null&&s!=null&&(te([a,s]),w([a,s])),A([a,s])};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"inner-page-container",children:[e.jsx("div",{className:"page-title",children:e.jsxs("div",{className:"grid grid-nogutter",children:[e.jsx("div",{className:"md:col-6",children:e.jsx("h1",{children:"VMS Dashboard"})}),e.jsx("div",{className:"md:col-6 text-right",children:e.jsxs("div",{className:"action-btn dashboard-search",children:["View On : ",e.jsx($e,{value:y,onChange:t=>Ee(t),dateFormat:"dd/mm/yy",selectionMode:"range",readOnlyInput:!0,maxDate:new Date})]})})]})}),e.jsxs("div",{className:"form-container scroll-y",children:[e.jsx("div",{className:"grid",children:I&&I.map(t=>(t==null?void 0:t.stsId)!=100?e.jsx("div",{className:"col-3",onClick:()=>De(t.stsId),children:e.jsx("div",{className:"white",children:e.jsxs("div",{className:"widget-body flex",children:[e.jsx("div",{className:`${t.iconCol} dashboard-icon`,children:e.jsx("i",{className:t.icon})}),e.jsxs("div",{className:"dashboard-count-label",children:[e.jsx("div",{className:"dashboard-count",children:g.map((a,o)=>e.jsx("div",{style:{fontSize:"36px"},children:t.count},o))}),e.jsx("div",{className:"dashboard-label",children:t.description})]})]})})}):e.jsx("div",{className:"col-3",children:e.jsx("div",{className:"white",children:e.jsxs("a",{href:`/home/vAppointment?PlantId=${ye}`,target:"_blank",className:"widget-body flex",children:[e.jsx("div",{className:"dashboard-icon color01",children:e.jsx("i",{className:"las la-plus-circle"})}),e.jsx("div",{className:"dashboard-count-label",children:e.jsx("div",{className:"dashboard-count",children:"Create Appointment"})})]})})}))}),e.jsxs("div",{className:"grid",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"white",children:[e.jsx("div",{className:"widget-hdr",children:e.jsx("div",{className:"sub-title",children:e.jsxs("div",{className:"grid",children:[e.jsx("div",{className:"col-6",children:e.jsx("h2",{children:"Visitor Verse Chart (In No's)"})}),e.jsx("div",{className:"col-6 text-end",children:e.jsx("div",{className:"widget-filter",children:e.jsxs("div",{className:"filter-container inline-block",children:[e.jsx(re,{onClick:t=>$.current.toggle(t),title:"Choose Chart","aria-haspopup":!0,children:e.jsx("i",{className:"las la-chart-bar vertical-align-middle"})}),e.jsx(se,{model:we,popup:!0,ref:$,popupAlignment:"right"})]})})})]})})}),e.jsx("div",{className:"widget-body",children:e.jsx("div",{className:"card",children:E&&Object.keys(E).length>0?e.jsx(G,{type:_,data:E,options:k,className:"chart-height",style:{height:"520px"}}):e.jsx("img",{src:R,alt:"logo",className:"w-full",style:{maxHeight:"520px"}})})})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"white",children:[e.jsx("div",{className:"widget-hdr",children:e.jsx("div",{className:"sub-title",children:e.jsxs("div",{className:"grid",children:[e.jsx("div",{className:"col-6",children:e.jsx("h2",{children:"Purpose of Visit (In No's)"})}),e.jsx("div",{className:"col-6 text-end",children:e.jsx("div",{className:"widget-filter",children:e.jsxs("div",{className:"filter-container inline-block",children:[e.jsx(re,{onClick:t=>z.current.toggle(t),title:"Choose Chart","aria-haspopup":!0,children:e.jsx("i",{className:"las la-chart-bar vertical-align-middle"})}),e.jsx(se,{model:Oe,popup:!0,ref:z,popupAlignment:"right"})]})})})]})})}),e.jsx("div",{className:"widget-body",children:e.jsx("div",{className:"widget-body",children:e.jsx("div",{className:"card flex justify-content-center",children:T&&Object.keys(T).length>0?e.jsx(G,{type:U,data:T,options:ie,className:"chart-full-width",style:{maxHeight:"500px",width:"600px"}}):e.jsx("img",{src:R,alt:"logo",className:"w-full",style:{maxHeight:"505px"}})})})})]})})]})]})]}),e.jsx(ze,{toast:P}),e.jsx(Qe,{visible:me,handleClosePop:Pe,data:be,filters:K,TableHeader:je,globalFilter:ge,loadContent:Ve,viewList:ve})]})})};export{Qe as DashBoardDetails,rt as default};
