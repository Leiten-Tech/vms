import{r as o,a as N,u as w,b as I,p as j,S as M,x as h,j as s,C as O,d as B,y as g,g as H,z as W}from"./index-25a41ef1.js";import{P as _,A as F}from"./PageHeader-b76b68bd.js";import{p as T}from"./PermissionService-9ad252b6.js";import{e as S}from"./ExportService-4b3a6c99.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const Q=()=>{o.useState(null);const C=N(),[e,x]=o.useState(),m=o.useRef(null),n=w(),[d,u]=o.useState([]),{CompanyList:b,loading:v}=I(a=>a.company);o.useEffect(()=>{j()}),o.useEffect(()=>{x(T({screenId:14}))},[]),o.useEffect(()=>{f()},[]);const f=()=>n(M({CompanyId:0,Taskname:"SearchInitialize"}));o.useEffect(()=>{e!=null&&e._View&&d.filter(a=>a.name=="view").length==0&&u([...d,{title:"View",name:"view",disabled:!1}]),e!=null&&e._Update&&d.filter(a=>a.name=="edit").length==0&&u([...d,{title:"Edit",name:"edit",disabled:!1}]),e!=null&&e._Delete&&d.filter(a=>a.name=="delete").length==0&&u([...d,{title:"Delete",name:"delete",disabled:!1}]),e!=null&&e._View&&(e!=null&&e._Update)&&(e!=null&&e._Delete)&&y({...c,tableAction:!0})},[e,d]),o.useEffect(()=>{e!=null&&e._Add&&!c.pageHeader.pageActions[0].create&&y(a=>{const i={...a.pageHeader,pageActions:a.pageHeader.pageActions.map(l=>({...l,create:!!(e!=null&&e._Add)}))};return{...a,pageHeader:i}})},[e]),o.useEffect(()=>{}),o.useEffect(()=>{y({...c,tableActions:d})},[d]);const[c,y]=o.useState({pageTitle:"Company",pageHeader:{pageActions:[{create:!1,clear:!1,save:!1,createQuery:"/home/cCompany",createDispatch:()=>n(h({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{width:"120px",textAlign:"center"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:d,tableColumns:[{title:"Company Code",name:"CompanyCode",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Company Name",name:"CompanyName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"16rem"}},{title:"Created By",name:"CreatedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created On",name:"CreatedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified By",name:"ModifiedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified On",name:"ModifiedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Status",name:"StatusName",sort:!0,avatar:!1,badge:!0,colStyle:{minWidth:"2rem",textAlign:"center"}}],tableExport:a=>{f().then(l=>{E(l.payload.CompanyList).then(t=>{a==="pdf"?S.Export("Company",t,"pdf"):a==="excel"&&S.Export("Company",t,"excel")}).catch(t=>{console.error(t.message)})})}}),E=a=>new Promise((i,l)=>{let t=[];a.length>0?(a.forEach(r=>{let p={"Company Code":r.CompanyCode,"Company Name":r.CompanyName,"Created By":r.CreatedByName,"Created On":r.CreatedOn,"Modified By":r.ModifiedByName,"Modified On":r.ModifiedOn,Status:r.StatusName};t.push(p)}),i(t)):l(new Error("No data available for export."))}),A={view:a=>{const i={CompanyId:a.data.CompanyId,Taskname:"CreateInitialize"};n(g(i)).then(t=>{t.payload.transtatus.result==!0&&C.push("/home/cCompany")}).catch(t=>{}),n(h(a))},edit:a=>{const i={CompanyId:a.data.CompanyId,Taskname:"CreateInitialize"};n(g(i)).then(t=>{t.payload.transtatus.result==!0&&C.push("/home/cCompany")}).catch(t=>{}),n(h(a))},delete:a=>{H(`Are you sure you want to inactive this ${a.data.CompanyName}?`,"Confirmation",()=>{let i={CompanyId:a.data.CompanyId};n(W(i)).then(t=>{var r,p;t.payload.transtatus.result==!0?((r=m.current)==null||r.show({severity:"success",summary:"Success Message",detail:t.payload.transtatus.lstErrorItem[0].Message}),f()):t.payload.transtatus.result==!1&&((p=m.current)==null||p.show({severity:"warn",summary:"Warning Message",detail:t.payload.transtatus.lstErrorItem[0].Message}))}).catch(t=>{var r;(r=m.current)==null||r.show({severity:"error",summary:"Error Message",detail:JSON.stringify(t)})})},()=>{})}};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"page-container",children:s.jsxs("div",{className:"inner-page-container",children:[s.jsx(_,{pageTitle:c.pageTitle,pageConfig:c}),s.jsx("div",{className:"form-container scroll-y",children:s.jsx("div",{className:"white",children:s.jsx("div",{className:"widget-body",children:s.jsx("div",{className:"card",children:s.jsx(F,{handleActions:A,data:b,loading:v,pageConfig:c,screenPermissions:e})})})})})]})}),s.jsx(O,{}),s.jsx(B,{toast:m})]})};export{Q as default};
