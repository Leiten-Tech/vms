import{a as v,u as I,r as d,b as w,p as j,aY as _,aZ as A,j as r,C as H,d as F,a_ as y,g as T,a$ as R}from"./index-25a41ef1.js";import{P as z,A as D}from"./PageHeader-b76b68bd.js";import{e as x}from"./ExportService-4b3a6c99.js";import{p as M}from"./PermissionService-9ad252b6.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const W=()=>{const g=v(),c=I(),[a,b]=d.useState(),[l,f]=d.useState([]),{loading:C,AreaList:E}=w(e=>e.area),u=d.useRef(null);d.useEffect(()=>{m()},[]),d.useEffect(()=>{j()}),d.useEffect(()=>{b(M({screenId:15}))},[]);const m=()=>{const e={AreaId:0,Taskname:"SearchInitialize",CompanyId:+localStorage.CompanyId};return c(_(e))};d.useEffect(()=>{a!=null&&a._View&&l.filter(e=>e.name=="view").length==0&&f([...l,{title:"View",name:"view",disabled:!1}]),a!=null&&a._Update&&l.filter(e=>e.name=="edit").length==0&&f([...l,{title:"Edit",name:"edit",disabled:!1}]),a!=null&&a._Delete&&l.filter(e=>e.name=="delete").length==0&&f([...l,{title:"Delete",name:"delete",disabled:!1}]),a!=null&&a._View&&(a!=null&&a._Update)&&(a!=null&&a._Delete)&&h({...n,tableAction:!0})},[a,l]),d.useEffect(()=>{h({...n,tableActions:l})},[l]),d.useEffect(()=>{a!=null&&a._Add&&!n.pageHeader.pageActions[0].create&&h(e=>{const s={...e.pageHeader,pageActions:e.pageHeader.pageActions.map(i=>({...i,create:!!(a!=null&&a._Add)}))};return{...e,pageHeader:s}})},[a]);const[n,h]=d.useState({pageTitle:"Area",pageHeader:{pageActions:[{create:!1,clear:!1,save:!1,createQuery:"/home/cArea",createDispatch:()=>c(A({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{width:"10em",textAlign:"center"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:l,tableColumns:[{title:"Company",name:"CompanyName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Plant Name",name:"PlantName",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Area Code",name:"AreaCode",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Area Name",name:"AreaName",sort:!0,avatar:!1,badge:!1,colStyle:{}}],tableExport:e=>{m().then(i=>{N(i.payload.AreaList).then(t=>{e==="pdf"?x.Export("Area",t,"pdf"):e==="excel"&&x.Export("Area",t,"excel")}).catch(t=>{console.error(t.message)})})}}),N=e=>new Promise((s,i)=>{let t=[];e.length>0?(e.forEach(o=>{let p={"Company Name":o.CompanyName,"Plant Name":o.PlantName,"Area Code":o.AreaCode,"Area Name":o.AreaName};t.push(p)}),s(t)):i(new Error("No data available for export."))}),S={view:e=>{const s={AreaId:e.data.AreaId,Taskname:"CreateInitialize"};c(y(s)).then(t=>{t.payload.transtatus.result==!0&&g.push("/home/cArea")}).catch(t=>{}),c(A(e))},edit:e=>{const s={AreaId:e.data.AreaId,Taskname:"CreateInitialize"};c(y(s)).then(t=>{t.payload.transtatus.result==!0&&g.push("/home/cArea")}).catch(t=>{}),c(A(e))},delete:e=>{T(`Are you sure you want to inactive this ${e.data.AreaName}?`,"Confirmation",()=>{let s={AreaId:e.data.AreaId};c(R(s)).then(t=>{var o,p;t.payload.transtatus.result==!0?((o=u.current)==null||o.show({severity:"success",summary:"Success Message",detail:t.payload.transtatus.lstErrorItem[0].Message}),m()):t.payload.transtatus.result==!1&&((p=u.current)==null||p.show({severity:"error",summary:"Error Message",detail:t.payload.transtatus.lstErrorItem[0].Message}))}).catch(t=>{var o;(o=u.current)==null||o.show({severity:"error",summary:"Error Message",detail:JSON.stringify(t)})})},()=>{})}};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"page-container",children:r.jsxs("div",{className:"inner-page-container",children:[r.jsx(z,{pageTitle:n.pageTitle,pageConfig:n}),r.jsx("div",{className:"form-container scroll-y",children:r.jsx("div",{className:"white",children:r.jsx("div",{className:"widget-body",children:r.jsx("div",{className:"card",children:r.jsx(D,{handleActions:S,data:E,loading:C,pageConfig:n,screenPermissions:a})})})})})]})}),r.jsx(H,{}),r.jsx(F,{toast:u})]})};export{W as default};
