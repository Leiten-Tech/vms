import{a as A,u as N,r as i,b as w,p as I,bc as j,bd as g,j as d,C as M,d as O,be as D,g as B,bf as H}from"./index-25a41ef1.js";import{P as _,A as F}from"./PageHeader-b76b68bd.js";import{p as T}from"./PermissionService-9ad252b6.js";import{e as b}from"./ExportService-4b3a6c99.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const Q=()=>{const y=A(),o=N(),[e,S]=i.useState(),[s,u]=i.useState([]),m=i.useRef(null),{loading:x,DepartmentList:C}=w(t=>t.department);i.useEffect(()=>{f()},[]),i.useEffect(()=>{I()}),i.useEffect(()=>{S(T({screenId:18}))},[]);const f=()=>o(j({DeptId:0,Taskname:"SearchInitialize"}));i.useEffect(()=>{e!=null&&e._View&&s.filter(t=>t.name=="view").length==0&&u([...s,{title:"View",name:"view",disabled:!1}]),e!=null&&e._Update&&s.filter(t=>t.name=="edit").length==0&&u([...s,{title:"Edit",name:"edit",disabled:!1}]),e!=null&&e._Delete&&s.filter(t=>t.name=="delete").length==0&&u([...s,{title:"Delete",name:"delete",disabled:!1}]),e!=null&&e._View&&(e!=null&&e._Update)&&(e!=null&&e._Delete)&&h({...c,tableAction:!0})},[e,s]),i.useEffect(()=>{e!=null&&e._Add&&!c.pageHeader.pageActions[0].create&&h(t=>{const l={...t.pageHeader,pageActions:t.pageHeader.pageActions.map(n=>({...n,create:!!(e!=null&&e._Add)}))};return{...t,pageHeader:l}})},[e]),i.useEffect(()=>{h({...c,tableActions:s})},[s]);const[c,h]=i.useState({pageTitle:"Department",pageHeader:{pageActions:[{create:!1,clear:!1,save:!1,createQuery:"/home/cDepartment",createDispatch:()=>o(g({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{width:"10em",textAlign:"center"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:s,tableColumns:[{title:"Department Code",name:"DepartmentCode",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Department Name",name:"DepartmentName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Created By",name:"CreatedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created On",name:"CreatedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified By",name:"ModifiedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified On",name:"ModifiedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Status",name:"StatusName",sort:!0,avatar:!1,badge:!0,colStyle:{minWidth:"2rem",textAlign:"center"}}],tableExport:t=>{f().then(n=>{v(n.payload.DepartmentList).then(a=>{t==="pdf"?b.Export("Department",a,"pdf"):t==="excel"&&b.Export("Department",a,"excel")}).catch(a=>{console.error(a.message)})})}}),v=t=>new Promise((l,n)=>{let a=[];t.length>0?(t.forEach(r=>{let p={"Department Code":r.DepartmentCode,"Department Name":r.DepartmentName,"Created By":r.CreatedByName,"Created On":r.CreatedOn,"Modified By":r.ModifiedByName,"Modified On":r.ModifiedOn,Status:r.StatusName};a.push(p)}),l(a)):n(new Error("No data available for export."))}),E={view:t=>{const l={DeptId:t.data.DepartmentId,Taskname:"CreateInitialize"};o(D(l)).then(a=>{a.payload.transtatus.result==!0&&y.push("/home/cDepartment")}).catch(a=>{}),o(g(t))},edit:t=>{const l={DeptId:t.data.DepartmentId,Taskname:"CreateInitialize"};o(D(l)).then(a=>{a.payload.transtatus.result==!0&&y.push("/home/cDepartment")}).catch(a=>{}),o(g(t))},delete:t=>{B(`Are you sure you want to inactive this ${t.data.DepartmentName}?`,"Confirmation",()=>{let l={DeptId:t.data.DepartmentId};o(H(l)).then(a=>{var r,p;a.payload.transtatus.result==!0?((r=m.current)==null||r.show({severity:"success",summary:"Success Message",detail:a.payload.transtatus.lstErrorItem[0].Message}),f()):a.payload.transtatus.result==!1&&((p=m.current)==null||p.show({severity:"error",summary:"Error Message",detail:a.payload.transtatus.lstErrorItem[0].Message}))}).catch(a=>{var r;(r=m.current)==null||r.show({severity:"error",summary:"Error Message",detail:JSON.stringify(a)})})},()=>{})}};return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"page-container",children:d.jsxs("div",{className:"inner-page-container",children:[d.jsx(_,{pageTitle:c.pageTitle,pageConfig:c}),d.jsx("div",{className:"form-container scroll-y",children:d.jsx("div",{className:"white",children:d.jsx("div",{className:"widget-body",children:d.jsx("div",{className:"card",children:d.jsx(F,{handleActions:E,data:C,loading:x,pageConfig:c,screenPermissions:e})})})})})]})}),d.jsx(M,{}),d.jsx(O,{toast:m})]})};export{Q as default};
