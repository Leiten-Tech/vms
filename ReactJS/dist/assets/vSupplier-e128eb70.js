import{r as i,a as j,u as w,b as y,p as I,c7 as h,c8 as M,j as l,C as O,d as H,c9 as b,g as B,ca as F}from"./index-25a41ef1.js";import{P as T,A as W}from"./PageHeader-b76b68bd.js";import{e as x}from"./ExportService-4b3a6c99.js";import{p as _}from"./PermissionService-9ad252b6.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const Y=()=>{i.useState(null);const g=j(),c=i.useRef(null),[t,C]=i.useState(),[d,f]=i.useState([]),o=w();y(e=>e.supplier.SupplierHeader);const{isCreate:D,isView:R,createEditData:V,loading:v,error:L,tranStatus:U,SupplierHeader:k,SupplierList:N}=y(e=>e.supplier);i.useEffect(()=>{I()}),i.useEffect(()=>{C(_({screenId:11}))},[]),i.useEffect(()=>{m()},[]),i.useEffect(()=>{t!=null&&t._View&&d.filter(e=>e.name=="view").length==0&&f([...d,{title:"View",name:"view",disabled:!1}]),t!=null&&t._Update&&d.filter(e=>e.name=="edit").length==0&&f([...d,{title:"Edit",name:"edit",disabled:!1}]),t!=null&&t._Delete&&d.filter(e=>e.name=="delete").length==0&&f([...d,{title:"Delete",name:"delete",disabled:!1}]),t!=null&&t._View&&(t!=null&&t._Update)&&(t!=null&&t._Delete)&&S({...u,tableAction:!0})},[t,d]),i.useEffect(()=>{t!=null&&t._Add&&!u.pageHeader.pageActions[0].create&&S(e=>{const s={...e.pageHeader,pageActions:e.pageHeader.pageActions.map(p=>({...p,create:!!(t!=null&&t._Add)}))};return{...e,pageHeader:s}})},[t]),i.useEffect(()=>{S({...u,tableActions:d})},[d]);const[u,S]=i.useState({pageTitle:"Supplier",pageHeader:{pageActions:[{create:!1,clear:!1,save:!1,createQuery:"/home/cSupplier",createDispatch:()=>o(h({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{maxWidth:"10rem",textAlign:"center",justifySelf:"center"},tableRows:10,tableRowsOptions:[5,10,25,50,100],tablePagination:!0,tableActions:d,tableColumns:[{title:"Supplier Code",name:"SupplierCode",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Supplier Name",name:"SupplierName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Supplier Type",name:"SupplierTypeName",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Supplier Category",name:"CategoryName",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Created By",name:"CreatedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created On",name:"CreatedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified By",name:"ModifiedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified On",name:"ModifiedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Status",name:"StatusName",sort:!0,avatar:!1,badge:!0,colStyle:{minWidth:"2rem",textAlign:"center"}}],tableExport:e=>{m().then(p=>{E(p.payload.SupplierList).then(a=>{e==="pdf"?x.Export("Supplier",a,"pdf"):e==="excel"&&x.Export("Supplier",a,"excel")}).catch(a=>{console.error(a.message)})})}}),E=e=>new Promise((s,p)=>{let a=[];e.length>0?(e.forEach(r=>{let n={"Supplier Code":r.SupplierCode,"Supplier Name":r.SupplierName,"Supplier Type":r.SupplierTypeName,"Supplier Category":r.CategoryName,"Created By":r.CreatedByName,"Created On":r.CreatedOn,"Modified By":r.ModifiedByName,"Modified On":r.ModifiedOn,Status:r.StatusName};a.push(n)}),s(a)):p(new Error("No data available for export."))}),m=()=>{const e={SupplierId:0,CompanyId:+localStorage.CompanyId};return o(M(e))},A={view:e=>{const s={SupplierId:e.data.SupplierId};o(b(s)).then(a=>{a.payload.tranStatus.result==!0&&g.push("/home/cSupplier")}).catch(a=>{}),o(h(e))},edit:e=>{const s={SupplierId:e.data.SupplierId};o(b(s)).then(a=>{a.payload.tranStatus.result==!0&&g.push("/home/cSupplier")}).catch(a=>{}),o(h(e))},delete:e=>{B(`Are you sure you want to inactive this ${e.data.SupplierName}?`,"Confirmation",()=>{let s={SupplierId:e.data.SupplierId};o(F(s)).then(a=>{var r,n;a.payload.tranStatus.result==!0?((r=c.current)==null||r.show({severity:"success",summary:"Success Message",detail:a.payload.tranStatus.lstErrorItem[0].Message}),m()):a.payload.tranStatus.result==!1&&((n=c.current)==null||n.show({severity:"error",summary:"Error Message",detail:a.payload.tranStatus.lstErrorItem[0].Message}))}).catch(a=>{var r;(r=c.current)==null||r.show({severity:"error",summary:"Error Message",detail:JSON.stringify(a)})})},()=>{})}};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"page-container",children:l.jsxs("div",{className:"inner-page-container",children:[l.jsx(T,{pageTitle:u.pageTitle,pageConfig:u}),l.jsx("div",{className:"form-container scroll-y",children:l.jsx("div",{className:"white",children:l.jsx("div",{className:"widget-body",children:l.jsx("div",{className:"card",children:l.jsx(W,{handleActions:A,data:N,loading:v,pageConfig:u,screenPermissions:t})})})})})]})}),l.jsx(O,{}),l.jsx(H,{toast:c})]})};export{Y as default};
