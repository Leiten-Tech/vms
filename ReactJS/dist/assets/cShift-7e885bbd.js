import{a as E,u as H,r as h,co as w,b as V,c as D,t as g,cq as L,cr as k,j as e,F as A,B as x,n as f,A as O,d as R}from"./index-25a41ef1.js";import{s as q}from"./Master-b11b8a2f.js";import"./index.esm-21a4a4d3.js";const K=()=>{const b=E(),S=H(),l=h.useRef(null);h.useEffect(()=>{if(t!=null){if(p==!1){const a={ShiftId:t.ShiftId,Taskname:"CREATEINITIALIZE"};S(w(a))}}else S(w({ShiftId:0,Taskname:"CREATEINITIALIZE"}))},[]);const{cityList:B,loading:I,isView:u,isCreate:p,CountryList:P,stateList:U,createOrEdit:$,HdrTable:t,StatusList:F}=V(a=>a.shift),[J,v]=h.useState(null),[Z,N]=h.useState(null),s=D({initialValues:{ShiftName:t!=null?t.ShiftName:"",ShiftType:t!=null?t.ShiftType:"",FromTime:t!=null?new Date(t.ShiftFromTime):null,ToTime:t!=null?new Date(t.ShiftToTime):null,ShiftHours:t!=null?t.ShiftHours:"",Status:t!=null?t.Status:1},validationSchema:q,onSubmit:(a,{resetForm:y})=>{var m,d,T;if(a.ShiftHours==0){(m=l.current)==null||m.show({severity:"warn",summary:"Warning Message",detail:" Shift Hours cannot be 0"});return}let r={Shift:{ShiftId:t!=null?t.ShiftId:0,ShiftCode:t!=null?t.ShiftCode:"",ShiftName:a.ShiftName,ShiftFromTime:a.FromTime,ShiftToTime:a.ToTime,ShiftType:a.ShiftType,ShiftHours:a.ShiftHours,CompanyId:localStorage.CompanyId,PlantId:localStorage.PlantId,Status:a.Status,CreatedBy:t!=null?t.CreatedBy:localStorage.UserId,CreatedOn:t!=null?g(t.CreatedOn):g(new Date),ModifiedBy:t!=null?localStorage.UserId:null,ModifiedOn:t!=null?g(new Date):null}};if(t!=null){if(t.isCreate!=!1)try{S(L(r)).then(i=>{var o,c;(i.payload!=null||!i.payload)&&(i.payload.transtatus.result==!0?((o=l.current)==null||o.show({severity:"success",summary:"Success Message",detail:i.payload.transtatus.lstErrorItem[0].Message}),y(),setTimeout(()=>{b.push("/home/vShift")},800)):i.payload.transtatus.result==!1&&((c=l.current)==null||c.show({severity:"error",summary:"Error Message",detail:i.payload.transtatus.lstErrorItem[0].Message})))})}catch(n){(d=l.current)==null||d.show({severity:"warn",summary:"Error Message",detail:n})}}else try{S(k(r)).then(i=>{var o,c;(i.payload!=null||!i.payload)&&(i.payload.transtatus.result==!0?((o=l.current)==null||o.show({severity:"success",summary:"Success Message",detail:i.payload.transtatus.lstErrorItem[0].Message}),y()):i.payload.transtatus.result==!1&&((c=l.current)==null||c.show({severity:"warn",summary:"Error Message",detail:i.payload.transtatus.lstErrorItem[0].Message})))}).catch(i=>{var o;(o=l.current)==null||o.show({severity:"warn",summary:"Error Message",detail:JSON.stringify(i.payload)})})}catch(n){(T=l.current)==null||T.show({severity:"warn",summary:"Error Message",detail:JSON.stringify(n.payload)})}}}),C=()=>{s.resetForm()},M=(a,y,r)=>{s.setFieldValue(a,r)},j=a=>{s.setFieldValue(a.target.name,a.target.value),a.target.name=="FromTime"&&v(a.target.value),a.target.name=="ToTime"&&N(a.target.value)};return h.useEffect(()=>{if(s.values.FromTime&&s.values.ToTime){const a=new Date(s.values.FromTime);let r=new Date(s.values.ToTime).getTime()-a.getTime();r<0&&(r+=864e5);const m=r/(1e3*60*60),d=m%1*60,T=Math.max(m).toFixed(2),n=`${Math.floor(Number(T))}${d>0?`.${Math.round(d)}`:""}`;s.setFieldValue("ShiftHours",n)}},[s.values.FromTime,s.values.ToTime]),e.jsxs(e.Fragment,{children:[e.jsx(A,{initialValues:s.initialValues,validationSchema:s.validationSchema,onSubmit:s.handleSubmit,children:e.jsx("div",{className:"page-container",children:e.jsxs("div",{className:"inner-page-container",children:[e.jsx("div",{className:"page-title",children:e.jsxs("div",{className:"grid grid-nogutter",children:[e.jsx("div",{className:"md:col-6",children:e.jsx("h1",{children:"Shift"})}),e.jsx("div",{className:"md:col-6 text-right",children:e.jsxs("div",{className:"action-btn",children:[e.jsxs(e.Fragment,{children:[e.jsx(x,{label:"",title:"Save",icon:"pi pi-save",className:"text-center",disabled:!!u,type:"submit",onClick:()=>s.handleSubmit()}),e.jsx(x,{label:"",severity:"danger",icon:"pi pi-trash",disabled:!!(u||p==!1),title:"Clear",className:"text-center",onClick:()=>C()})]}),e.jsx(x,{label:"",icon:"pi pi-search",title:"Back to Search",className:"p-button p-button-success text-center",onClick:()=>{b.push("/home/vShift")}})]})})]})}),e.jsx("div",{className:"form-container scroll-y",children:e.jsx("form",{children:e.jsx("div",{className:"white",children:e.jsx("div",{className:"widget-body",children:e.jsx("div",{className:"normal-table",children:e.jsx("div",{className:"grid",children:I?e.jsx(O,{}):e.jsxs(e.Fragment,{children:[e.jsx(f,{type:"text",name:"ShiftName",label:"Shift Name",options:"",show:!0,required:!1,disable:!!u,optionLabel:"",optionValue:"",handleSelect:"",formik:s,fldStyle:"col-12 md:col-3",maxlength:90}),e.jsx(f,{type:"Calendar",name:"FromTime",label:"From Time",options:"",show:!0,showTime:!0,hourFormat:"24",timeOnly:!0,required:!0,disable:!!u,optionLabel:"",optionValue:"",handleSelect:"",handleChange:j,formik:s,fldStyle:"col-12 md:col-3"}),e.jsx(f,{type:"Calendar",name:"ToTime",label:"To Time",options:"",show:!0,showTime:!0,timeOnly:!0,hourFormat:"24",required:!0,disable:!!u,optionLabel:"",optionValue:"",handleSelect:"",handleChange:j,formik:s,fldStyle:"col-12 md:col-3"}),e.jsx(f,{type:"text",name:"ShiftHours",label:"Shift Hours",options:"",show:!0,required:!0,disable:!0,optionLabel:"",optionValue:"",handleSelect:"",formik:s,fldStyle:"col-12 md:col-3"}),e.jsx(f,{type:"select",name:"Status",label:"Status",options:F,show:!0,required:!0,disable:!!u||p==null||p==!0,optionLabel:"MetaSubDescription",optionValue:"MetaSubId",handleSelect:M,formik:s,fldStyle:"col-12 md:col-3"})]})})})})})})})]})})}),e.jsx(R,{toast:l})]})};export{K as default};
