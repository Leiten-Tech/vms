import{a as M,r as c,u as N,b as j,p as O,cs as p,ct as h,j as s,cu as f,B as P,C as A,d as F,cv as v,g as T,t as W,cw as k,cx as L,cy as B}from"./index-25a41ef1.js";import{P as J,A as R}from"./PageHeader-b76b68bd.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";const G=()=>{const g=M(),r=c.useRef(null),n=N(),[E,S]=c.useState([]);c.useState(),c.useState(!1);const[d,I]=c.useState(new Date),[m,C]=c.useState(new Date),{loading:V,createEditData:U}=j(a=>a.visitor);c.useEffect(()=>{O()}),c.useEffect(()=>{u()},[]);const u=()=>{let a={PlantId:+localStorage.PlantId,FromDate:new Date().toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}),ToDate:new Date().toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"})};var l=n(p(a));l.then(i=>{var t;i.payload.tranStatus.result==!0?S(i.payload.VisitorEntryList):(t=r.current)==null||t.show({severity:"error",summary:"Error Message",detail:i.payload.tranStatus.lstErrorItem[0].Message})}).catch(i=>{var t;(t=r.current)==null||t.show({severity:"error",summary:"Error Message",detail:JSON.stringify(i)})})},[y,H]=c.useState({pageTitle:"Visitor Entry",pageHeader:{pageActions:[{create:!0,clear:!1,save:!1,createQuery:"/home/cVisitorEntry",createDispatch:()=>n(h({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{minWidth:"14rem",maxWidth:"14rem",textAlign:"center",justifySelf:"center"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:[{title:"View",name:"view"},{title:"Edit",name:"edit"},{title:"Delete",name:"delete"},{title:"Print",name:"print"},{title:"Approval",name:"self_approval"}],tableColumns:[{title:"Visitor Entry Code",name:"VisitorEntryCode",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Visitor Name",name:"PersonName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Visitor Type",name:"VisitorTypeName",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Mobile No",name:"MobileNo",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"7rem"}},{title:"Person To Visit",name:"PersonToVisit",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Purpose Of Visit",name:"PurposeOfVisitName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created By",name:"CreatedbyName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"8rem"}},{title:"Created On",name:"CreatedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified By",name:"ModifiedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"8rem"}},{title:"Modified On",name:"ModifiedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Status",name:"StatusName",sort:!0,avatar:!1,badge:!0,colStyle:{minWidth:"7rem",textAlign:"center"}},{title:"CheckOut",name:"CheckOut",sort:!0,avatar:!1,badge:!1,action:!0,colStyle:{minWidth:"7rem",maxWidth:"8rem",textAlign:"center"}}]}),w={view:a=>{const l={VisitorEntryId:a.data.VisitorEntryId,PlantId:+localStorage.PlantId,CompanyId:+localStorage.CompanyId};n(v(l)).then(t=>{var e;t.payload.tranStatus.result==!0?g.push("/home/cVisitorEntry"):(e=r.current)==null||e.show({severity:"error",summary:"Error Message",detail:t.payload.tranStatus.lstErrorItem[0].Message})}).catch(t=>{var e;(e=r.current)==null||e.show({severity:"error",summary:"Error Message",detail:JSON.stringify(t)})}),n(h(a))},edit:a=>{const l={VisitorEntryId:a.data.VisitorEntryId,PlantId:+localStorage.PlantId,CompanyId:+localStorage.CompanyId};n(v(l)).then(t=>{var e;t.payload.tranStatus.result==!0?g.push("/home/cVisitorEntry"):(e=r.current)==null||e.show({severity:"error",summary:"Error Message",detail:t.payload.tranStatus.lstErrorItem[0].Message})}).catch(t=>{var e;(e=r.current)==null||e.show({severity:"error",summary:"Error Message",detail:JSON.stringify(t)})}),n(h(a))},delete:a=>{T(`Are you sure you want to inactive this Visitor (${a.data.PersonName}[${a.data.VisitorEntryCode}]) ?`,"Confirmation",()=>{const l={VisitorEntryId:a.data.VisitorEntryId};var i=n(B(l));i.then(t=>{var e,o;t.payload.tranStatus.result==!0?((e=r.current)==null||e.show({severity:"success",summary:"Success Message",detail:"Inactivated Successfully."}),u()):(o=r.current)==null||o.show({severity:"error",summary:"Error Message",detail:t.payload.tranStatus.lstErrorItem[0].Message})}).catch(t=>{var e;(e=r.current)==null||e.show({severity:"error",summary:"Error Message",detail:JSON.stringify(t)})})},()=>{})},print:a=>{localStorage.setItem("clickedRowData",JSON.stringify(a)),window.open("/home/print")},approval:a=>{let l={UserId:localStorage.UserId,VisitorEntryCode:a.data.VisitorEntryCode,VisitorEntryDetailId:a.data.VisitorEntryDetailId,Checkintime:W(new Date),type:"SelfApproval"};var i=n(k(l));i.then(t=>{var e,o;t.payload.tranStatus.result?((e=r.current)==null||e.show({severity:"success",summary:"Success Message",detail:"Checked In Successfully."}),u()):(o=r.current)==null||o.show({severity:"error",summary:"Error",detail:t.payload.tranStatus.lstErrorItem[0].Message})}).catch(t=>{var e;(e=r.current)==null||e.show({severity:"error",summary:"Error",detail:JSON.stringify(t)})})},checkOut:a=>{let l={UserId:localStorage.UserId,VisitorEntryCode:a.data.VisitorEntryCode,VisitorEntryDetailId:a.data.VisitorEntryDetailId,Checkouttime:new Date};var i=n(L(l));i.then(t=>{var e,o;t.payload.tranStatus.result?((e=r.current)==null||e.show({severity:"success",summary:"Success Message",detail:"Checked Out Successfully."}),u()):(o=r.current)==null||o.show({severity:"error",summary:"Error",detail:t.payload.tranStatus.lstErrorItem[0].Message})}).catch(t=>{var e;(e=r.current)==null||e.show({severity:"error",summary:"Error",detail:JSON.stringify(t)})})}},x=a=>{I(a.target.value)},b=a=>{C(a.target.value)},D=()=>{var i,t;if(!d||d==null){(i=r.current)==null||i.show({severity:"error",summary:"Error Message",detail:"Please Select From Date."});return}if(!m||m==null){(t=r.current)==null||t.show({severity:"error",summary:"Error Message",detail:"Please Select To Date."});return}let a={PlantId:+localStorage.PlantId,FromDate:d.toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}),ToDate:m.toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"})};var l=n(p(a));l.then(e=>{var o;e.payload.tranStatus.result==!0?S(e.payload.VisitorEntryList):(o=r.current)==null||o.show({severity:"error",summary:"Error Message",detail:e.payload.tranStatus.lstErrorItem[0].Message})}).catch(e=>{var o;(o=r.current)==null||o.show({severity:"error",summary:"Error Message",detail:JSON.stringify(e)})})};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"page-container",children:s.jsxs("div",{className:"inner-page-container",children:[s.jsx(J,{pageTitle:y.pageTitle,pageConfig:y}),s.jsx("div",{className:"form-container scroll-y",children:s.jsx("div",{className:"white",children:s.jsx("div",{className:"widget-body",children:s.jsxs("div",{className:"card",children:[s.jsxs("div",{children:[s.jsx("label",{className:"form-label",style:{marginRight:"20px"},children:"From Date :"}),s.jsx(f,{dateFormat:"dd/mm/yy",showIcon:!0,onChange:x,style:{width:"200px",marginBottom:"20px",marginRight:"20px"},value:d}),s.jsx("label",{className:"form-label",style:{marginRight:"20px"},children:"To Date :"}),s.jsx(f,{dateFormat:"dd/mm/yy",showIcon:!0,onChange:b,style:{width:"200px",marginBottom:"20px"},value:m}),s.jsx(P,{label:"Search",severity:"success",title:"Search",icon:"las la-search",style:{marginBottom:"20px ",marginLeft:"20px"},onClick:D})]}),s.jsx(R,{handleActions:w,data:E,loading:V,pageConfig:y})]})})})})]})}),s.jsx(A,{}),s.jsx(F,{toast:r})]})};export{G as default};
