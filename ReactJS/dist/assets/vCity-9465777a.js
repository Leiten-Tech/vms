import{r as i,a as I,u as w,b as g,p as M,Q as j,R as h,j as s,C as O,d as H,T as S,g as T,V as W}from"./index-25a41ef1.js";import{P as B,A as R}from"./PageHeader-b76b68bd.js";import{p as _}from"./PermissionService-9ad252b6.js";import{e as N}from"./ExportService-4b3a6c99.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const J=()=>{i.useState(null);const C=I(),c=w(),b=g(t=>t.city.loading),x=g(t=>t.city.CityList);i.useState(!1),i.useState([]);const[e,v]=i.useState(),[d,m]=i.useState([]),u=i.useRef(null);i.useEffect(()=>{M()}),i.useEffect(()=>{v(_({screenId:17}))},[]),i.useEffect(()=>{y()},[]);const y=()=>c(j({CityId:0,Taskname:"SEARCHINITIALIZE"}));i.useEffect(()=>{e!=null&&e._View&&d.filter(t=>t.name=="view").length==0&&m([...d,{title:"View",name:"view",disabled:!1}]),e!=null&&e._Update&&d.filter(t=>t.name=="edit").length==0&&m([...d,{title:"Edit",name:"edit",disabled:!1}]),e!=null&&e._Delete&&d.filter(t=>t.name=="delete").length==0&&m([...d,{title:"Delete",name:"delete",disabled:!1}]),e!=null&&e._View&&(e!=null&&e._Update)&&(e!=null&&e._Delete)&&p({...n,tableAction:!0})},[e,d]),i.useEffect(()=>{e!=null&&e._Add&&!n.pageHeader.pageActions[0].create&&p(t=>{const l={...t.pageHeader,pageActions:t.pageHeader.pageActions.map(o=>({...o,create:!!(e!=null&&e._Add)}))};return{...t,pageHeader:l}})},[e]),i.useEffect(()=>{p({...n,tableActions:d})},[d]);const[n,p]=i.useState({pageTitle:"City",pageHeader:{pageActions:[{create:!1,clear:!1,save:!1,createQuery:"/home/cCity",createDispatch:()=>c(h({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{textAlign:"center"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:d,tableColumns:[{title:"Country Name",name:"CountryName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"State Name",name:"StateName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"City Code",name:"CityCode",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"6rem"}},{title:"City Name",name:"CityName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created By",name:"CreatedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created On",name:"CreatedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified By",name:"ModifiedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified On",name:"ModifiedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Status",name:"StatusName",sort:!0,avatar:!1,badge:!0,colStyle:{minWidth:"2rem",textAlign:"center"}}],tableExport:t=>{y().then(o=>{E(o.payload.CityList).then(a=>{t==="pdf"?N.Export("City",a,"pdf"):t==="excel"&&N.Export("City",a,"excel")}).catch(a=>{console.error(a.message)})})}}),E=t=>new Promise((l,o)=>{let a=[];t.length>0?(t.forEach(r=>{let f={"Country Name":r.CountryName,"State Name":r.StateName,"City Code":r.CityCode,"City Name":r.CityName,"Created By":r.CreatedByName,"Created On":r.CreatedOn,"Modified By":r.ModifiedByName,"Modified On":r.ModifiedOn,Status:r.StatusName};a.push(f)}),l(a)):o(new Error("No data available for export."))}),A={view:t=>{const l={CityId:t.data.CityId,Taskname:"CreateInitialize"};c(S(l)).then(a=>{a.payload.transtatus.result==!0&&C.push("/home/cCity")}).catch(a=>{}),c(h(t))},edit:t=>{const l={CityId:t.data.CityId,Taskname:"CreateInitialize"};c(S(l)).then(a=>{a.payload.transtatus.result==!0&&C.push("/home/cCity")}).catch(a=>{}),c(h(t))},delete:t=>{T(`Are you sure you want to inactive this ${t.data.CityName}?`,"Confirmation",()=>{let l={CityId:t.data.CityId};c(W(l)).then(a=>{var r,f;a.payload.transtatus.result==!0?((r=u.current)==null||r.show({severity:"success",summary:"Success Message",detail:a.payload.transtatus.lstErrorItem[0].Message}),y()):a.payload.transtatus.result==!1&&((f=u.current)==null||f.show({severity:"error",summary:"Error Message",detail:a.payload.transtatus.lstErrorItem[0].Message}))}).catch(a=>{var r;(r=u.current)==null||r.show({severity:"error",summary:"Error Message",detail:JSON.stringify(a)})})},()=>{})}};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"page-container",children:s.jsxs("div",{className:"inner-page-container",children:[s.jsx(B,{pageTitle:n.pageTitle,pageConfig:n}),s.jsx("div",{className:"form-container scroll-y",children:s.jsx("div",{className:"white",children:s.jsx("div",{className:"widget-body",children:s.jsx("div",{className:"card",children:s.jsx(R,{handleActions:A,data:x,loading:b,pageConfig:n,screenPermissions:e})})})})})]})}),s.jsx(O,{}),s.jsx(H,{toast:u})]})};export{J as default};
