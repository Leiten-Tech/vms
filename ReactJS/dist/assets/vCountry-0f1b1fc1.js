import{r as s,a as j,u as O,b as C,p as H,o as g,q as h,j as o,C as R,d as B,g as T,s as W}from"./index-25a41ef1.js";import{P as _,A as F}from"./PageHeader-b76b68bd.js";import{p as D}from"./PermissionService-9ad252b6.js";import{e as b}from"./ExportService-4b3a6c99.js";import"./column.esm-11a46c7b.js";import"./index.esm-9a713e1a.js";import"./inputswitch.esm-a89edc74.js";import"./jspdf.es.min-40ee8370.js";const z=()=>{const[v,N]=s.useState(null),S=j(),n=O(),E=C(t=>t.country.CountryList),x=C(t=>t.country.loading);C(t=>t.country.Country);const[e,A]=s.useState(),[l,f]=s.useState([]),[L,I]=s.useState(!1),d=s.useRef();s.useEffect(()=>{H()}),s.useEffect(()=>{A(D({screenId:4}))},[]),s.useEffect(()=>{m()},[]);const m=()=>n(g({Countryid:0,Taskname:"SEARCHINITIALIZE"}));s.useEffect(()=>{N(E)},[E]),s.useEffect(()=>{e!=null&&e._View&&l.filter(t=>t.name=="view").length==0&&f([...l,{title:"View",name:"view",disabled:!1}]),e!=null&&e._Update&&l.filter(t=>t.name=="edit").length==0&&f([...l,{title:"Edit",name:"edit",disabled:!1}]),e!=null&&e._Delete&&l.filter(t=>t.name=="delete").length==0&&f([...l,{title:"Delete",name:"delete",disabled:!1}]),e!=null&&e._View&&(e!=null&&e._Update)&&(e!=null&&e._Delete)&&p({...y,tableAction:!0})},[e,l]),s.useEffect(()=>{e!=null&&e._Add&&!y.pageHeader.pageActions[0].create&&p(t=>{const i={...t.pageHeader,pageActions:t.pageHeader.pageActions.map(u=>({...u,create:!!(e!=null&&e._Add)}))};return{...t,pageHeader:i}})},[e]),s.useEffect(()=>{p({...y,tableActions:l})},[l]),s.useState(null);const[y,p]=s.useState({pageTitle:"Country",pageHeader:{pageActions:[{create:!1,clear:!1,save:!1,createQuery:"/home/cCountry",createDispatch:()=>n(h({data:null,isView:!1,isCreate:!0}))}]},tableCheckSelection:!1,tableAction:!0,tableActionStyle:{textAlign:"center"},tableRows:10,tableRowsOptions:[5,10,25],tablePagination:!0,tableActions:l,tableColumns:[{title:"Country Code",name:"CountryCode",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Country Name",name:"CountryName",sort:!0,avatar:!1,badge:!1,colStyle:{minWidth:"10rem"}},{title:"Country Shortform",name:"CountryShortForm",sort:!0,avatar:!1,badge:!1,colStyle:{}},{title:"Nationality",name:"Nationality",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created By",name:"CreatedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Created On",name:"CreatedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified By",name:"ModifiedByName",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Modified On",name:"ModifiedOn",sort:!0,avatar:!0,badge:!1,colStyle:{minWidth:"6rem"}},{title:"Status",name:"StatusName",sort:!0,avatar:!1,badge:!0,colStyle:{minWidth:"2rem",textAlign:"center"}}],tableExport:t=>{m().then(u=>{M(u.payload.CountryList).then(a=>{t==="pdf"?b.Export("Country",a,"pdf"):t==="excel"&&b.Export("Country",a,"excel")}).catch(a=>{console.error(a.message)})})}}),M=t=>new Promise((i,u)=>{let a=[];t.length>0?(t.forEach(r=>{let c={"Country Code":r.CountryCode,"Country Name":r.CountryName,"Country ShortForm":r.CountryShortForm,Nationality:r.Nationality,"Created By":r.CreatedByName,"Created On":r.CreatedOn,"Modified By":r.ModifiedByName,"Modified On":r.ModifiedOn,Status:r.StatusName};a.push(c)}),i(a)):u(new Error("No data available for export."))}),w={view:t=>{S.push("/home/cCountry");const i={Countryid:t.data.CountryId,Taskname:"createInitIALIZE"};n(g(i)),n(h(t)),I(!0)},edit:t=>{const i={Countryid:t.data.CountryId,Taskname:"createInitIALIZE"};n(g(i)).then(a=>{var r,c;a.payload.transtatus.result==!0?((r=d.current)==null||r.show({severity:"success",summary:"Success Message",detail:a.payload.transtatus.lstErrorItem[0].Message}),n(h(t)),S.push("/home/cCountry")):a.payload.transtatus.result==!1&&((c=d.current)==null||c.show({severity:"error",summary:"Error Message",detail:a.payload.transtatus.lstErrorItem[0].Message}))}).catch(a=>{var r;(r=d.current)==null||r.show({severity:"error",summary:"Error Message",detail:JSON.stringify(a)})})},delete:t=>{T(`Are you sure you want to inactive this ${t.data.CountryName}?`,"Confirmation",()=>{let i={Countryid:t.data.CountryId};n(W(i)).then(a=>{var r,c;a.payload.transtatus.result==!0?((r=d.current)==null||r.show({severity:"success",summary:"Success Message",detail:a.payload.transtatus.lstErrorItem[0].Message}),m()):a.payload.transtatus.result==!1&&((c=d.current)==null||c.show({severity:"error",summary:"Error Message",detail:a.payload.transtatus.lstErrorItem[0].Message}))}).catch(a=>{var r;(r=d.current)==null||r.show({severity:"error",summary:"Error Message",detail:JSON.stringify(a)})})},()=>{})}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"page-container",children:o.jsxs("div",{className:"inner-page-container",children:[o.jsx(_,{pageTitle:y.pageTitle,pageConfig:y}),o.jsx("div",{className:"form-container scroll-y",children:o.jsx("div",{className:"white",children:o.jsx("div",{className:"widget-body",children:o.jsx("div",{className:"card",children:o.jsx(F,{handleActions:w,data:v,loading:x,pageConfig:y,screenPermissions:e})})})})})]})}),o.jsx(R,{}),o.jsx(B,{toast:d})]})};export{z as default};
